var L=Object.defineProperty;var R=(s,t,r)=>t in s?L(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r;var S=(s,t,r)=>R(s,typeof t!="symbol"?t+"":t,r);import{u as M,i as J}from"./action-RBCHj6az.js";import{T as H,l as N}from"./tool-BehcEsnj.js";import{s as P,C as $}from"./vendor-crypto-BW6jiUfg.js";import{l as F,ay as G,Q as O,I as k,J as p,A as d,H as m,u as l,z as A,E as Q,L as q,V as K,G as V,ap as W,y as x}from"./vendor-D2QpS8Sq.js";import"./vendor-lodash-BDISS5yc.js";import"./modulepreload-polyfill-B5Qt9EMX.js";import"./vendor-monaco-CZQ85J0D.js";const y=["md5","sha1","sha256","sha512","sm3"],C={md5:s=>$.MD5($.enc.Base64.parse(s.toBase64())).toString(),sha1:s=>$.SHA1($.enc.Base64.parse(s.toBase64())).toString(),sha256:s=>$.SHA256($.enc.Base64.parse(s.toBase64())).toString(),sha512:s=>$.SHA512($.enc.Base64.parse(s.toBase64())).toString(),sm3:s=>{const t=(o,h)=>o.length>=h?o:new Array(h-o.length+1).join("0")+o;let r=s.toHex({type:"hex"});const e=[];let n=r.length;n%2!==0&&(r=t(r,n+1)),n=r.length;for(let o=0;o<n;o+=2)e.push(parseInt(r.substr(o,2),16));return P.sm3(e)}};class I{constructor(t="root"){S(this,"parameter",[]);S(this,"flag","");if(!["hash","$input","$salt","root"].includes(t))throw new Error(`Expression Error (${t})`);this.flag=t}add(t){this.parameter.push(t)}toString(){if(this.flag==="root"){let t="";for(const r in this.parameter){const e=this.parameter[r].toString();t+=`${parseInt(r)>0?".":""}${e.toString()}`}return t}if(this.flag==="hash"){let t="";for(const r in this.parameter){const e=this.parameter[r].toString();t+=`${parseInt(r)>0?".":""}${e.toString()}`}return`hash(${t})`}return this.flag}getResult(t,r,e){if(this.flag==="$input")return t;if(this.flag==="$salt")return r;const n=[];for(const o in this.parameter)n.push(this.parameter[o].getResult(t,r,e));return this.flag==="root"?n.join(""):e(H.fromString(n.join("")))}}const X=(s="")=>{const t="__@@@__";s=s.replace(/\(/g,`${t}(${t}`).replace(/\)/g,`${t})${t}`).replace(/\./g,`${t}.${t}`);const r=s.split(t).filter(h=>h!=="");if(!["hash","$input","$salt"].includes(r[0]))throw new Error(`Expression Error ${r[0]}`);const e=new I,n=[e];let o=null;for(const h of r){const E=n[n.length-1];let _=null;switch(h){case".":break;case"hash":case"$input":case"$salt":_=new I(h),E.add(_),o=_;break;case"(":n.push(o);break;case")":if(n.length===1)throw new Error('Expression Error invalid ")"');n.pop();break;default:throw new Error(`Expression Error invalid "${h}"`)}}if(n.length>1)throw new Error('Expression Error invalid "("');return e},T=(s,t,r="",e="")=>{if(!Object.keys(C).includes(s))throw new Error(`hash method 不存在: ${s}`);const n=o=>C[s](o);return e===""?n(t):X(e).getResult(t.toString(),r,n)},ne=F({__name:"Hash",async setup(s){let t,r;const e=M(([t,r]=G(()=>J({input:N(),salt:"",salt_exp:"",is_salt:!1,is_uppercase:!1,multiple:!1})),t=await t,r(),t)),n=V(()=>!e.current.is_salt||["upload","url"].includes(e.current.input.type)?"":e.current.salt_exp||""),o=V(()=>["text"].includes(e.current.input.type)),h=V(()=>{const u={md5:"",sha1:"",sha256:"",sha512:"",sm3:""};if(!e.current.input.text.isEmpty()){let a=!1;for(const f of y)try{if(e.current.input.text.isError())throw new Error(e.current.input.text.toString());const c=E(f,e.current.input.text,e.current.salt,n.value,o.value&&e.current.multiple);u[f]=e.current.is_uppercase?c.toUpperCase():c.toLowerCase()}catch(c){a=!0,u[f]=$error(c)}a||e.save()}return u}),E=(u,a,f,c,g)=>g?a.toString().split(`
`).map(v=>T(u,H.fromString(v,a.encoding()),f,c)).join(`
`):T(u,a,f,c),_=["hash(hash($input))","hash($input.$salt)","hash(hash($input).$salt)","hash($input).hash($salt)","hash(hash(hash($input)))","hash($salt.$input.$salt)","hash(hash($input.$salt).$salt)","hash($salt.hash($input.$salt).$salt)","hash($salt.hash($salt.$input.$salt).$salt)"];return(u,a)=>{const f=m("TextInput"),c=m("HeightResize"),g=m("Bool"),v=m("Tooltip"),w=m("Align"),z=m("Display"),B=m("Input"),D=m("Dropdown"),U=m("Textarea"),j=W("row");return O((x(),k("div",null,[p(w,{direction:"vertical"},{default:d(()=>[p(z,null,{extra:d(()=>[p(w,null,{default:d(()=>[p(g,{size:"small",modelValue:l(e).current.is_salt,"onUpdate:modelValue":a[1]||(a[1]=i=>l(e).current.is_salt=i),border:"",disabled:["upload","url"].includes(l(e).current.input.type),label:u.$t("hash_salt")},null,8,["modelValue","disabled","label"]),p(g,{size:"small",modelValue:l(e).current.is_uppercase,"onUpdate:modelValue":a[2]||(a[2]=i=>l(e).current.is_uppercase=i),border:"",label:u.$t("hash_uppercase")},null,8,["modelValue","label"]),p(v,{content:u.$t("hash_multiple_tooltip")},{default:d(()=>[p(g,{disabled:!o.value,size:"small",modelValue:l(e).current.multiple,"onUpdate:modelValue":a[3]||(a[3]=i=>l(e).current.multiple=i),border:"",label:u.$t("hash_multiple")},null,8,["disabled","modelValue","label"])]),_:1},8,["content"])]),_:1})]),default:d(()=>[p(c,{append:l(e).current.is_salt?[".sectool-hash-salt"]:[],reduce:l(e).current.is_salt?5:0},{default:d(({height:i})=>[p(f,{modelValue:l(e).current.input,"onUpdate:modelValue":a[0]||(a[0]=b=>l(e).current.input=b),height:i,upload:"file",encoding:""},null,8,["modelValue","height"])]),_:1},8,["append","reduce"])]),_:1}),l(e).current.is_salt?(x(),A(w,{key:0,direction:"vertical",class:"sectool-hash-salt"},{default:d(()=>[p(B,{modelValue:l(e).current.salt,"onUpdate:modelValue":a[4]||(a[4]=i=>l(e).current.salt=i),label:u.$t("hash_salt_value"),disabled:["upload","url"].includes(l(e).current.input.type)},null,8,["modelValue","label","disabled"]),p(B,{modelValue:l(e).current.salt_exp,"onUpdate:modelValue":a[6]||(a[6]=i=>l(e).current.salt_exp=i),label:u.$t("hash_salt_mode"),disabled:["upload","url"].includes(l(e).current.input.type)},{append:d(()=>[p(D,{disabled:["upload","url"].includes(l(e).current.input.type),onSelect:a[5]||(a[5]=i=>l(e).current.salt_exp=i),placeholder:u.$t("hash_salt_select"),options:_},null,8,["disabled","placeholder"])]),_:1},8,["modelValue","label","disabled"])]),_:1})):Q("",!0)]),_:1}),p(c,null,{default:d(({height:i})=>[p(w,{direction:"vertical"},{default:d(()=>[(x(!0),k(q,null,K(l(y),b=>(x(),A(U,{"model-value":h.value[b],height:(i-20)/l(y).length,placeholder:b,copy:b},null,8,["model-value","height","placeholder","copy"]))),256))]),_:2},1024)]),_:1})])),[[j,"10-14"]])}}});export{ne as default};
