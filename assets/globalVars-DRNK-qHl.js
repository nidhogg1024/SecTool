import{l as O}from"./vendor-lodash-BDISS5yc.js";import{an as T,w as D}from"./vendor-C2WOFBut.js";const n=[{key:"LHOST",label:"本机IP",labelEn:"Local Host",description:"攻击机IP地址",descriptionEn:"Attacker IP",defaultValue:"",placeholder:"10.10.14.1"},{key:"LPORT",label:"本机端口",labelEn:"Local Port",description:"攻击机监听端口",descriptionEn:"Attacker listening port",defaultValue:"4444",placeholder:"4444"},{key:"RHOST",label:"目标IP",labelEn:"Remote Host",description:"目标主机IP地址",descriptionEn:"Target IP",defaultValue:"",placeholder:"10.10.10.1"},{key:"RPORT",label:"目标端口",labelEn:"Remote Port",description:"目标服务端口",descriptionEn:"Target port",defaultValue:"80",placeholder:"80"},{key:"TARGET",label:"目标域名",labelEn:"Target Domain",description:"目标域名或URL",descriptionEn:"Target domain or URL",defaultValue:"",placeholder:"example.com"},{key:"DOMAIN",label:"域名",labelEn:"Domain",description:"Active Directory 域名",descriptionEn:"AD domain name",defaultValue:"",placeholder:"corp.local"},{key:"USERNAME",label:"用户名",labelEn:"Username",description:"认证用户名",descriptionEn:"Auth username",defaultValue:"",placeholder:"admin"},{key:"PASSWORD",label:"密码",labelEn:"Password",description:"认证密码",descriptionEn:"Auth password",defaultValue:"",placeholder:"P@ssw0rd"},{key:"WORDLIST",label:"字典路径",labelEn:"Wordlist Path",description:"暴力破解字典文件路径",descriptionEn:"Bruteforce wordlist path",defaultValue:"/usr/share/wordlists/rockyou.txt",placeholder:"/usr/share/wordlists/rockyou.txt"},{key:"ATTACKER_URL",label:"攻击者服务器",labelEn:"Attacker Server",description:"用于接收回调的服务器URL",descriptionEn:"Callback server URL",defaultValue:"",placeholder:"http://10.10.14.1:8000"}],P="sectool_global_vars",_="Default",m=()=>Date.now().toString(36)+Math.random().toString(36).substring(2,8),L=()=>{const e={};for(const l of n)e[l.key]=l.defaultValue;return e},h=e=>({id:m(),name:e,vars:L()}),U=()=>{try{const e=localStorage.getItem(P);if(!e)return c();const l=JSON.parse(e);if(!l||!Array.isArray(l.profiles)||l.profiles.length===0||typeof l.currentProfileId!="string")return c();for(const a of l.profiles)for(const i of n)i.key in a.vars||(a.vars[i.key]=i.defaultValue);return l.profiles.some(a=>a.id===l.currentProfileId)||(l.currentProfileId=l.profiles[0].id),l}catch{return c()}},c=()=>{const e=h(_);return{currentProfileId:e.id,profiles:[e]}},x=e=>{try{localStorage.setItem(P,JSON.stringify(e))}catch(l){console.error("[GlobalVars] 保存失败:",l)}};let f=null,p=!1;const y=()=>(f||(f=T(U())),f),N=()=>{if(p)return;p=!0;const e=y();D(()=>O.cloneDeep(e),()=>x(e),{deep:!0})},j=()=>{const e=y();N();const l=()=>e.profiles.find(o=>o.id===e.currentProfileId)||e.profiles[0],a=new Proxy({},{get(r,o){return l().vars[o]??""},set(r,o,t){return l().vars[o]=t,!0},ownKeys(){return Object.keys(l().vars)},has(r,o){return o in l().vars},getOwnPropertyDescriptor(r,o){if(o in l().vars)return{configurable:!0,enumerable:!0,writable:!0,value:l().vars[o]}}}),i=(r,o)=>{l().vars[r]=o},u=r=>l().vars[r]??"",d=r=>{e.profiles.some(o=>o.id===r)&&(e.currentProfileId=r)},b=r=>{const o=h(r||`Profile ${e.profiles.length+1}`);return e.profiles.push(o),e.currentProfileId=o.id,o.id},g=r=>{if(e.profiles.length<=1)return!1;const o=e.profiles.findIndex(t=>t.id===r);return o===-1?!1:(e.profiles.splice(o,1),e.currentProfileId===r&&(e.currentProfileId=e.profiles[0].id),!0)},v=(r,o)=>{const t=e.profiles.find(s=>s.id===r);return t?(t.name=o,!0):!1},I=r=>r&&r.replace(/\{\{(\w+)\}\}/g,(o,t)=>{const s=u(t);return s!==""?s:`{{${t}}}`}),E=(r,o="")=>{!r||r.trim()===""||(l().vars[r.trim().toUpperCase()]=o)},V=r=>n.some(t=>t.key===r)?!1:(delete l().vars[r],!0),k=()=>{const r=new Set(n.map(t=>t.key)),o=l().vars;return Object.entries(o).filter(([t])=>!r.has(t)).map(([t,s])=>({key:t,value:s}))},S=()=>{const r=l();for(const t of n)r.vars[t.key]=t.defaultValue;const o=new Set(n.map(t=>t.key));for(const t of Object.keys(r.vars))o.has(t)||delete r.vars[t]},A=()=>JSON.stringify({currentProfileId:e.currentProfileId,profiles:e.profiles},null,2),w=(r,o=!1)=>{try{const t=JSON.parse(r);if(!t||!Array.isArray(t.profiles)||t.profiles.length===0)return!1;for(const s of t.profiles)if(!s.id||!s.name||typeof s.vars!="object")return!1;if(o)e.profiles.splice(0,e.profiles.length,...t.profiles),e.currentProfileId=t.currentProfileId||t.profiles[0].id;else for(const s of t.profiles){const R={id:m(),name:s.name,vars:{...s.vars}};e.profiles.push(R)}return!0}catch{return!1}};return{vars:a,profiles:e.profiles,get currentProfileId(){return e.currentProfileId},set currentProfileId(r){d(r)},setVar:i,getVar:u,switchProfile:d,createProfile:b,deleteProfile:g,renameProfile:v,replaceVars:I,addCustomVar:E,removeCustomVar:V,getCustomVars:k,clearAll:S,exportProfiles:A,importProfiles:w,predefinedVars:n}};export{j as u};
