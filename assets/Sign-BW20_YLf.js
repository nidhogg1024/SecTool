import{u as v,i as k}from"./action-BSi9h3E1.js";import{k as T,l as A,T as s}from"./tool-BsZ2CvQX.js";import{a as I}from"./vendor-crypto-BdUbiGnj.js";import{l as b,az as w,w as z,z as C,A as p,H as i,J as e,u as n,G as H,y as E}from"./vendor-C2WOFBut.js";import"./vendor-lodash-BDISS5yc.js";import"./modulepreload-polyfill-B5Qt9EMX.js";import"./vendor-monaco-Dc_R4fc0.js";const N=b({__name:"Sign",async setup(U){let a,m;const t=v(([a,m]=w(()=>k({input:A("text"),option:{private_key:"",user_id:"1234567812345678"},output:T("hex")})),a=await a,m(),a)),c=H(()=>{if(t.current.input.text.isEmpty()||t.current.option.private_key==="")return s.empty();if(t.current.input.text.isError())return t.current.input.text;try{return s.fromHex(I.sm2.doSignature(t.current.input.text.toArray(),t.current.option.private_key,{hash:!0,userId:t.current.option.user_id}))}catch(r){return s.fromError($error(r))}});return z(()=>c.value,r=>{r.isEmpty()||t.save()},{immediate:!0,deep:!0}),(r,o)=>{const _=i("TextInput"),d=i("Input"),l=i("Align"),f=i("HelpTip"),x=i("Card"),g=i("TextOutput"),y=i("HeightResize");return E(),C(y,{ignore:"",append:[".sectool-page-option"],reduce:10},{default:p(({small:h,large:V})=>[e(l,{direction:"vertical"},{default:p(()=>[e(_,{modelValue:n(t).current.input,"onUpdate:modelValue":o[0]||(o[0]=u=>n(t).current.input=u),height:h,upload:"file"},null,8,["modelValue","height"]),e(x,{title:r.$t("main_ui_config"),class:"sectool-page-option"},{extra:p(()=>[e(l,null,{default:p(()=>[e(f,{link:"https://github.com/JuneAndGreen/sm-crypto"})]),_:1})]),default:p(()=>[e(l,{horizontal:"center"},{default:p(()=>[e(d,{modelValue:n(t).current.option.private_key,"onUpdate:modelValue":o[1]||(o[1]=u=>n(t).current.option.private_key=u),label:r.$t("sm2_private_key")},null,8,["modelValue","label"]),e(d,{modelValue:n(t).current.option.user_id,"onUpdate:modelValue":o[2]||(o[2]=u=>n(t).current.option.user_id=u),label:r.$t("sm2_userId")},null,8,["modelValue","label"])]),_:1})]),_:1},8,["title"]),e(g,{modelValue:n(t).current.output,"onUpdate:modelValue":o[3]||(o[3]=u=>n(t).current.output=u),allow:["base64","hex"],content:c.value,height:V},null,8,["modelValue","content","height"])]),_:2},1024)]),_:1})}}});export{N as default};
