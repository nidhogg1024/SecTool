import{u as b,i as C}from"./action-BSi9h3E1.js";import{l as $,az as V,w as E,z as x,A as h,H as s,y as z,J as c,u as l,h as J}from"./vendor-C2WOFBut.js";import"./tool-BsZ2CvQX.js";import"./modulepreload-polyfill-B5Qt9EMX.js";import"./vendor-lodash-BDISS5yc.js";import"./vendor-monaco-Dc_R4fc0.js";const O=$({__name:"Encoder",async setup(T){let p,y;const f=[{value:"HS256",label:"HS256"},{value:"HS384",label:"HS384"},{value:"HS512",label:"HS512"}],H={HS256:"SHA-256",HS384:"SHA-384",HS512:"SHA-512"},n=b(([p,y]=V(()=>C({payload:"",secret:"",algorithm:"HS256"},{paste:!1})),p=await p,y(),p)),g=t=>{let e;typeof t=="string"?e=new TextEncoder().encode(t):e=new Uint8Array(t);let a="";for(const o of e)a+=String.fromCharCode(o);return btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},w=async(t,e,a)=>{const o=new TextEncoder,r=await crypto.subtle.importKey("raw",o.encode(e),{name:"HMAC",hash:H[t]},!1,["sign"]),i=await crypto.subtle.sign("HMAC",r,o.encode(a));return g(i)},S=async(t,e,a)=>{const o=JSON.stringify({alg:t,typ:"JWT"}),r=g(o);JSON.parse(e);const i=g(e),m=`${r}.${i}`,_=await w(t,a,m);return`${m}.${_}`};let d=J("");return E(()=>({payload:n.current.payload,secret:n.current.secret,algorithm:n.current.algorithm}),async({payload:t,secret:e,algorithm:a})=>{d.value="";const o=t.trim();if(!(!o||!e))try{d.value=await S(a,o,e),n.save()}catch(r){d.value=$error(r)}},{immediate:!0,deep:!0}),(t,e)=>{const a=s("Select"),o=s("Input"),r=s("Align"),i=s("Editor"),m=s("Textarea"),_=s("HeightResize");return z(),x(_,{reduce:5},{default:h(({small:v,large:A})=>[c(r,{direction:"vertical"},{default:h(()=>[c(i,{modelValue:l(n).current.payload,"onUpdate:modelValue":e[2]||(e[2]=u=>l(n).current.payload=u),lang:"json",height:v,placeholder:t.$t("jwt_payload_placeholder")},{default:h(()=>[c(r,null,{default:h(()=>[c(a,{"model-value":l(n).current.algorithm,onChange:e[0]||(e[0]=u=>l(n).current.algorithm=u),options:f},null,8,["model-value"]),c(o,{modelValue:l(n).current.secret,"onUpdate:modelValue":e[1]||(e[1]=u=>l(n).current.secret=u),placeholder:t.$t("jwt_secret_placeholder"),width:200},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["modelValue","height","placeholder"]),c(m,{"model-value":l(d),height:A,placeholder:t.$t("jwt_output_placeholder"),copy:""},null,8,["model-value","height","placeholder"])]),_:2},1024)]),_:1})}}});export{O as default};
