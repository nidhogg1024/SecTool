import{u as T,i as E}from"./action-DbkO0_5I.js";import{l as H}from"./vendor-lodash-BDISS5yc.js";import{l as R,o as z,ay as A,w as F,I as f,J as s,A as I,C as m,u as n,L as j,h as k,G as D,H as u,Q as N,ap as S,y as v}from"./vendor-D2QpS8Sq.js";import{_ as G}from"./tool-Tf4xlnLR.js";import"./modulepreload-polyfill-B5Qt9EMX.js";import"./vendor-monaco-CZQ85J0D.js";const J={style:{display:"grid","grid-template-columns":"1fr 5px 1fr","grid-column-gap":"10px","margin-top":"5px"},class:"sectool-page-option"},M={style:{display:"grid","grid-template-columns":"120px 120px 1fr","grid-column-gap":"5px"}},O=R({__name:"Bcrypt",async setup(P){let c,h;const p=new Worker(new URL(""+new URL("worker-IgvEHT5L.js",import.meta.url).href,import.meta.url),{type:"module"});z(()=>{p.terminate()});const e=T(([c,h]=A(()=>E({input:"",rounds:10,hash:"",check_result:null,version:"2a"},{paste:!1})),c=await c,h(),c));let i=k(!1),d=k(!1);p.onmessage=function(r){const t=r.data;if(console.log("main accept",t),t.method==="hash")return $(t.data.err,t.data.hash);if(t.method==="compare")return w(t.data.err,t.data.res)};const _=(r,t)=>{const o={method:r,data:t};console.log("main send",o),p.postMessage(o)},b=()=>{if(e.current.input!==""){if(e.current.rounds<4||e.current.rounds>30)throw new Error($t("bcrypt_rounds_range",[4,30]));i.value=!0,_("hash",{input:e.current.input,rounds:e.current.rounds,version:e.current.version})}},$=(r,t)=>{if(i.value=!1,r)throw new Error(r.message);e.current.hash=t,e.current.check_result=null,e.success({copy_text:e.current.hash})},x=()=>{e.current.input===""||e.current.hash===""||(d.value=!0,_("compare",{input:e.current.input,hash:e.current.hash}))},w=(r,t)=>{d.value=!1,e.current.check_result=t;const o=e.current.check_result?$t("bcrypt_check_result_success"):$t("bcrypt_check_result_error");e.success({message:`${$t("bcrypt_check")} ${o}`,message_type:e.current.check_result?"success":"error"})},V=H.range(4,33).map(r=>({label:`${$t("bcrypt_rounds")} ${r}`,value:r})),C=[{label:"2a",value:"2a"},{label:"2b",value:"2b"},{label:"2y",value:"2y"}],B=D(()=>e.current.check_result===null?$t("bcrypt_check"):`${$t("bcrypt_check")} (${e.current.check_result?$t("bcrypt_check_result_success"):$t("bcrypt_check_result_error")})`);return F(()=>({input:e.current.input,hash:e.current.hash}),()=>{e.current.check_result=null}),(r,t)=>{const o=u("Textarea"),U=u("HeightResize"),g=u("Select"),y=u("Button"),L=S("row");return v(),f(j,null,[s(U,{append:[".sectool-page-option"]},{default:I(({height:a})=>[N((v(),f("div",null,[s(o,{height:a,modelValue:n(e).current.input,"onUpdate:modelValue":t[0]||(t[0]=l=>n(e).current.input=l),"float-text":r.$t("bcrypt_password"),placeholder:r.$t("bcrypt_password"),onClickFloatText:t[1]||(t[1]=l=>r.$copy(n(e).current.input))},null,8,["height","modelValue","float-text","placeholder"]),s(o,{height:a,modelValue:n(e).current.hash,"onUpdate:modelValue":t[2]||(t[2]=l=>n(e).current.hash=l),"float-text":r.$t("bcrypt_hash"),placeholder:r.$t("bcrypt_hash"),onClickFloatText:t[3]||(t[3]=l=>r.$copy(n(e).current.hash))},null,8,["height","modelValue","float-text","placeholder"])])),[[L,"1-1"]])]),_:1}),m("div",J,[m("div",M,[s(g,{modelValue:n(e).current.rounds,"onUpdate:modelValue":t[4]||(t[4]=a=>n(e).current.rounds=a),options:n(V),class:"select-box"},null,8,["modelValue","options"]),s(g,{modelValue:n(e).current.version,"onUpdate:modelValue":t[5]||(t[5]=a=>n(e).current.version=a),options:C,class:"select-box"},null,8,["modelValue"]),s(y,{loading:n(i),onClick:b,type:"primary",long:"",text:r.$t("bcrypt_generate")},null,8,["loading","text"])]),t[6]||(t[6]=m("span",{style:{display:"flex","justify-content":"center","align-items":"center"}},"|",-1)),s(y,{loading:n(d),onClick:x,type:"primary",long:"",text:B.value},null,8,["loading","text"])])],64)}}}),Z=G(O,[["__scopeId","data-v-908b0b6c"]]);export{Z as default};
