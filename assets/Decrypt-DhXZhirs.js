import{u as C,i as T}from"./action-BSi9h3E1.js";import{k as b,l as A,T as a}from"./tool-BsZ2CvQX.js";import{a as E}from"./vendor-crypto-BdUbiGnj.js";import{l as H,az as z,w as I,z as d,A as l,H as u,J as p,u as r,Q as D,G as U,ap as O,y as _}from"./vendor-C2WOFBut.js";import"./vendor-lodash-BDISS5yc.js";import"./modulepreload-polyfill-B5Qt9EMX.js";import"./vendor-monaco-Dc_R4fc0.js";const j=H({__name:"Decrypt",async setup(S){let i,s;const e=C(([i,s]=z(()=>T({input:A("hex"),option:{private_key:"",cipher_mode:1},output:b("text")})),i=await i,s(),i)),c=U(()=>{if(e.current.input.text.isEmpty()||e.current.option.private_key==="")return a.empty();try{if(e.current.input.text.isError())return e.current.input.text;const t=E.sm2.doDecrypt(e.current.input.text.toHexString(),e.current.option.private_key,e.current.option.cipher_mode,{output:"array"});if(t==="")throw new Error("failure");return a.fromArray(t)}catch(t){return a.fromError($error(t))}});return I(()=>c.value,t=>{t.isEmpty()||e.save()},{immediate:!0,deep:!0}),(t,o)=>{const x=u("TextInput"),f=u("Input"),h=u("Select"),y=u("HelpTip"),m=u("Align"),v=u("TextOutput"),g=u("HeightResize"),w=O("row");return _(),d(g,{ignore:"",append:[".sectool-page-option"],reduce:10},{default:l(({small:V,large:k})=>[p(m,{direction:"vertical"},{default:l(()=>[p(x,{modelValue:r(e).current.input,"onUpdate:modelValue":o[0]||(o[0]=n=>r(e).current.input=n),allow:["base64","hex"],height:V},null,8,["modelValue","height"]),D((_(),d(m,{class:"sectool-page-option"},{default:l(()=>[p(f,{modelValue:r(e).current.option.private_key,"onUpdate:modelValue":o[1]||(o[1]=n=>r(e).current.option.private_key=n),label:t.$t("sm2_private_key")},null,8,["modelValue","label"]),p(h,{options:[{value:1,label:"C1-C3-C2"},{value:0,label:"C1-C2-C3"}],modelValue:r(e).current.option.cipher_mode,"onUpdate:modelValue":o[2]||(o[2]=n=>r(e).current.option.cipher_mode=n)},null,8,["modelValue"]),p(y,{link:"https://github.com/JuneAndGreen/sm-crypto"})]),_:1})),[[w,"1-auto-auto"]]),p(v,{modelValue:r(e).current.output,"onUpdate:modelValue":o[3]||(o[3]=n=>r(e).current.output=n),allow:["text","hex","base64","image","down"],content:c.value,height:k},null,8,["modelValue","content","height"])]),_:2},1024)]),_:1})}}});export{j as default};
