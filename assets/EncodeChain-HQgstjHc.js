import{a0 as Z,az as ee,h as A,w as fe,G as O,l as ve,ay as ye,k as Re,I as C,Q as ge,J as i,A as h,S as E,u as r,L as B,H as V,D as te,C as f,K as y,P as M,z as F,E as T,V as N,U as ne,ap as Se,y as R}from"./vendor-D2QpS8Sq.js";import{u as Ce,i as Ue}from"./action-IBDzAXvx.js";import{C as J}from"./vendor-crypto-BW6jiUfg.js";import{_ as we}from"./tool-D7RAy8gJ.js";import"./vendor-lodash-BDISS5yc.js";import"./modulepreload-polyfill-B5Qt9EMX.js";import"./vendor-monaco-CZQ85J0D.js";const Ae=e=>Array.from(e).map(a=>{const p=encodeURIComponent(a);return p.startsWith("%")?p:`%${a.charCodeAt(0).toString(16).toUpperCase().padStart(2,"0")}`}).join(""),be=e=>{const p=new TextEncoder().encode(e);return Array.from(p).map(n=>`\\x${n.toString(16).padStart(2,"0")}`).join("")},Ee=e=>{const a=[],p=/\\x([0-9a-fA-F]{2})/g;let n,s=0;for(;(n=p.exec(e))!==null;){if(n.index>s){const v=e.slice(s,n.index),S=new TextEncoder;a.push(...S.encode(v))}a.push(parseInt(n[1],16)),s=p.lastIndex}if(s<e.length){const v=e.slice(s),S=new TextEncoder;a.push(...S.encode(v))}return new TextDecoder().decode(new Uint8Array(a))},Ve=e=>Array.from(e).map(a=>{const p=a.codePointAt(0)||0;if(p>65535){const n=Math.floor((p-65536)/1024)+55296,s=(p-65536)%1024+56320;return`\\u${n.toString(16).padStart(4,"0")}\\u${s.toString(16).padStart(4,"0")}`}return`\\u${p.toString(16).padStart(4,"0")}`}).join(""),He=e=>e.replace(/\\u([0-9a-fA-F]{4})/g,(a,p)=>String.fromCharCode(parseInt(p,16))),X=[{id:"url_encode",name:"URL 编码 (标准)",nameEn:"URL Encode (Standard)",type:"encode",fn:e=>encodeURIComponent(e)},{id:"url_encode_full",name:"URL 编码 (全字符)",nameEn:"URL Encode (Full)",type:"encode",fn:e=>Ae(e)},{id:"url_decode",name:"URL 解码",nameEn:"URL Decode",type:"decode",fn:e=>decodeURIComponent(e)},{id:"base64_encode",name:"Base64 编码",nameEn:"Base64 Encode",type:"encode",fn:e=>Z.encode(e)},{id:"base64_decode",name:"Base64 解码",nameEn:"Base64 Decode",type:"decode",fn:e=>Z.decode(e)},{id:"html_entity_encode",name:"HTML 实体编码",nameEn:"HTML Entity Encode",type:"encode",fn:e=>ee.htmlEncode(e)},{id:"html_entity_decode",name:"HTML 实体解码",nameEn:"HTML Entity Decode",type:"decode",fn:e=>ee.htmlDecode(e)},{id:"hex_encode",name:"Hex 编码 (\\xHH)",nameEn:"Hex Encode (\\xHH)",type:"encode",fn:be},{id:"hex_decode",name:"Hex 解码",nameEn:"Hex Decode",type:"decode",fn:Ee},{id:"unicode_encode",name:"Unicode 编码 (\\uXXXX)",nameEn:"Unicode Encode (\\uXXXX)",type:"encode",fn:Ve},{id:"unicode_decode",name:"Unicode 解码",nameEn:"Unicode Decode",type:"decode",fn:He},{id:"uppercase",name:"转大写",nameEn:"Uppercase",type:"both",fn:e=>e.toUpperCase()},{id:"lowercase",name:"转小写",nameEn:"Lowercase",type:"both",fn:e=>e.toLowerCase()},{id:"reverse",name:"反转字符串",nameEn:"Reverse String",type:"both",fn:e=>Array.from(e).reverse().join("")},{id:"md5",name:"MD5 哈希",nameEn:"MD5 Hash",type:"encode",fn:e=>J.MD5(e).toString()},{id:"sha1",name:"SHA1 哈希",nameEn:"SHA1 Hash",type:"encode",fn:e=>J.SHA1(e).toString()},{id:"sha256",name:"SHA256 哈希",nameEn:"SHA256 Hash",type:"encode",fn:e=>J.SHA256(e).toString()}],xe=new Map(X.map(e=>[e.id,e]));function $e(e,a){const p=[];let n=e;for(let s=0;s<a.length;s++){const U=xe.get(a[s]);if(!U)return{stepResults:p,finalResult:n,error:`步骤 ${s+1}: 未知操作 "${a[s]}"`};try{n=U.fn(n),p.push(n)}catch(v){return{stepResults:p,finalResult:n,error:`步骤 ${s+1} (${U.name}): ${v instanceof Error?v.message:String(v)}`}}}return{stepResults:p,finalResult:n}}const se="sectool_encode_recipes",oe=[{id:"builtin_double_url_encode",name:"双重 URL 编码",description:"连续两次全字符 URL 编码，用于绕过单层解码的 WAF",steps:["url_encode_full","url_encode_full"],createdAt:0,isBuiltin:!0},{id:"builtin_base64_url",name:"Base64 + URL 编码",description:"先 Base64 编码再 URL 编码，常用于参数传输",steps:["base64_encode","url_encode"],createdAt:0,isBuiltin:!0},{id:"builtin_html_url",name:"HTML 实体 + URL 编码",description:"HTML 实体编码后再 URL 编码",steps:["html_entity_encode","url_encode"],createdAt:0,isBuiltin:!0},{id:"builtin_unicode_url",name:"Unicode + URL 编码",description:"Unicode 转义后再 URL 编码",steps:["unicode_encode","url_encode"],createdAt:0,isBuiltin:!0},{id:"builtin_hex_only",name:"Hex 编码",description:"将字符串转为 \\xHH 格式",steps:["hex_encode"],createdAt:0,isBuiltin:!0},{id:"builtin_xss_bypass",name:"XSS 过滤绕过",description:"URL 全字符编码 + HTML 实体编码，用于 XSS 过滤器绕过测试",steps:["url_encode_full","html_entity_encode"],createdAt:0,isBuiltin:!0},{id:"builtin_sqli_encode",name:"SQL 注入编码",description:"Hex 编码 + URL 编码，用于 SQL 注入绕过测试",steps:["hex_encode","url_encode"],createdAt:0,isBuiltin:!0},{id:"builtin_base64_nested",name:"Base64 嵌套",description:"连续两次 Base64 编码",steps:["base64_encode","base64_encode"],createdAt:0,isBuiltin:!0},{id:"builtin_full_obfuscation",name:"全混淆编码",description:"Unicode + Hex + URL 三重编码，最大化混淆",steps:["unicode_encode","hex_encode","url_encode"],createdAt:0,isBuiltin:!0},{id:"builtin_reverse_base64",name:"反转 + Base64",description:"先反转字符串再 Base64 编码",steps:["reverse","base64_encode"],createdAt:0,isBuiltin:!0}];function Le(){try{const e=localStorage.getItem(se);if(!e)return[];const a=JSON.parse(e);return Array.isArray(a)?a:[]}catch{return[]}}function ke(e){try{localStorage.setItem(se,JSON.stringify(e))}catch(a){console.error("[recipes] 保存到 localStorage 失败:",a)}}function j(){return`recipe_${Date.now()}_${Math.random().toString(36).slice(2,8)}`}let Q=null;function Be(){const e=A(Le()),a=O(()=>[...oe,...e.value]),p=O(()=>oe),n=O(()=>e.value);fe(e,u=>ke(u),{deep:!0});function s(u,l,c){const m={id:j(),name:u,description:c,steps:[...l],createdAt:Date.now()};return e.value=[...e.value,m],m}function U(u){const l=e.value.findIndex(m=>m.id===u);if(l===-1)return!1;const c=[...e.value];return c.splice(l,1),e.value=c,!0}function v(u,l){const c=e.value.find(m=>m.id===u);return c?(c.name=l,e.value=[...e.value],!0):!1}function S(u,l){const c=e.value.find(m=>m.id===u);return c?(c.steps=[...l],e.value=[...e.value],!0):!1}function H(u){const l=a.value.find(m=>m.id===u);if(!l)return"";const c={name:l.name,steps:l.steps,description:l.description||""};return btoa(JSON.stringify(c))}function L(u){try{const l=atob(u),c=JSON.parse(l);if(!c.steps||!Array.isArray(c.steps)||c.steps.length===0)return null;const m={id:j(),name:c.name||"Imported Recipe",description:c.description||void 0,steps:c.steps,createdAt:Date.now()};return e.value=[...e.value,m],m}catch{return null}}function D(){const u=e.value.map(l=>({name:l.name,description:l.description||"",steps:l.steps}));return JSON.stringify(u,null,2)}function b(u){try{const l=JSON.parse(u);if(!Array.isArray(l))return 0;let c=0;const m=[];for(const $ of l)!$.steps||!Array.isArray($.steps)||$.steps.length===0||(m.push({id:j(),name:$.name||"Imported Recipe",description:$.description||void 0,steps:$.steps,createdAt:Date.now()}),c++);return m.length>0&&(e.value=[...e.value,...m]),c}catch{return 0}}function x(u){const l=H(u);return l?`${window.location.href.split("#")[0]}#recipe=${l}`:""}return{recipes:a,userRecipes:n,builtinRecipes:p,saveRecipe:s,deleteRecipe:U,renameRecipe:v,updateRecipeSteps:S,exportRecipe:H,importRecipeFromHash:L,exportAllRecipes:D,importRecipes:b,getShareUrl:x}}function De(){return Q||(Q=Be()),Q}const Ie={class:"sectool-encode-recipes"},Me={class:"sectool-encode-recipes-header"},Te={class:"sectool-encode-recipes-label"},ze={class:"sectool-encode-recipes-actions"},Ne={key:0,class:"sectool-encode-recipes-group"},Oe={class:"sectool-encode-recipes-group-label"},Xe={class:"sectool-encode-recipes-chips"},Fe=["onClick"],Je={class:"sectool-encode-recipe-chip-text"},je={key:1,class:"sectool-encode-recipes-group"},Qe={class:"sectool-encode-recipes-group-label"},We={class:"sectool-encode-recipes-chips"},Ye=["onClick"],Ge={class:"sectool-encode-recipe-chip-text"},Ke=["onClick"],Pe=["onClick"],qe={class:"sectool-encode-chain"},Ze={class:"sectool-encode-step-num"},et={class:"sectool-encode-add"},tt={key:0,class:"sectool-encode-empty"},nt={class:"sectool-encode-step-title"},ot={key:1,class:"sectool-encode-error"},st={class:"sectool-encode-final-title"},lt=ve({__name:"EncodeChain",async setup(e){let a,p;const n=Ce(([a,p]=ye(()=>Ue({input:"",steps:[],showSteps:!1})),a=await a,p(),a)),s=De();let U=A(X[0].id),v=A(!1),S=A(""),H=A(""),L=A(!1),D=A(""),b=A(!1),x=A(""),u=A(!1),l=A("");const c=X.map(t=>({value:t.id,label:t.name})),m=O(()=>{if(n.current.input===""||n.current.steps.length===0)return{stepResults:[],finalResult:"",error:void 0};const t=$e(n.current.input,n.current.steps);return t.error||n.save(),t}),$=t=>{const o=X.find(g=>g.id===t);return o?o.name:t},W=t=>{n.current.steps=[...t.steps]},le=()=>{!S.value.trim()||n.current.steps.length===0||(s.saveRecipe(S.value.trim(),n.current.steps,H.value.trim()||void 0),S.value="",H.value="",v.value=!1)},ie=t=>{s.deleteRecipe(t)},ae=t=>{D.value=s.getShareUrl(t.id),L.value=!0},re=()=>{l.value=s.exportAllRecipes(),u.value=!0},ce=()=>{const t=x.value.trim();if(t){if(t.startsWith("["))s.importRecipes(t);else{const o=t.replace(/^.*#recipe=/,"");s.importRecipeFromHash(o)}x.value="",b.value=!1}},de=()=>{n.current.steps=[...n.current.steps,U.value]},ue=t=>{const o=[...n.current.steps];o.splice(t,1),n.current.steps=o},pe=(t,o)=>{const g=[...n.current.steps];g[t]=o,n.current.steps=g};return Re(()=>{const t=window.location.hash;if(t.includes("recipe=")){const o=t.replace(/^#.*recipe=/,"");if(o){const g=s.importRecipeFromHash(o);g&&(n.current.steps=[...g.steps],history.replaceState(null,"",window.location.pathname+window.location.search))}}}),(t,o)=>{const g=V("Textarea"),I=V("Button"),Y=V("Tooltip"),G=V("Select"),k=V("Align"),K=V("HeightResize"),me=V("Bool"),_e=V("Display"),P=V("Input"),z=V("Modal"),he=Se("row");return R(),C(B,null,[ge((R(),C("div",null,[i(k,{direction:"vertical"},{default:h(()=>[i(_e,null,{extra:h(()=>[i(k,null,{default:h(()=>[i(me,{size:"small",modelValue:r(n).current.showSteps,"onUpdate:modelValue":o[4]||(o[4]=d=>r(n).current.showSteps=d),border:"",label:t.$t("encodeChain_show_steps")},null,8,["modelValue","label"])]),_:1})]),default:h(()=>[i(K,{reduce:5},{default:h(({height:d})=>[i(k,{direction:"vertical",style:te({height:d+"px",overflowY:"auto"})},{default:h(()=>[i(g,{modelValue:r(n).current.input,"onUpdate:modelValue":o[0]||(o[0]=_=>r(n).current.input=_),height:120,placeholder:t.$t("encodeChain_input_placeholder")},null,8,["modelValue","placeholder"]),f("div",Ie,[f("div",Me,[f("span",Te,y(t.$t("encodeChain_presets")),1),f("div",ze,[i(I,{size:"small",disabled:r(n).current.steps.length===0,onClick:o[1]||(o[1]=_=>E(v)?v.value=!0:v=!0)},{default:h(()=>[M(y(t.$t("encodeChain_recipe_save")),1)]),_:1},8,["disabled"]),i(I,{size:"small",onClick:o[2]||(o[2]=_=>E(b)?b.value=!0:b=!0)},{default:h(()=>[M(y(t.$t("encodeChain_recipe_import")),1)]),_:1}),r(s).userRecipes.value.length>0?(R(),F(I,{key:0,size:"small",onClick:re},{default:h(()=>[M(y(t.$t("encodeChain_recipe_export")),1)]),_:1})):T("",!0)])]),r(s).builtinRecipes.value.length>0?(R(),C("div",Ne,[f("span",Oe,y(t.$t("encodeChain_recipe_builtin")),1),f("div",Xe,[(R(!0),C(B,null,N(r(s).builtinRecipes.value,_=>(R(),F(Y,{key:_.id,content:_.description||""},{default:h(()=>[f("div",{class:"sectool-encode-recipe-chip",onClick:w=>W(_)},[f("span",Je,y(_.name),1)],8,Fe)]),_:2},1032,["content"]))),128))])])):T("",!0),r(s).userRecipes.value.length>0?(R(),C("div",je,[f("span",Qe,y(t.$t("encodeChain_recipe_user")),1),f("div",We,[(R(!0),C(B,null,N(r(s).userRecipes.value,_=>(R(),F(Y,{key:_.id,content:_.description||""},{default:h(()=>[f("div",{class:"sectool-encode-recipe-chip sectool-encode-recipe-chip--user",onClick:w=>W(_)},[f("span",Ge,y(_.name),1),f("span",{class:"sectool-encode-recipe-chip-share",onClick:ne(w=>ae(_),["stop"]),title:"Share"},"⚑",8,Ke),f("span",{class:"sectool-encode-recipe-chip-delete",onClick:ne(w=>ie(_.id),["stop"])},"×",8,Pe)],8,Ye)]),_:2},1032,["content"]))),128))])])):T("",!0)]),f("div",qe,[(R(!0),C(B,null,N(r(n).current.steps,(_,w)=>(R(),C("div",{key:w,class:"sectool-encode-step"},[f("span",Ze,y(w+1),1),i(G,{size:"small","model-value":_,options:r(c),"onUpdate:modelValue":q=>pe(w,q)},null,8,["model-value","options","onUpdate:modelValue"]),i(I,{size:"small",onClick:q=>ue(w)},{default:h(()=>[M(y(t.$t("encodeChain_remove_step")),1)]),_:1},8,["onClick"])]))),128))]),f("div",et,[i(G,{size:"small",modelValue:r(U),"onUpdate:modelValue":o[3]||(o[3]=_=>E(U)?U.value=_:U=_),options:r(c)},null,8,["modelValue","options"]),i(I,{size:"small",onClick:de},{default:h(()=>[M(y(t.$t("encodeChain_add_step")),1)]),_:1})])]),_:1},8,["style"])]),_:1})]),_:1})]),_:1}),i(K,null,{default:h(({height:d})=>[f("div",{style:te({height:d+"px",overflowY:"auto"})},[r(n).current.steps.length===0?(R(),C("div",tt,y(t.$t("encodeChain_no_steps")),1)):(R(),C(B,{key:1},[r(n).current.showSteps&&m.value.stepResults.length>0?(R(!0),C(B,{key:0},N(m.value.stepResults,(_,w)=>(R(),C("div",{key:"step-"+w,class:"sectool-encode-step-result"},[f("div",nt,y(t.$t("encodeChain_step_result",[w+1]))+" - "+y($(r(n).current.steps[w])),1),i(g,{"model-value":_,height:60,copy:!!_},null,8,["model-value","copy"])]))),128)):T("",!0),m.value.error?(R(),C("div",ot,y(m.value.error),1)):T("",!0),f("div",st,y(t.$t("encodeChain_final_result")),1),i(g,{"model-value":m.value.finalResult,height:120,copy:!!m.value.finalResult},null,8,["model-value","copy"])],64))],4)]),_:1})])),[[he,"10-14"]]),i(z,{modelValue:r(v),"onUpdate:modelValue":o[7]||(o[7]=d=>E(v)?v.value=d:v=d),title:t.$t("encodeChain_recipe_save"),width:380,"footer-type":"normal",onOk:le},{default:h(()=>[i(k,{direction:"vertical",gap:"small"},{default:h(()=>[i(P,{modelValue:r(S),"onUpdate:modelValue":o[5]||(o[5]=d=>E(S)?S.value=d:S=d),placeholder:t.$t("encodeChain_recipe_save_name"),size:"small"},null,8,["modelValue","placeholder"]),i(P,{modelValue:r(H),"onUpdate:modelValue":o[6]||(o[6]=d=>E(H)?H.value=d:H=d),placeholder:t.$t("encodeChain_recipe_save_desc"),size:"small"},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["modelValue","title"]),i(z,{modelValue:r(L),"onUpdate:modelValue":o[8]||(o[8]=d=>E(L)?L.value=d:L=d),title:t.$t("encodeChain_recipe_share"),width:450,"footer-type":"none"},{default:h(()=>[i(k,{direction:"vertical",gap:"small"},{default:h(()=>[i(g,{"model-value":r(D),height:80,copy:!!r(D)},null,8,["model-value","copy"])]),_:1})]),_:1},8,["modelValue","title"]),i(z,{modelValue:r(b),"onUpdate:modelValue":o[10]||(o[10]=d=>E(b)?b.value=d:b=d),title:t.$t("encodeChain_recipe_import"),width:450,"footer-type":"normal",onOk:ce},{default:h(()=>[i(k,{direction:"vertical",gap:"small"},{default:h(()=>[i(g,{modelValue:r(x),"onUpdate:modelValue":o[9]||(o[9]=d=>E(x)?x.value=d:x=d),height:120,placeholder:t.$t("encodeChain_recipe_import_placeholder")},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["modelValue","title"]),i(z,{modelValue:r(u),"onUpdate:modelValue":o[11]||(o[11]=d=>E(u)?u.value=d:u=d),title:t.$t("encodeChain_recipe_export"),width:450,"footer-type":"none"},{default:h(()=>[i(k,{direction:"vertical",gap:"small"},{default:h(()=>[i(g,{"model-value":r(l),height:200,copy:!!r(l)},null,8,["model-value","copy"])]),_:1})]),_:1},8,["modelValue","title"])],64)}}}),mt=we(lt,[["__scopeId","data-v-6c0a8e65"]]);export{mt as default};
