import{u as O,i as V}from"./action-NPygQj2q.js";import{l as k,ay as M,Q as W,I as g,J as u,A as f,H as C,y as m,u as A,C as w,L as R,V as y,z as $,K as L,D as z,an as Q,G as F,ap as G}from"./vendor-D2QpS8Sq.js";import{_ as P}from"./tool-BjIByA9b.js";import"./vendor-lodash-BDISS5yc.js";import"./modulepreload-polyfill-B5Qt9EMX.js";import"./vendor-monaco-CZQ85J0D.js";const _=["SELECT","UNION","INSERT","UPDATE","DELETE","DROP","FROM","WHERE","AND","OR","ORDER","GROUP","BY","HAVING","LIMIT","JOIN","INTO","VALUES","SET","CREATE","ALTER","TABLE","DATABASE","EXEC","EXECUTE","DECLARE","CAST","CONVERT","CHAR","VARCHAR","CONCAT","SUBSTRING","ASCII","BENCHMARK","SLEEP","WAITFOR","DELAY","IF","CASE","WHEN","THEN","ELSE","END","NULL","NOT","LIKE","BETWEEN","EXISTS","IN","ALL","ANY","SOME"];function Y(e,t=3){const n=[];for(let s=0;s<t;s++){let r="";for(let o=0;o<e.length;o++){const l=e[o];/[a-zA-Z]/.test(l)?r+=Math.random()>.5?l.toUpperCase():l.toLowerCase():r+=l}r!==e&&n.push(r)}return[...new Set(n)]}function K(e){const t=[];let n=e;for(const o of _){const l=new RegExp(`\\b(${o})\\b`,"gi");if(l.test(n)){n=n.replace(l,a=>a.split("").join("/**/"));break}}n!==e&&t.push(n);let s=e;for(const o of _){const l=new RegExp(`\\b(${o})\\b`,"gi");s=s.replace(l,a=>a.split("").join("/**/"))}s!==e&&s!==n&&t.push(s);const r=e.replace(/ /g,"/**/");return r!==e&&t.push(r),[...new Set(t)]}function b(e){return e.split("").map(t=>{const n=t.charCodeAt(0);return/[a-zA-Z0-9]/.test(t)?t:"%"+n.toString(16).toUpperCase().padStart(2,"0")}).join("")}function v(e){return e.split("").map(t=>"%"+t.charCodeAt(0).toString(16).toUpperCase().padStart(2,"0")).join("")}function X(e){return b(b(e))}function Z(e){return v(e).split("").map(t=>t==="%"?"%25":"%"+t.charCodeAt(0).toString(16).toUpperCase().padStart(2,"0")).join("")}const B=[{id:"case_mixing",name:"大小写混淆",nameEn:"Case Mixing",description:"随机化字符串中每个字母的大小写，绕过大小写敏感的正则匹配",transform:e=>Y(e,5)},{id:"inline_comment",name:"内联注释插入",nameEn:"Inline Comments",description:"在 SQL 关键字字符间及空格处插入 /**/ 注释，打断关键字匹配",transform:e=>K(e)},{id:"url_encode",name:"URL 编码",nameEn:"URL Encoding",description:"对特殊字符进行单次 URL 编码",transform:e=>{const t=[],n=b(e);return n!==e&&t.push(n),t.push(v(e)),t}},{id:"double_url_encode",name:"双重 URL 编码",nameEn:"Double URL Encoding",description:"对 payload 进行两次 URL 编码，绕过只做一次 URL 解码的 WAF",transform:e=>[X(e),Z(e)]},{id:"unicode_sub",name:"Unicode 替换",nameEn:"Unicode Substitution",description:"将 ASCII 字符替换为视觉相似的 Unicode 字符（同形文字攻击）",transform:e=>{const t={a:"ａ",A:"Ａ",e:"ｅ",E:"Ｅ",i:"ｉ",I:"Ｉ",o:"ｏ",O:"Ｏ",u:"ｕ",U:"Ｕ",s:"ｓ",S:"Ｓ",c:"ｃ",C:"Ｃ",l:"ｌ",L:"Ｌ",t:"ｔ",T:"Ｔ","'":"‘",'"':"“","<":"＜",">":"＞","/":"／","\\":"＼","(":"（",")":"）","=":"＝"," ":" "},n=e.split("").map(o=>t[o]||o).join(""),s=[];n!==e&&s.push(n);const r=e.split("").map(o=>{const l=o.charCodeAt(0);return l>127||/[a-zA-Z]/.test(o)?"\\u"+l.toString(16).padStart(4,"0"):o}).join("");return r!==e&&s.push(r),s}},{id:"whitespace_alt",name:"空白符替换",nameEn:"Whitespace Alternatives",description:"将空格替换为 Tab、换行、注释等 WAF 可能忽略的空白字符",transform:e=>[["%09","Tab"],["%0a","换行"],["%0d","回车"],["/**/","注释"],["%a0","NBSP"],["+","加号"],["%0b","垂直Tab"],["%0c","换页"]].map(([n])=>e.replace(/ /g,n)).filter(n=>n!==e)},{id:"hex_encode",name:"十六进制编码",nameEn:"Hex Encoding",description:"将字符串转换为 0x 十六进制格式（SQL 中常用于绕过字符串检测）",transform:e=>{const t=[],n="0x"+e.split("").map(r=>r.charCodeAt(0).toString(16).padStart(2,"0")).join("");t.push(n);let s=e;for(const r of _){const o=new RegExp(`\\b(${r})\\b`,"gi");s=s.replace(o,l=>"0x"+l.split("").map(a=>a.charCodeAt(0).toString(16).padStart(2,"0")).join(""))}return s!==e&&t.push(s),[...new Set(t)]}},{id:"char_encode",name:"CHAR() 编码",nameEn:"CHAR() Encoding",description:"将字符串用 SQL CHAR() 函数逐字符编码，绕过字符串字面量检测",transform:e=>{const t=[],n=e.split("").map(o=>o.charCodeAt(0));t.push(`CHAR(${n.join(",")})`);const s=n.map(o=>`CHR(${o})`).join("||");t.push(s);const r=`CONCAT(${n.map(o=>`CHAR(${o})`).join(",")})`;return t.push(r),t}},{id:"concat_split",name:"拼接拆分",nameEn:"Concat Split",description:"将关键字拆分后通过字符串拼接函数重新组合",transform:e=>{const t=[];let n=e;for(const o of _){const l=new RegExp(`\\b(${o})\\b`,"gi");n=n.replace(l,a=>{if(a.length<3)return a;const p=Math.floor(a.length/2);return`CONCAT('${a.slice(0,p)}','${a.slice(p)}')`})}n!==e&&t.push(n);let s=e;for(const o of _){const l=new RegExp(`\\b(${o})\\b`,"gi");s=s.replace(l,a=>{if(a.length<3)return a;const p=Math.floor(a.length/2);return`'${a.slice(0,p)}'||'${a.slice(p)}'`})}s!==e&&t.push(s);let r=e;for(const o of _){const l=new RegExp(`\\b(${o})\\b`,"gi");r=r.replace(l,a=>{if(a.length<3)return a;const p=Math.floor(a.length/2);return`'${a.slice(0,p)}'+'${a.slice(p)}'`})}return r!==e&&t.push(r),[...new Set(t)]}},{id:"comment_variations",name:"注释符变体",nameEn:"Comment Variations",description:"在 payload 末尾添加不同风格的注释符截断后续 SQL",transform:e=>["-- ","--+","-- -","#","%23","/*",";%00","/*!*/","-- /*"].map(n=>`${e}${n}`)},{id:"no_space_sql",name:"无空格 SQL",nameEn:"No-Space SQL",description:"利用括号分组消除空格需求，如 WHERE(1=1)AND(2=2)",transform:e=>{const t=[];let n=e.replace(/\s+WHERE\s+/gi," WHERE(").replace(/\s+AND\s+/gi,")AND(").replace(/\s+OR\s+/gi,")OR(");const s=(n.match(/\(/g)||[]).length,r=(n.match(/\)/g)||[]).length;s>r&&(n+=")".repeat(s-r)),n!==e&&t.push(n);const o=e.replace(/ /g,"");return o!==e&&t.push(o),t}},{id:"html_entity",name:"HTML 实体编码",nameEn:"HTML Entity Encoding",description:"将字符转换为 HTML 十进制/十六进制实体编码",transform:e=>{const t=[],n=e.split("").map(o=>`&#${o.charCodeAt(0)};`).join("");t.push(n);const s=e.split("").map(o=>`&#x${o.charCodeAt(0).toString(16)};`).join("");t.push(s);const r=e.split("").map(o=>/[<>"'&=();\/ ]/.test(o)?`&#${o.charCodeAt(0)};`:o).join("");return r!==n&&t.push(r),[...new Set(t)]}},{id:"newline_injection",name:"换行注入",nameEn:"Newline Injection",description:"在关键字字符间插入 %0a（换行），部分解析器会忽略行内换行",transform:e=>{const t=[],n=e.split("").join("%0a");t.push(n);let s=e;for(const o of _){const l=new RegExp(`\\b(${o})\\b`,"gi");s=s.replace(l,a=>a.split("").join("%0a"))}s!==e&&s!==n&&t.push(s);const r=e.replace(/ /g,"%0d%0a");return r!==e&&t.push(r),[...new Set(t)]}}],J=new Map(B.map(e=>[e.id,e]));function ee(e,t){return e.trim()?t.map(n=>{const s=J.get(n);if(!s)return null;try{const r=s.transform(e);return{technique:n,results:r.filter(o=>o&&o!==e)}}catch{return{technique:n,results:[]}}}).filter(n=>n!==null&&n.results.length>0):[]}const te={class:"sectool-waf-technique-grid"},ne={class:"sectool-waf-result-count"},oe={class:"sectool-waf-section-title"},se={key:1,class:"sectool-waf-empty"},re=k({__name:"WafBypass",async setup(e){let t,n;const s=B,r={};for(const i of s)r[i.id]=!0;const o=O(([t,n]=M(()=>V({input:"",selectAll:!0,techniques:{...r}})),t=await t,n(),t)),l=Q([]),a=F(()=>l.reduce((i,c)=>i+c.results.length,0)),p=()=>{const i=o.current.selectAll;for(const c of s)o.current.techniques[c.id]=i},T=i=>{const c=s.find(h=>h.id===i);return c?c.name:i},H=()=>{const i=s.filter(h=>o.current.techniques[h.id]).map(h=>h.id),c=ee(o.current.input,i);l.length=0,l.push(...c),o.save()};return(i,c)=>{const h=C("Textarea"),S=C("Align"),N=C("Bool"),x=C("Display"),I=C("Button"),q=C("HeightResize"),D=G("row");return W((m(),g("div",null,[u(S,{direction:"vertical"},{default:f(()=>[u(x,null,{extra:f(()=>[u(S,null,{default:f(()=>[u(N,{size:"small",modelValue:A(o).current.selectAll,"onUpdate:modelValue":c[1]||(c[1]=d=>A(o).current.selectAll=d),border:"",label:i.$t("wafBypass_select_all"),onChange:p},null,8,["modelValue","label"])]),_:1})]),default:f(()=>[u(S,{direction:"vertical"},{default:f(()=>[u(h,{modelValue:A(o).current.input,"onUpdate:modelValue":c[0]||(c[0]=d=>A(o).current.input=d),height:80,label:i.$t("wafBypass_input"),placeholder:i.$t("wafBypass_input_placeholder")},null,8,["modelValue","label","placeholder"])]),_:1})]),_:1}),u(x,null,{extra:f(()=>[u(S,null,{default:f(()=>[u(I,{label:i.$t("wafBypass_generate"),onClick:H},null,8,["label"])]),_:1})]),default:f(()=>[u(S,{direction:"vertical"},{default:f(()=>[w("div",te,[(m(!0),g(R,null,y(A(s),d=>(m(),$(N,{key:d.id,size:"small",modelValue:A(o).current.techniques[d.id],"onUpdate:modelValue":E=>A(o).current.techniques[d.id]=E,border:"",label:d.name},null,8,["modelValue","onUpdate:modelValue","label"]))),128))])]),_:1})]),_:1})]),_:1}),u(q,null,{default:f(({height:d})=>[w("div",{style:z({height:d+"px",overflowY:"auto"})},[l.length>0?(m(),g(R,{key:0},[w("div",ne,L(i.$t("wafBypass_result_count",[a.value])),1),(m(!0),g(R,null,y(l,E=>(m(),g(R,{key:E.technique},[w("div",oe,L(T(E.technique)),1),(m(!0),g(R,null,y(E.results,(j,U)=>(m(),$(h,{key:E.technique+"-"+U,"model-value":j,height:42,copy:T(E.technique)+" #"+(U+1)},null,8,["model-value","copy"]))),128))],64))),128))],64)):(m(),g("div",se,L(i.$t("wafBypass_empty_hint")),1))],4)]),_:1})])),[[D,"10-14"]])}}}),de=P(re,[["__scopeId","data-v-a54e7fc2"]]);export{de as default};
