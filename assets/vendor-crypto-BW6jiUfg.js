import{c as Nn,g as Un}from"./vendor-lodash-BDISS5yc.js";import{r as La,a as hn,B as _n}from"./vendor-D2QpS8Sq.js";var Br={exports:{}};function Ka(te){throw new Error('Could not dynamically require "'+te+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Pr={exports:{}},Ma=Pr.exports,xi;function Be(){return xi||(xi=1,(function(te,me){(function(Y,T){te.exports=T()})(Ma,function(){var Y=Y||(function(T,O){var Q;if(typeof window<"u"&&window.crypto&&(Q=window.crypto),typeof self<"u"&&self.crypto&&(Q=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(Q=globalThis.crypto),!Q&&typeof window<"u"&&window.msCrypto&&(Q=window.msCrypto),!Q&&typeof Nn<"u"&&Nn.crypto&&(Q=Nn.crypto),!Q&&typeof Ka=="function")try{Q=La()}catch{}var ie=function(){if(Q){if(typeof Q.getRandomValues=="function")try{return Q.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof Q.randomBytes=="function")try{return Q.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},N=Object.create||(function(){function A(){}return function(C){var H;return A.prototype=C,H=new A,A.prototype=null,H}})(),k={},F=k.lib={},B=F.Base=(function(){return{extend:function(A){var C=N(this);return A&&C.mixIn(A),(!C.hasOwnProperty("init")||this.init===C.init)&&(C.init=function(){C.$super.init.apply(this,arguments)}),C.init.prototype=C,C.$super=this,C},create:function(){var A=this.extend();return A.init.apply(A,arguments),A},init:function(){},mixIn:function(A){for(var C in A)A.hasOwnProperty(C)&&(this[C]=A[C]);A.hasOwnProperty("toString")&&(this.toString=A.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),b=F.WordArray=B.extend({init:function(A,C){A=this.words=A||[],C!=O?this.sigBytes=C:this.sigBytes=A.length*4},toString:function(A){return(A||q).stringify(this)},concat:function(A){var C=this.words,H=A.words,_=this.sigBytes,z=A.sigBytes;if(this.clamp(),_%4)for(var J=0;J<z;J++){var re=H[J>>>2]>>>24-J%4*8&255;C[_+J>>>2]|=re<<24-(_+J)%4*8}else for(var ae=0;ae<z;ae+=4)C[_+ae>>>2]=H[ae>>>2];return this.sigBytes+=z,this},clamp:function(){var A=this.words,C=this.sigBytes;A[C>>>2]&=4294967295<<32-C%4*8,A.length=T.ceil(C/4)},clone:function(){var A=B.clone.call(this);return A.words=this.words.slice(0),A},random:function(A){for(var C=[],H=0;H<A;H+=4)C.push(ie());return new b.init(C,A)}}),D=k.enc={},q=D.Hex={stringify:function(A){for(var C=A.words,H=A.sigBytes,_=[],z=0;z<H;z++){var J=C[z>>>2]>>>24-z%4*8&255;_.push((J>>>4).toString(16)),_.push((J&15).toString(16))}return _.join("")},parse:function(A){for(var C=A.length,H=[],_=0;_<C;_+=2)H[_>>>3]|=parseInt(A.substr(_,2),16)<<24-_%8*4;return new b.init(H,C/2)}},j=D.Latin1={stringify:function(A){for(var C=A.words,H=A.sigBytes,_=[],z=0;z<H;z++){var J=C[z>>>2]>>>24-z%4*8&255;_.push(String.fromCharCode(J))}return _.join("")},parse:function(A){for(var C=A.length,H=[],_=0;_<C;_++)H[_>>>2]|=(A.charCodeAt(_)&255)<<24-_%4*8;return new b.init(H,C)}},M=D.Utf8={stringify:function(A){try{return decodeURIComponent(escape(j.stringify(A)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(A){return j.parse(unescape(encodeURIComponent(A)))}},R=F.BufferedBlockAlgorithm=B.extend({reset:function(){this._data=new b.init,this._nDataBytes=0},_append:function(A){typeof A=="string"&&(A=M.parse(A)),this._data.concat(A),this._nDataBytes+=A.sigBytes},_process:function(A){var C,H=this._data,_=H.words,z=H.sigBytes,J=this.blockSize,re=J*4,ae=z/re;A?ae=T.ceil(ae):ae=T.max((ae|0)-this._minBufferSize,0);var $=ae*J,Z=T.min($*4,z);if($){for(var ne=0;ne<$;ne+=J)this._doProcessBlock(_,ne);C=_.splice(0,$),H.sigBytes-=Z}return new b.init(C,Z)},clone:function(){var A=B.clone.call(this);return A._data=this._data.clone(),A},_minBufferSize:0});F.Hasher=R.extend({cfg:B.extend(),init:function(A){this.cfg=this.cfg.extend(A),this.reset()},reset:function(){R.reset.call(this),this._doReset()},update:function(A){return this._append(A),this._process(),this},finalize:function(A){A&&this._append(A);var C=this._doFinalize();return C},blockSize:16,_createHelper:function(A){return function(C,H){return new A.init(H).finalize(C)}},_createHmacHelper:function(A){return function(C,H){return new V.HMAC.init(A,H).finalize(C)}}});var V=k.algo={};return k})(Math);return Y})})(Pr)),Pr.exports}var Ir={exports:{}},Ua=Ir.exports,pi;function cn(){return pi||(pi=1,(function(te,me){(function(Y,T){te.exports=T(Be())})(Ua,function(Y){return(function(T){var O=Y,Q=O.lib,ie=Q.Base,N=Q.WordArray,k=O.x64={};k.Word=ie.extend({init:function(F,B){this.high=F,this.low=B}}),k.WordArray=ie.extend({init:function(F,B){F=this.words=F||[],B!=T?this.sigBytes=B:this.sigBytes=F.length*8},toX32:function(){for(var F=this.words,B=F.length,b=[],D=0;D<B;D++){var q=F[D];b.push(q.high),b.push(q.low)}return N.create(b,this.sigBytes)},clone:function(){for(var F=ie.clone.call(this),B=F.words=this.words.slice(0),b=B.length,D=0;D<b;D++)B[D]=B[D].clone();return F}})})(),Y})})(Ir)),Ir.exports}var Rr={exports:{}},za=Rr.exports,gi;function Wa(){return gi||(gi=1,(function(te,me){(function(Y,T){te.exports=T(Be())})(za,function(Y){return(function(){if(typeof ArrayBuffer=="function"){var T=Y,O=T.lib,Q=O.WordArray,ie=Q.init,N=Q.init=function(k){if(k instanceof ArrayBuffer&&(k=new Uint8Array(k)),(k instanceof Int8Array||typeof Uint8ClampedArray<"u"&&k instanceof Uint8ClampedArray||k instanceof Int16Array||k instanceof Uint16Array||k instanceof Int32Array||k instanceof Uint32Array||k instanceof Float32Array||k instanceof Float64Array)&&(k=new Uint8Array(k.buffer,k.byteOffset,k.byteLength)),k instanceof Uint8Array){for(var F=k.byteLength,B=[],b=0;b<F;b++)B[b>>>2]|=k[b]<<24-b%4*8;ie.call(this,B,F)}else ie.apply(this,arguments)};N.prototype=Q}})(),Y.lib.WordArray})})(Rr)),Rr.exports}var Tr={exports:{}},$a=Tr.exports,yi;function Ga(){return yi||(yi=1,(function(te,me){(function(Y,T){te.exports=T(Be())})($a,function(Y){return(function(){var T=Y,O=T.lib,Q=O.WordArray,ie=T.enc;ie.Utf16=ie.Utf16BE={stringify:function(k){for(var F=k.words,B=k.sigBytes,b=[],D=0;D<B;D+=2){var q=F[D>>>2]>>>16-D%4*8&65535;b.push(String.fromCharCode(q))}return b.join("")},parse:function(k){for(var F=k.length,B=[],b=0;b<F;b++)B[b>>>1]|=k.charCodeAt(b)<<16-b%2*16;return Q.create(B,F*2)}},ie.Utf16LE={stringify:function(k){for(var F=k.words,B=k.sigBytes,b=[],D=0;D<B;D+=2){var q=N(F[D>>>2]>>>16-D%4*8&65535);b.push(String.fromCharCode(q))}return b.join("")},parse:function(k){for(var F=k.length,B=[],b=0;b<F;b++)B[b>>>1]|=N(k.charCodeAt(b)<<16-b%2*16);return Q.create(B,F*2)}};function N(k){return k<<8&4278255360|k>>>8&16711935}})(),Y.enc.Utf16})})(Tr)),Tr.exports}var Hr={exports:{}},Xa=Hr.exports,mi;function Wt(){return mi||(mi=1,(function(te,me){(function(Y,T){te.exports=T(Be())})(Xa,function(Y){return(function(){var T=Y,O=T.lib,Q=O.WordArray,ie=T.enc;ie.Base64={stringify:function(k){var F=k.words,B=k.sigBytes,b=this._map;k.clamp();for(var D=[],q=0;q<B;q+=3)for(var j=F[q>>>2]>>>24-q%4*8&255,M=F[q+1>>>2]>>>24-(q+1)%4*8&255,R=F[q+2>>>2]>>>24-(q+2)%4*8&255,V=j<<16|M<<8|R,A=0;A<4&&q+A*.75<B;A++)D.push(b.charAt(V>>>6*(3-A)&63));var C=b.charAt(64);if(C)for(;D.length%4;)D.push(C);return D.join("")},parse:function(k){var F=k.length,B=this._map,b=this._reverseMap;if(!b){b=this._reverseMap=[];for(var D=0;D<B.length;D++)b[B.charCodeAt(D)]=D}var q=B.charAt(64);if(q){var j=k.indexOf(q);j!==-1&&(F=j)}return N(k,F,b)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function N(k,F,B){for(var b=[],D=0,q=0;q<F;q++)if(q%4){var j=B[k.charCodeAt(q-1)]<<q%4*2,M=B[k.charCodeAt(q)]>>>6-q%4*2,R=j|M;b[D>>>2]|=R<<24-D%4*8,D++}return Q.create(b,D)}})(),Y.enc.Base64})})(Hr)),Hr.exports}var Nr={exports:{}},Ya=Nr.exports,Si;function Za(){return Si||(Si=1,(function(te,me){(function(Y,T){te.exports=T(Be())})(Ya,function(Y){return(function(){var T=Y,O=T.lib,Q=O.WordArray,ie=T.enc;ie.Base64url={stringify:function(k,F=!0){var B=k.words,b=k.sigBytes,D=F?this._safe_map:this._map;k.clamp();for(var q=[],j=0;j<b;j+=3)for(var M=B[j>>>2]>>>24-j%4*8&255,R=B[j+1>>>2]>>>24-(j+1)%4*8&255,V=B[j+2>>>2]>>>24-(j+2)%4*8&255,A=M<<16|R<<8|V,C=0;C<4&&j+C*.75<b;C++)q.push(D.charAt(A>>>6*(3-C)&63));var H=D.charAt(64);if(H)for(;q.length%4;)q.push(H);return q.join("")},parse:function(k,F=!0){var B=k.length,b=F?this._safe_map:this._map,D=this._reverseMap;if(!D){D=this._reverseMap=[];for(var q=0;q<b.length;q++)D[b.charCodeAt(q)]=q}var j=b.charAt(64);if(j){var M=k.indexOf(j);M!==-1&&(B=M)}return N(k,B,D)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function N(k,F,B){for(var b=[],D=0,q=0;q<F;q++)if(q%4){var j=B[k.charCodeAt(q-1)]<<q%4*2,M=B[k.charCodeAt(q)]>>>6-q%4*2,R=j|M;b[D>>>2]|=R<<24-D%4*8,D++}return Q.create(b,D)}})(),Y.enc.Base64url})})(Nr)),Nr.exports}var _r={exports:{}},Ja=_r.exports,bi;function $t(){return bi||(bi=1,(function(te,me){(function(Y,T){te.exports=T(Be())})(Ja,function(Y){return(function(T){var O=Y,Q=O.lib,ie=Q.WordArray,N=Q.Hasher,k=O.algo,F=[];(function(){for(var M=0;M<64;M++)F[M]=T.abs(T.sin(M+1))*4294967296|0})();var B=k.MD5=N.extend({_doReset:function(){this._hash=new ie.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(M,R){for(var V=0;V<16;V++){var A=R+V,C=M[A];M[A]=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360}var H=this._hash.words,_=M[R+0],z=M[R+1],J=M[R+2],re=M[R+3],ae=M[R+4],$=M[R+5],Z=M[R+6],ne=M[R+7],se=M[R+8],ge=M[R+9],ye=M[R+10],Se=M[R+11],Fe=M[R+12],Ce=M[R+13],Re=M[R+14],Pe=M[R+15],ce=H[0],oe=H[1],xe=H[2],de=H[3];ce=b(ce,oe,xe,de,_,7,F[0]),de=b(de,ce,oe,xe,z,12,F[1]),xe=b(xe,de,ce,oe,J,17,F[2]),oe=b(oe,xe,de,ce,re,22,F[3]),ce=b(ce,oe,xe,de,ae,7,F[4]),de=b(de,ce,oe,xe,$,12,F[5]),xe=b(xe,de,ce,oe,Z,17,F[6]),oe=b(oe,xe,de,ce,ne,22,F[7]),ce=b(ce,oe,xe,de,se,7,F[8]),de=b(de,ce,oe,xe,ge,12,F[9]),xe=b(xe,de,ce,oe,ye,17,F[10]),oe=b(oe,xe,de,ce,Se,22,F[11]),ce=b(ce,oe,xe,de,Fe,7,F[12]),de=b(de,ce,oe,xe,Ce,12,F[13]),xe=b(xe,de,ce,oe,Re,17,F[14]),oe=b(oe,xe,de,ce,Pe,22,F[15]),ce=D(ce,oe,xe,de,z,5,F[16]),de=D(de,ce,oe,xe,Z,9,F[17]),xe=D(xe,de,ce,oe,Se,14,F[18]),oe=D(oe,xe,de,ce,_,20,F[19]),ce=D(ce,oe,xe,de,$,5,F[20]),de=D(de,ce,oe,xe,ye,9,F[21]),xe=D(xe,de,ce,oe,Pe,14,F[22]),oe=D(oe,xe,de,ce,ae,20,F[23]),ce=D(ce,oe,xe,de,ge,5,F[24]),de=D(de,ce,oe,xe,Re,9,F[25]),xe=D(xe,de,ce,oe,re,14,F[26]),oe=D(oe,xe,de,ce,se,20,F[27]),ce=D(ce,oe,xe,de,Ce,5,F[28]),de=D(de,ce,oe,xe,J,9,F[29]),xe=D(xe,de,ce,oe,ne,14,F[30]),oe=D(oe,xe,de,ce,Fe,20,F[31]),ce=q(ce,oe,xe,de,$,4,F[32]),de=q(de,ce,oe,xe,se,11,F[33]),xe=q(xe,de,ce,oe,Se,16,F[34]),oe=q(oe,xe,de,ce,Re,23,F[35]),ce=q(ce,oe,xe,de,z,4,F[36]),de=q(de,ce,oe,xe,ae,11,F[37]),xe=q(xe,de,ce,oe,ne,16,F[38]),oe=q(oe,xe,de,ce,ye,23,F[39]),ce=q(ce,oe,xe,de,Ce,4,F[40]),de=q(de,ce,oe,xe,_,11,F[41]),xe=q(xe,de,ce,oe,re,16,F[42]),oe=q(oe,xe,de,ce,Z,23,F[43]),ce=q(ce,oe,xe,de,ge,4,F[44]),de=q(de,ce,oe,xe,Fe,11,F[45]),xe=q(xe,de,ce,oe,Pe,16,F[46]),oe=q(oe,xe,de,ce,J,23,F[47]),ce=j(ce,oe,xe,de,_,6,F[48]),de=j(de,ce,oe,xe,ne,10,F[49]),xe=j(xe,de,ce,oe,Re,15,F[50]),oe=j(oe,xe,de,ce,$,21,F[51]),ce=j(ce,oe,xe,de,Fe,6,F[52]),de=j(de,ce,oe,xe,re,10,F[53]),xe=j(xe,de,ce,oe,ye,15,F[54]),oe=j(oe,xe,de,ce,z,21,F[55]),ce=j(ce,oe,xe,de,se,6,F[56]),de=j(de,ce,oe,xe,Pe,10,F[57]),xe=j(xe,de,ce,oe,Z,15,F[58]),oe=j(oe,xe,de,ce,Ce,21,F[59]),ce=j(ce,oe,xe,de,ae,6,F[60]),de=j(de,ce,oe,xe,Se,10,F[61]),xe=j(xe,de,ce,oe,J,15,F[62]),oe=j(oe,xe,de,ce,ge,21,F[63]),H[0]=H[0]+ce|0,H[1]=H[1]+oe|0,H[2]=H[2]+xe|0,H[3]=H[3]+de|0},_doFinalize:function(){var M=this._data,R=M.words,V=this._nDataBytes*8,A=M.sigBytes*8;R[A>>>5]|=128<<24-A%32;var C=T.floor(V/4294967296),H=V;R[(A+64>>>9<<4)+15]=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,R[(A+64>>>9<<4)+14]=(H<<8|H>>>24)&16711935|(H<<24|H>>>8)&4278255360,M.sigBytes=(R.length+1)*4,this._process();for(var _=this._hash,z=_.words,J=0;J<4;J++){var re=z[J];z[J]=(re<<8|re>>>24)&16711935|(re<<24|re>>>8)&4278255360}return _},clone:function(){var M=N.clone.call(this);return M._hash=this._hash.clone(),M}});function b(M,R,V,A,C,H,_){var z=M+(R&V|~R&A)+C+_;return(z<<H|z>>>32-H)+R}function D(M,R,V,A,C,H,_){var z=M+(R&A|V&~A)+C+_;return(z<<H|z>>>32-H)+R}function q(M,R,V,A,C,H,_){var z=M+(R^V^A)+C+_;return(z<<H|z>>>32-H)+R}function j(M,R,V,A,C,H,_){var z=M+(V^(R|~A))+C+_;return(z<<H|z>>>32-H)+R}O.MD5=N._createHelper(B),O.HmacMD5=N._createHmacHelper(B)})(Math),Y.MD5})})(_r)),_r.exports}var Or={exports:{}},Qa=Or.exports,wi;function zn(){return wi||(wi=1,(function(te,me){(function(Y,T){te.exports=T(Be())})(Qa,function(Y){return(function(){var T=Y,O=T.lib,Q=O.WordArray,ie=O.Hasher,N=T.algo,k=[],F=N.SHA1=ie.extend({_doReset:function(){this._hash=new Q.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(B,b){for(var D=this._hash.words,q=D[0],j=D[1],M=D[2],R=D[3],V=D[4],A=0;A<80;A++){if(A<16)k[A]=B[b+A]|0;else{var C=k[A-3]^k[A-8]^k[A-14]^k[A-16];k[A]=C<<1|C>>>31}var H=(q<<5|q>>>27)+V+k[A];A<20?H+=(j&M|~j&R)+1518500249:A<40?H+=(j^M^R)+1859775393:A<60?H+=(j&M|j&R|M&R)-1894007588:H+=(j^M^R)-899497514,V=R,R=M,M=j<<30|j>>>2,j=q,q=H}D[0]=D[0]+q|0,D[1]=D[1]+j|0,D[2]=D[2]+M|0,D[3]=D[3]+R|0,D[4]=D[4]+V|0},_doFinalize:function(){var B=this._data,b=B.words,D=this._nDataBytes*8,q=B.sigBytes*8;return b[q>>>5]|=128<<24-q%32,b[(q+64>>>9<<4)+14]=Math.floor(D/4294967296),b[(q+64>>>9<<4)+15]=D,B.sigBytes=b.length*4,this._process(),this._hash},clone:function(){var B=ie.clone.call(this);return B._hash=this._hash.clone(),B}});T.SHA1=ie._createHelper(F),T.HmacSHA1=ie._createHmacHelper(F)})(),Y.SHA1})})(Or)),Or.exports}var jr={exports:{}},e0=jr.exports,Ei;function ss(){return Ei||(Ei=1,(function(te,me){(function(Y,T){te.exports=T(Be())})(e0,function(Y){return(function(T){var O=Y,Q=O.lib,ie=Q.WordArray,N=Q.Hasher,k=O.algo,F=[],B=[];(function(){function q(V){for(var A=T.sqrt(V),C=2;C<=A;C++)if(!(V%C))return!1;return!0}function j(V){return(V-(V|0))*4294967296|0}for(var M=2,R=0;R<64;)q(M)&&(R<8&&(F[R]=j(T.pow(M,1/2))),B[R]=j(T.pow(M,1/3)),R++),M++})();var b=[],D=k.SHA256=N.extend({_doReset:function(){this._hash=new ie.init(F.slice(0))},_doProcessBlock:function(q,j){for(var M=this._hash.words,R=M[0],V=M[1],A=M[2],C=M[3],H=M[4],_=M[5],z=M[6],J=M[7],re=0;re<64;re++){if(re<16)b[re]=q[j+re]|0;else{var ae=b[re-15],$=(ae<<25|ae>>>7)^(ae<<14|ae>>>18)^ae>>>3,Z=b[re-2],ne=(Z<<15|Z>>>17)^(Z<<13|Z>>>19)^Z>>>10;b[re]=$+b[re-7]+ne+b[re-16]}var se=H&_^~H&z,ge=R&V^R&A^V&A,ye=(R<<30|R>>>2)^(R<<19|R>>>13)^(R<<10|R>>>22),Se=(H<<26|H>>>6)^(H<<21|H>>>11)^(H<<7|H>>>25),Fe=J+Se+se+B[re]+b[re],Ce=ye+ge;J=z,z=_,_=H,H=C+Fe|0,C=A,A=V,V=R,R=Fe+Ce|0}M[0]=M[0]+R|0,M[1]=M[1]+V|0,M[2]=M[2]+A|0,M[3]=M[3]+C|0,M[4]=M[4]+H|0,M[5]=M[5]+_|0,M[6]=M[6]+z|0,M[7]=M[7]+J|0},_doFinalize:function(){var q=this._data,j=q.words,M=this._nDataBytes*8,R=q.sigBytes*8;return j[R>>>5]|=128<<24-R%32,j[(R+64>>>9<<4)+14]=T.floor(M/4294967296),j[(R+64>>>9<<4)+15]=M,q.sigBytes=j.length*4,this._process(),this._hash},clone:function(){var q=N.clone.call(this);return q._hash=this._hash.clone(),q}});O.SHA256=N._createHelper(D),O.HmacSHA256=N._createHmacHelper(D)})(Math),Y.SHA256})})(jr)),jr.exports}var qr={exports:{}},t0=qr.exports,Fi;function r0(){return Fi||(Fi=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),ss())})(t0,function(Y){return(function(){var T=Y,O=T.lib,Q=O.WordArray,ie=T.algo,N=ie.SHA256,k=ie.SHA224=N.extend({_doReset:function(){this._hash=new Q.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var F=N._doFinalize.call(this);return F.sigBytes-=4,F}});T.SHA224=N._createHelper(k),T.HmacSHA224=N._createHmacHelper(k)})(),Y.SHA224})})(qr)),qr.exports}var kr={exports:{}},n0=kr.exports,Ai;function as(){return Ai||(Ai=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),cn())})(n0,function(Y){return(function(){var T=Y,O=T.lib,Q=O.Hasher,ie=T.x64,N=ie.Word,k=ie.WordArray,F=T.algo;function B(){return N.create.apply(N,arguments)}var b=[B(1116352408,3609767458),B(1899447441,602891725),B(3049323471,3964484399),B(3921009573,2173295548),B(961987163,4081628472),B(1508970993,3053834265),B(2453635748,2937671579),B(2870763221,3664609560),B(3624381080,2734883394),B(310598401,1164996542),B(607225278,1323610764),B(1426881987,3590304994),B(1925078388,4068182383),B(2162078206,991336113),B(2614888103,633803317),B(3248222580,3479774868),B(3835390401,2666613458),B(4022224774,944711139),B(264347078,2341262773),B(604807628,2007800933),B(770255983,1495990901),B(1249150122,1856431235),B(1555081692,3175218132),B(1996064986,2198950837),B(2554220882,3999719339),B(2821834349,766784016),B(2952996808,2566594879),B(3210313671,3203337956),B(3336571891,1034457026),B(3584528711,2466948901),B(113926993,3758326383),B(338241895,168717936),B(666307205,1188179964),B(773529912,1546045734),B(1294757372,1522805485),B(1396182291,2643833823),B(1695183700,2343527390),B(1986661051,1014477480),B(2177026350,1206759142),B(2456956037,344077627),B(2730485921,1290863460),B(2820302411,3158454273),B(3259730800,3505952657),B(3345764771,106217008),B(3516065817,3606008344),B(3600352804,1432725776),B(4094571909,1467031594),B(275423344,851169720),B(430227734,3100823752),B(506948616,1363258195),B(659060556,3750685593),B(883997877,3785050280),B(958139571,3318307427),B(1322822218,3812723403),B(1537002063,2003034995),B(1747873779,3602036899),B(1955562222,1575990012),B(2024104815,1125592928),B(2227730452,2716904306),B(2361852424,442776044),B(2428436474,593698344),B(2756734187,3733110249),B(3204031479,2999351573),B(3329325298,3815920427),B(3391569614,3928383900),B(3515267271,566280711),B(3940187606,3454069534),B(4118630271,4000239992),B(116418474,1914138554),B(174292421,2731055270),B(289380356,3203993006),B(460393269,320620315),B(685471733,587496836),B(852142971,1086792851),B(1017036298,365543100),B(1126000580,2618297676),B(1288033470,3409855158),B(1501505948,4234509866),B(1607167915,987167468),B(1816402316,1246189591)],D=[];(function(){for(var j=0;j<80;j++)D[j]=B()})();var q=F.SHA512=Q.extend({_doReset:function(){this._hash=new k.init([new N.init(1779033703,4089235720),new N.init(3144134277,2227873595),new N.init(1013904242,4271175723),new N.init(2773480762,1595750129),new N.init(1359893119,2917565137),new N.init(2600822924,725511199),new N.init(528734635,4215389547),new N.init(1541459225,327033209)])},_doProcessBlock:function(j,M){for(var R=this._hash.words,V=R[0],A=R[1],C=R[2],H=R[3],_=R[4],z=R[5],J=R[6],re=R[7],ae=V.high,$=V.low,Z=A.high,ne=A.low,se=C.high,ge=C.low,ye=H.high,Se=H.low,Fe=_.high,Ce=_.low,Re=z.high,Pe=z.low,ce=J.high,oe=J.low,xe=re.high,de=re.low,qe=ae,_e=$,Ue=Z,Ee=ne,It=se,At=ge,Gt=ye,Rt=Se,lt=Fe,$e=Ce,Vt=Re,Tt=Pe,Lt=ce,Ht=oe,Xt=xe,Nt=de,dt=0;dt<80;dt++){var ot,mt,Kt=D[dt];if(dt<16)mt=Kt.high=j[M+dt*2]|0,ot=Kt.low=j[M+dt*2+1]|0;else{var nr=D[dt-15],Ct=nr.high,_t=nr.low,ln=(Ct>>>1|_t<<31)^(Ct>>>8|_t<<24)^Ct>>>7,ir=(_t>>>1|Ct<<31)^(_t>>>8|Ct<<24)^(_t>>>7|Ct<<25),sr=D[dt-2],Dt=sr.high,Ot=sr.low,dn=(Dt>>>19|Ot<<13)^(Dt<<3|Ot>>>29)^Dt>>>6,ar=(Ot>>>19|Dt<<13)^(Ot<<3|Dt>>>29)^(Ot>>>6|Dt<<26),or=D[dt-7],vn=or.high,xn=or.low,ur=D[dt-16],Yt=ur.high,fr=ur.low;ot=ir+xn,mt=ln+vn+(ot>>>0<ir>>>0?1:0),ot=ot+ar,mt=mt+dn+(ot>>>0<ar>>>0?1:0),ot=ot+fr,mt=mt+Yt+(ot>>>0<fr>>>0?1:0),Kt.high=mt,Kt.low=ot}var hr=lt&Vt^~lt&Lt,cr=$e&Tt^~$e&Ht,lr=qe&Ue^qe&It^Ue&It,pn=_e&Ee^_e&At^Ee&At,gn=(qe>>>28|_e<<4)^(qe<<30|_e>>>2)^(qe<<25|_e>>>7),dr=(_e>>>28|qe<<4)^(_e<<30|qe>>>2)^(_e<<25|qe>>>7),yn=(lt>>>14|$e<<18)^(lt>>>18|$e<<14)^(lt<<23|$e>>>9),mn=($e>>>14|lt<<18)^($e>>>18|lt<<14)^($e<<23|lt>>>9),vr=b[dt],Sn=vr.high,xr=vr.low,it=Nt+mn,St=Xt+yn+(it>>>0<Nt>>>0?1:0),it=it+cr,St=St+hr+(it>>>0<cr>>>0?1:0),it=it+xr,St=St+Sn+(it>>>0<xr>>>0?1:0),it=it+ot,St=St+mt+(it>>>0<ot>>>0?1:0),pr=dr+pn,bn=gn+lr+(pr>>>0<dr>>>0?1:0);Xt=Lt,Nt=Ht,Lt=Vt,Ht=Tt,Vt=lt,Tt=$e,$e=Rt+it|0,lt=Gt+St+($e>>>0<Rt>>>0?1:0)|0,Gt=It,Rt=At,It=Ue,At=Ee,Ue=qe,Ee=_e,_e=it+pr|0,qe=St+bn+(_e>>>0<it>>>0?1:0)|0}$=V.low=$+_e,V.high=ae+qe+($>>>0<_e>>>0?1:0),ne=A.low=ne+Ee,A.high=Z+Ue+(ne>>>0<Ee>>>0?1:0),ge=C.low=ge+At,C.high=se+It+(ge>>>0<At>>>0?1:0),Se=H.low=Se+Rt,H.high=ye+Gt+(Se>>>0<Rt>>>0?1:0),Ce=_.low=Ce+$e,_.high=Fe+lt+(Ce>>>0<$e>>>0?1:0),Pe=z.low=Pe+Tt,z.high=Re+Vt+(Pe>>>0<Tt>>>0?1:0),oe=J.low=oe+Ht,J.high=ce+Lt+(oe>>>0<Ht>>>0?1:0),de=re.low=de+Nt,re.high=xe+Xt+(de>>>0<Nt>>>0?1:0)},_doFinalize:function(){var j=this._data,M=j.words,R=this._nDataBytes*8,V=j.sigBytes*8;M[V>>>5]|=128<<24-V%32,M[(V+128>>>10<<5)+30]=Math.floor(R/4294967296),M[(V+128>>>10<<5)+31]=R,j.sigBytes=M.length*4,this._process();var A=this._hash.toX32();return A},clone:function(){var j=Q.clone.call(this);return j._hash=this._hash.clone(),j},blockSize:1024/32});T.SHA512=Q._createHelper(q),T.HmacSHA512=Q._createHmacHelper(q)})(),Y.SHA512})})(kr)),kr.exports}var Vr={exports:{}},i0=Vr.exports,Ci;function s0(){return Ci||(Ci=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),cn(),as())})(i0,function(Y){return(function(){var T=Y,O=T.x64,Q=O.Word,ie=O.WordArray,N=T.algo,k=N.SHA512,F=N.SHA384=k.extend({_doReset:function(){this._hash=new ie.init([new Q.init(3418070365,3238371032),new Q.init(1654270250,914150663),new Q.init(2438529370,812702999),new Q.init(355462360,4144912697),new Q.init(1731405415,4290775857),new Q.init(2394180231,1750603025),new Q.init(3675008525,1694076839),new Q.init(1203062813,3204075428)])},_doFinalize:function(){var B=k._doFinalize.call(this);return B.sigBytes-=16,B}});T.SHA384=k._createHelper(F),T.HmacSHA384=k._createHmacHelper(F)})(),Y.SHA384})})(Vr)),Vr.exports}var Lr={exports:{}},a0=Lr.exports,Di;function o0(){return Di||(Di=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),cn())})(a0,function(Y){return(function(T){var O=Y,Q=O.lib,ie=Q.WordArray,N=Q.Hasher,k=O.x64,F=k.Word,B=O.algo,b=[],D=[],q=[];(function(){for(var R=1,V=0,A=0;A<24;A++){b[R+5*V]=(A+1)*(A+2)/2%64;var C=V%5,H=(2*R+3*V)%5;R=C,V=H}for(var R=0;R<5;R++)for(var V=0;V<5;V++)D[R+5*V]=V+(2*R+3*V)%5*5;for(var _=1,z=0;z<24;z++){for(var J=0,re=0,ae=0;ae<7;ae++){if(_&1){var $=(1<<ae)-1;$<32?re^=1<<$:J^=1<<$-32}_&128?_=_<<1^113:_<<=1}q[z]=F.create(J,re)}})();var j=[];(function(){for(var R=0;R<25;R++)j[R]=F.create()})();var M=B.SHA3=N.extend({cfg:N.cfg.extend({outputLength:512}),_doReset:function(){for(var R=this._state=[],V=0;V<25;V++)R[V]=new F.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(R,V){for(var A=this._state,C=this.blockSize/2,H=0;H<C;H++){var _=R[V+2*H],z=R[V+2*H+1];_=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,z=(z<<8|z>>>24)&16711935|(z<<24|z>>>8)&4278255360;var J=A[H];J.high^=z,J.low^=_}for(var re=0;re<24;re++){for(var ae=0;ae<5;ae++){for(var $=0,Z=0,ne=0;ne<5;ne++){var J=A[ae+5*ne];$^=J.high,Z^=J.low}var se=j[ae];se.high=$,se.low=Z}for(var ae=0;ae<5;ae++)for(var ge=j[(ae+4)%5],ye=j[(ae+1)%5],Se=ye.high,Fe=ye.low,$=ge.high^(Se<<1|Fe>>>31),Z=ge.low^(Fe<<1|Se>>>31),ne=0;ne<5;ne++){var J=A[ae+5*ne];J.high^=$,J.low^=Z}for(var Ce=1;Ce<25;Ce++){var $,Z,J=A[Ce],Re=J.high,Pe=J.low,ce=b[Ce];ce<32?($=Re<<ce|Pe>>>32-ce,Z=Pe<<ce|Re>>>32-ce):($=Pe<<ce-32|Re>>>64-ce,Z=Re<<ce-32|Pe>>>64-ce);var oe=j[D[Ce]];oe.high=$,oe.low=Z}var xe=j[0],de=A[0];xe.high=de.high,xe.low=de.low;for(var ae=0;ae<5;ae++)for(var ne=0;ne<5;ne++){var Ce=ae+5*ne,J=A[Ce],qe=j[Ce],_e=j[(ae+1)%5+5*ne],Ue=j[(ae+2)%5+5*ne];J.high=qe.high^~_e.high&Ue.high,J.low=qe.low^~_e.low&Ue.low}var J=A[0],Ee=q[re];J.high^=Ee.high,J.low^=Ee.low}},_doFinalize:function(){var R=this._data,V=R.words;this._nDataBytes*8;var A=R.sigBytes*8,C=this.blockSize*32;V[A>>>5]|=1<<24-A%32,V[(T.ceil((A+1)/C)*C>>>5)-1]|=128,R.sigBytes=V.length*4,this._process();for(var H=this._state,_=this.cfg.outputLength/8,z=_/8,J=[],re=0;re<z;re++){var ae=H[re],$=ae.high,Z=ae.low;$=($<<8|$>>>24)&16711935|($<<24|$>>>8)&4278255360,Z=(Z<<8|Z>>>24)&16711935|(Z<<24|Z>>>8)&4278255360,J.push(Z),J.push($)}return new ie.init(J,_)},clone:function(){for(var R=N.clone.call(this),V=R._state=this._state.slice(0),A=0;A<25;A++)V[A]=V[A].clone();return R}});O.SHA3=N._createHelper(M),O.HmacSHA3=N._createHmacHelper(M)})(Math),Y.SHA3})})(Lr)),Lr.exports}var Kr={exports:{}},u0=Kr.exports,Bi;function f0(){return Bi||(Bi=1,(function(te,me){(function(Y,T){te.exports=T(Be())})(u0,function(Y){/** @preserve
			(c) 2012 by CÃ©dric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return(function(T){var O=Y,Q=O.lib,ie=Q.WordArray,N=Q.Hasher,k=O.algo,F=ie.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),B=ie.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),b=ie.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),D=ie.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),q=ie.create([0,1518500249,1859775393,2400959708,2840853838]),j=ie.create([1352829926,1548603684,1836072691,2053994217,0]),M=k.RIPEMD160=N.extend({_doReset:function(){this._hash=ie.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(z,J){for(var re=0;re<16;re++){var ae=J+re,$=z[ae];z[ae]=($<<8|$>>>24)&16711935|($<<24|$>>>8)&4278255360}var Z=this._hash.words,ne=q.words,se=j.words,ge=F.words,ye=B.words,Se=b.words,Fe=D.words,Ce,Re,Pe,ce,oe,xe,de,qe,_e,Ue;xe=Ce=Z[0],de=Re=Z[1],qe=Pe=Z[2],_e=ce=Z[3],Ue=oe=Z[4];for(var Ee,re=0;re<80;re+=1)Ee=Ce+z[J+ge[re]]|0,re<16?Ee+=R(Re,Pe,ce)+ne[0]:re<32?Ee+=V(Re,Pe,ce)+ne[1]:re<48?Ee+=A(Re,Pe,ce)+ne[2]:re<64?Ee+=C(Re,Pe,ce)+ne[3]:Ee+=H(Re,Pe,ce)+ne[4],Ee=Ee|0,Ee=_(Ee,Se[re]),Ee=Ee+oe|0,Ce=oe,oe=ce,ce=_(Pe,10),Pe=Re,Re=Ee,Ee=xe+z[J+ye[re]]|0,re<16?Ee+=H(de,qe,_e)+se[0]:re<32?Ee+=C(de,qe,_e)+se[1]:re<48?Ee+=A(de,qe,_e)+se[2]:re<64?Ee+=V(de,qe,_e)+se[3]:Ee+=R(de,qe,_e)+se[4],Ee=Ee|0,Ee=_(Ee,Fe[re]),Ee=Ee+Ue|0,xe=Ue,Ue=_e,_e=_(qe,10),qe=de,de=Ee;Ee=Z[1]+Pe+_e|0,Z[1]=Z[2]+ce+Ue|0,Z[2]=Z[3]+oe+xe|0,Z[3]=Z[4]+Ce+de|0,Z[4]=Z[0]+Re+qe|0,Z[0]=Ee},_doFinalize:function(){var z=this._data,J=z.words,re=this._nDataBytes*8,ae=z.sigBytes*8;J[ae>>>5]|=128<<24-ae%32,J[(ae+64>>>9<<4)+14]=(re<<8|re>>>24)&16711935|(re<<24|re>>>8)&4278255360,z.sigBytes=(J.length+1)*4,this._process();for(var $=this._hash,Z=$.words,ne=0;ne<5;ne++){var se=Z[ne];Z[ne]=(se<<8|se>>>24)&16711935|(se<<24|se>>>8)&4278255360}return $},clone:function(){var z=N.clone.call(this);return z._hash=this._hash.clone(),z}});function R(z,J,re){return z^J^re}function V(z,J,re){return z&J|~z&re}function A(z,J,re){return(z|~J)^re}function C(z,J,re){return z&re|J&~re}function H(z,J,re){return z^(J|~re)}function _(z,J){return z<<J|z>>>32-J}O.RIPEMD160=N._createHelper(M),O.HmacRIPEMD160=N._createHmacHelper(M)})(),Y.RIPEMD160})})(Kr)),Kr.exports}var Mr={exports:{}},h0=Mr.exports,Pi;function Wn(){return Pi||(Pi=1,(function(te,me){(function(Y,T){te.exports=T(Be())})(h0,function(Y){(function(){var T=Y,O=T.lib,Q=O.Base,ie=T.enc,N=ie.Utf8,k=T.algo;k.HMAC=Q.extend({init:function(F,B){F=this._hasher=new F.init,typeof B=="string"&&(B=N.parse(B));var b=F.blockSize,D=b*4;B.sigBytes>D&&(B=F.finalize(B)),B.clamp();for(var q=this._oKey=B.clone(),j=this._iKey=B.clone(),M=q.words,R=j.words,V=0;V<b;V++)M[V]^=1549556828,R[V]^=909522486;q.sigBytes=j.sigBytes=D,this.reset()},reset:function(){var F=this._hasher;F.reset(),F.update(this._iKey)},update:function(F){return this._hasher.update(F),this},finalize:function(F){var B=this._hasher,b=B.finalize(F);B.reset();var D=B.finalize(this._oKey.clone().concat(b));return D}})})()})})(Mr)),Mr.exports}var Ur={exports:{}},c0=Ur.exports,Ii;function l0(){return Ii||(Ii=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),zn(),Wn())})(c0,function(Y){return(function(){var T=Y,O=T.lib,Q=O.Base,ie=O.WordArray,N=T.algo,k=N.SHA1,F=N.HMAC,B=N.PBKDF2=Q.extend({cfg:Q.extend({keySize:128/32,hasher:k,iterations:1}),init:function(b){this.cfg=this.cfg.extend(b)},compute:function(b,D){for(var q=this.cfg,j=F.create(q.hasher,b),M=ie.create(),R=ie.create([1]),V=M.words,A=R.words,C=q.keySize,H=q.iterations;V.length<C;){var _=j.update(D).finalize(R);j.reset();for(var z=_.words,J=z.length,re=_,ae=1;ae<H;ae++){re=j.finalize(re),j.reset();for(var $=re.words,Z=0;Z<J;Z++)z[Z]^=$[Z]}M.concat(_),A[0]++}return M.sigBytes=C*4,M}});T.PBKDF2=function(b,D,q){return B.create(q).compute(b,D)}})(),Y.PBKDF2})})(Ur)),Ur.exports}var zr={exports:{}},d0=zr.exports,Ri;function kt(){return Ri||(Ri=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),zn(),Wn())})(d0,function(Y){return(function(){var T=Y,O=T.lib,Q=O.Base,ie=O.WordArray,N=T.algo,k=N.MD5,F=N.EvpKDF=Q.extend({cfg:Q.extend({keySize:128/32,hasher:k,iterations:1}),init:function(B){this.cfg=this.cfg.extend(B)},compute:function(B,b){for(var D,q=this.cfg,j=q.hasher.create(),M=ie.create(),R=M.words,V=q.keySize,A=q.iterations;R.length<V;){D&&j.update(D),D=j.update(B).finalize(b),j.reset();for(var C=1;C<A;C++)D=j.finalize(D),j.reset();M.concat(D)}return M.sigBytes=V*4,M}});T.EvpKDF=function(B,b,D){return F.create(D).compute(B,b)}})(),Y.EvpKDF})})(zr)),zr.exports}var Wr={exports:{}},v0=Wr.exports,Ti;function tt(){return Ti||(Ti=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),kt())})(v0,function(Y){Y.lib.Cipher||(function(T){var O=Y,Q=O.lib,ie=Q.Base,N=Q.WordArray,k=Q.BufferedBlockAlgorithm,F=O.enc;F.Utf8;var B=F.Base64,b=O.algo,D=b.EvpKDF,q=Q.Cipher=k.extend({cfg:ie.extend(),createEncryptor:function($,Z){return this.create(this._ENC_XFORM_MODE,$,Z)},createDecryptor:function($,Z){return this.create(this._DEC_XFORM_MODE,$,Z)},init:function($,Z,ne){this.cfg=this.cfg.extend(ne),this._xformMode=$,this._key=Z,this.reset()},reset:function(){k.reset.call(this),this._doReset()},process:function($){return this._append($),this._process()},finalize:function($){$&&this._append($);var Z=this._doFinalize();return Z},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:(function(){function $(Z){return typeof Z=="string"?ae:z}return function(Z){return{encrypt:function(ne,se,ge){return $(se).encrypt(Z,ne,se,ge)},decrypt:function(ne,se,ge){return $(se).decrypt(Z,ne,se,ge)}}}})()});Q.StreamCipher=q.extend({_doFinalize:function(){var $=this._process(!0);return $},blockSize:1});var j=O.mode={},M=Q.BlockCipherMode=ie.extend({createEncryptor:function($,Z){return this.Encryptor.create($,Z)},createDecryptor:function($,Z){return this.Decryptor.create($,Z)},init:function($,Z){this._cipher=$,this._iv=Z}}),R=j.CBC=(function(){var $=M.extend();$.Encryptor=$.extend({processBlock:function(ne,se){var ge=this._cipher,ye=ge.blockSize;Z.call(this,ne,se,ye),ge.encryptBlock(ne,se),this._prevBlock=ne.slice(se,se+ye)}}),$.Decryptor=$.extend({processBlock:function(ne,se){var ge=this._cipher,ye=ge.blockSize,Se=ne.slice(se,se+ye);ge.decryptBlock(ne,se),Z.call(this,ne,se,ye),this._prevBlock=Se}});function Z(ne,se,ge){var ye,Se=this._iv;Se?(ye=Se,this._iv=T):ye=this._prevBlock;for(var Fe=0;Fe<ge;Fe++)ne[se+Fe]^=ye[Fe]}return $})(),V=O.pad={},A=V.Pkcs7={pad:function($,Z){for(var ne=Z*4,se=ne-$.sigBytes%ne,ge=se<<24|se<<16|se<<8|se,ye=[],Se=0;Se<se;Se+=4)ye.push(ge);var Fe=N.create(ye,se);$.concat(Fe)},unpad:function($){var Z=$.words[$.sigBytes-1>>>2]&255;$.sigBytes-=Z}};Q.BlockCipher=q.extend({cfg:q.cfg.extend({mode:R,padding:A}),reset:function(){var $;q.reset.call(this);var Z=this.cfg,ne=Z.iv,se=Z.mode;this._xformMode==this._ENC_XFORM_MODE?$=se.createEncryptor:($=se.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==$?this._mode.init(this,ne&&ne.words):(this._mode=$.call(se,this,ne&&ne.words),this._mode.__creator=$)},_doProcessBlock:function($,Z){this._mode.processBlock($,Z)},_doFinalize:function(){var $,Z=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(Z.pad(this._data,this.blockSize),$=this._process(!0)):($=this._process(!0),Z.unpad($)),$},blockSize:128/32});var C=Q.CipherParams=ie.extend({init:function($){this.mixIn($)},toString:function($){return($||this.formatter).stringify(this)}}),H=O.format={},_=H.OpenSSL={stringify:function($){var Z,ne=$.ciphertext,se=$.salt;return se?Z=N.create([1398893684,1701076831]).concat(se).concat(ne):Z=ne,Z.toString(B)},parse:function($){var Z,ne=B.parse($),se=ne.words;return se[0]==1398893684&&se[1]==1701076831&&(Z=N.create(se.slice(2,4)),se.splice(0,4),ne.sigBytes-=16),C.create({ciphertext:ne,salt:Z})}},z=Q.SerializableCipher=ie.extend({cfg:ie.extend({format:_}),encrypt:function($,Z,ne,se){se=this.cfg.extend(se);var ge=$.createEncryptor(ne,se),ye=ge.finalize(Z),Se=ge.cfg;return C.create({ciphertext:ye,key:ne,iv:Se.iv,algorithm:$,mode:Se.mode,padding:Se.padding,blockSize:$.blockSize,formatter:se.format})},decrypt:function($,Z,ne,se){se=this.cfg.extend(se),Z=this._parse(Z,se.format);var ge=$.createDecryptor(ne,se).finalize(Z.ciphertext);return ge},_parse:function($,Z){return typeof $=="string"?Z.parse($,this):$}}),J=O.kdf={},re=J.OpenSSL={execute:function($,Z,ne,se){se||(se=N.random(64/8));var ge=D.create({keySize:Z+ne}).compute($,se),ye=N.create(ge.words.slice(Z),ne*4);return ge.sigBytes=Z*4,C.create({key:ge,iv:ye,salt:se})}},ae=Q.PasswordBasedCipher=z.extend({cfg:z.cfg.extend({kdf:re}),encrypt:function($,Z,ne,se){se=this.cfg.extend(se);var ge=se.kdf.execute(ne,$.keySize,$.ivSize);se.iv=ge.iv;var ye=z.encrypt.call(this,$,Z,ge.key,se);return ye.mixIn(ge),ye},decrypt:function($,Z,ne,se){se=this.cfg.extend(se),Z=this._parse(Z,se.format);var ge=se.kdf.execute(ne,$.keySize,$.ivSize,Z.salt);se.iv=ge.iv;var ye=z.decrypt.call(this,$,Z,ge.key,se);return ye}})})()})})(Wr)),Wr.exports}var $r={exports:{}},x0=$r.exports,Hi;function p0(){return Hi||(Hi=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),tt())})(x0,function(Y){return Y.mode.CFB=(function(){var T=Y.lib.BlockCipherMode.extend();T.Encryptor=T.extend({processBlock:function(Q,ie){var N=this._cipher,k=N.blockSize;O.call(this,Q,ie,k,N),this._prevBlock=Q.slice(ie,ie+k)}}),T.Decryptor=T.extend({processBlock:function(Q,ie){var N=this._cipher,k=N.blockSize,F=Q.slice(ie,ie+k);O.call(this,Q,ie,k,N),this._prevBlock=F}});function O(Q,ie,N,k){var F,B=this._iv;B?(F=B.slice(0),this._iv=void 0):F=this._prevBlock,k.encryptBlock(F,0);for(var b=0;b<N;b++)Q[ie+b]^=F[b]}return T})(),Y.mode.CFB})})($r)),$r.exports}var Gr={exports:{}},g0=Gr.exports,Ni;function y0(){return Ni||(Ni=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),tt())})(g0,function(Y){return Y.mode.CTR=(function(){var T=Y.lib.BlockCipherMode.extend(),O=T.Encryptor=T.extend({processBlock:function(Q,ie){var N=this._cipher,k=N.blockSize,F=this._iv,B=this._counter;F&&(B=this._counter=F.slice(0),this._iv=void 0);var b=B.slice(0);N.encryptBlock(b,0),B[k-1]=B[k-1]+1|0;for(var D=0;D<k;D++)Q[ie+D]^=b[D]}});return T.Decryptor=O,T})(),Y.mode.CTR})})(Gr)),Gr.exports}var Xr={exports:{}},m0=Xr.exports,_i;function S0(){return _i||(_i=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),tt())})(m0,function(Y){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return Y.mode.CTRGladman=(function(){var T=Y.lib.BlockCipherMode.extend();function O(N){if((N>>24&255)===255){var k=N>>16&255,F=N>>8&255,B=N&255;k===255?(k=0,F===255?(F=0,B===255?B=0:++B):++F):++k,N=0,N+=k<<16,N+=F<<8,N+=B}else N+=1<<24;return N}function Q(N){return(N[0]=O(N[0]))===0&&(N[1]=O(N[1])),N}var ie=T.Encryptor=T.extend({processBlock:function(N,k){var F=this._cipher,B=F.blockSize,b=this._iv,D=this._counter;b&&(D=this._counter=b.slice(0),this._iv=void 0),Q(D);var q=D.slice(0);F.encryptBlock(q,0);for(var j=0;j<B;j++)N[k+j]^=q[j]}});return T.Decryptor=ie,T})(),Y.mode.CTRGladman})})(Xr)),Xr.exports}var Yr={exports:{}},b0=Yr.exports,Oi;function w0(){return Oi||(Oi=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),tt())})(b0,function(Y){return Y.mode.OFB=(function(){var T=Y.lib.BlockCipherMode.extend(),O=T.Encryptor=T.extend({processBlock:function(Q,ie){var N=this._cipher,k=N.blockSize,F=this._iv,B=this._keystream;F&&(B=this._keystream=F.slice(0),this._iv=void 0),N.encryptBlock(B,0);for(var b=0;b<k;b++)Q[ie+b]^=B[b]}});return T.Decryptor=O,T})(),Y.mode.OFB})})(Yr)),Yr.exports}var Zr={exports:{}},E0=Zr.exports,ji;function F0(){return ji||(ji=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),tt())})(E0,function(Y){return Y.mode.ECB=(function(){var T=Y.lib.BlockCipherMode.extend();return T.Encryptor=T.extend({processBlock:function(O,Q){this._cipher.encryptBlock(O,Q)}}),T.Decryptor=T.extend({processBlock:function(O,Q){this._cipher.decryptBlock(O,Q)}}),T})(),Y.mode.ECB})})(Zr)),Zr.exports}var Jr={exports:{}},A0=Jr.exports,qi;function C0(){return qi||(qi=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),tt())})(A0,function(Y){return Y.pad.AnsiX923={pad:function(T,O){var Q=T.sigBytes,ie=O*4,N=ie-Q%ie,k=Q+N-1;T.clamp(),T.words[k>>>2]|=N<<24-k%4*8,T.sigBytes+=N},unpad:function(T){var O=T.words[T.sigBytes-1>>>2]&255;T.sigBytes-=O}},Y.pad.Ansix923})})(Jr)),Jr.exports}var Qr={exports:{}},D0=Qr.exports,ki;function B0(){return ki||(ki=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),tt())})(D0,function(Y){return Y.pad.Iso10126={pad:function(T,O){var Q=O*4,ie=Q-T.sigBytes%Q;T.concat(Y.lib.WordArray.random(ie-1)).concat(Y.lib.WordArray.create([ie<<24],1))},unpad:function(T){var O=T.words[T.sigBytes-1>>>2]&255;T.sigBytes-=O}},Y.pad.Iso10126})})(Qr)),Qr.exports}var en={exports:{}},P0=en.exports,Vi;function I0(){return Vi||(Vi=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),tt())})(P0,function(Y){return Y.pad.Iso97971={pad:function(T,O){T.concat(Y.lib.WordArray.create([2147483648],1)),Y.pad.ZeroPadding.pad(T,O)},unpad:function(T){Y.pad.ZeroPadding.unpad(T),T.sigBytes--}},Y.pad.Iso97971})})(en)),en.exports}var tn={exports:{}},R0=tn.exports,Li;function T0(){return Li||(Li=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),tt())})(R0,function(Y){return Y.pad.ZeroPadding={pad:function(T,O){var Q=O*4;T.clamp(),T.sigBytes+=Q-(T.sigBytes%Q||Q)},unpad:function(T){for(var O=T.words,Q=T.sigBytes-1,Q=T.sigBytes-1;Q>=0;Q--)if(O[Q>>>2]>>>24-Q%4*8&255){T.sigBytes=Q+1;break}}},Y.pad.ZeroPadding})})(tn)),tn.exports}var rn={exports:{}},H0=rn.exports,Ki;function N0(){return Ki||(Ki=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),tt())})(H0,function(Y){return Y.pad.NoPadding={pad:function(){},unpad:function(){}},Y.pad.NoPadding})})(rn)),rn.exports}var nn={exports:{}},_0=nn.exports,Mi;function O0(){return Mi||(Mi=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),tt())})(_0,function(Y){return(function(T){var O=Y,Q=O.lib,ie=Q.CipherParams,N=O.enc,k=N.Hex,F=O.format;F.Hex={stringify:function(B){return B.ciphertext.toString(k)},parse:function(B){var b=k.parse(B);return ie.create({ciphertext:b})}}})(),Y.format.Hex})})(nn)),nn.exports}var sn={exports:{}},j0=sn.exports,Ui;function q0(){return Ui||(Ui=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),Wt(),$t(),kt(),tt())})(j0,function(Y){return(function(){var T=Y,O=T.lib,Q=O.BlockCipher,ie=T.algo,N=[],k=[],F=[],B=[],b=[],D=[],q=[],j=[],M=[],R=[];(function(){for(var C=[],H=0;H<256;H++)H<128?C[H]=H<<1:C[H]=H<<1^283;for(var _=0,z=0,H=0;H<256;H++){var J=z^z<<1^z<<2^z<<3^z<<4;J=J>>>8^J&255^99,N[_]=J,k[J]=_;var re=C[_],ae=C[re],$=C[ae],Z=C[J]*257^J*16843008;F[_]=Z<<24|Z>>>8,B[_]=Z<<16|Z>>>16,b[_]=Z<<8|Z>>>24,D[_]=Z;var Z=$*16843009^ae*65537^re*257^_*16843008;q[J]=Z<<24|Z>>>8,j[J]=Z<<16|Z>>>16,M[J]=Z<<8|Z>>>24,R[J]=Z,_?(_=re^C[C[C[$^re]]],z^=C[C[z]]):_=z=1}})();var V=[0,1,2,4,8,16,32,64,128,27,54],A=ie.AES=Q.extend({_doReset:function(){var C;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var H=this._keyPriorReset=this._key,_=H.words,z=H.sigBytes/4,J=this._nRounds=z+6,re=(J+1)*4,ae=this._keySchedule=[],$=0;$<re;$++)$<z?ae[$]=_[$]:(C=ae[$-1],$%z?z>6&&$%z==4&&(C=N[C>>>24]<<24|N[C>>>16&255]<<16|N[C>>>8&255]<<8|N[C&255]):(C=C<<8|C>>>24,C=N[C>>>24]<<24|N[C>>>16&255]<<16|N[C>>>8&255]<<8|N[C&255],C^=V[$/z|0]<<24),ae[$]=ae[$-z]^C);for(var Z=this._invKeySchedule=[],ne=0;ne<re;ne++){var $=re-ne;if(ne%4)var C=ae[$];else var C=ae[$-4];ne<4||$<=4?Z[ne]=C:Z[ne]=q[N[C>>>24]]^j[N[C>>>16&255]]^M[N[C>>>8&255]]^R[N[C&255]]}}},encryptBlock:function(C,H){this._doCryptBlock(C,H,this._keySchedule,F,B,b,D,N)},decryptBlock:function(C,H){var _=C[H+1];C[H+1]=C[H+3],C[H+3]=_,this._doCryptBlock(C,H,this._invKeySchedule,q,j,M,R,k);var _=C[H+1];C[H+1]=C[H+3],C[H+3]=_},_doCryptBlock:function(C,H,_,z,J,re,ae,$){for(var Z=this._nRounds,ne=C[H]^_[0],se=C[H+1]^_[1],ge=C[H+2]^_[2],ye=C[H+3]^_[3],Se=4,Fe=1;Fe<Z;Fe++){var Ce=z[ne>>>24]^J[se>>>16&255]^re[ge>>>8&255]^ae[ye&255]^_[Se++],Re=z[se>>>24]^J[ge>>>16&255]^re[ye>>>8&255]^ae[ne&255]^_[Se++],Pe=z[ge>>>24]^J[ye>>>16&255]^re[ne>>>8&255]^ae[se&255]^_[Se++],ce=z[ye>>>24]^J[ne>>>16&255]^re[se>>>8&255]^ae[ge&255]^_[Se++];ne=Ce,se=Re,ge=Pe,ye=ce}var Ce=($[ne>>>24]<<24|$[se>>>16&255]<<16|$[ge>>>8&255]<<8|$[ye&255])^_[Se++],Re=($[se>>>24]<<24|$[ge>>>16&255]<<16|$[ye>>>8&255]<<8|$[ne&255])^_[Se++],Pe=($[ge>>>24]<<24|$[ye>>>16&255]<<16|$[ne>>>8&255]<<8|$[se&255])^_[Se++],ce=($[ye>>>24]<<24|$[ne>>>16&255]<<16|$[se>>>8&255]<<8|$[ge&255])^_[Se++];C[H]=Ce,C[H+1]=Re,C[H+2]=Pe,C[H+3]=ce},keySize:256/32});T.AES=Q._createHelper(A)})(),Y.AES})})(sn)),sn.exports}var an={exports:{}},k0=an.exports,zi;function V0(){return zi||(zi=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),Wt(),$t(),kt(),tt())})(k0,function(Y){return(function(){var T=Y,O=T.lib,Q=O.WordArray,ie=O.BlockCipher,N=T.algo,k=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],F=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],B=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],b=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],D=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],q=N.DES=ie.extend({_doReset:function(){for(var V=this._key,A=V.words,C=[],H=0;H<56;H++){var _=k[H]-1;C[H]=A[_>>>5]>>>31-_%32&1}for(var z=this._subKeys=[],J=0;J<16;J++){for(var re=z[J]=[],ae=B[J],H=0;H<24;H++)re[H/6|0]|=C[(F[H]-1+ae)%28]<<31-H%6,re[4+(H/6|0)]|=C[28+(F[H+24]-1+ae)%28]<<31-H%6;re[0]=re[0]<<1|re[0]>>>31;for(var H=1;H<7;H++)re[H]=re[H]>>>(H-1)*4+3;re[7]=re[7]<<5|re[7]>>>27}for(var $=this._invSubKeys=[],H=0;H<16;H++)$[H]=z[15-H]},encryptBlock:function(V,A){this._doCryptBlock(V,A,this._subKeys)},decryptBlock:function(V,A){this._doCryptBlock(V,A,this._invSubKeys)},_doCryptBlock:function(V,A,C){this._lBlock=V[A],this._rBlock=V[A+1],j.call(this,4,252645135),j.call(this,16,65535),M.call(this,2,858993459),M.call(this,8,16711935),j.call(this,1,1431655765);for(var H=0;H<16;H++){for(var _=C[H],z=this._lBlock,J=this._rBlock,re=0,ae=0;ae<8;ae++)re|=b[ae][((J^_[ae])&D[ae])>>>0];this._lBlock=J,this._rBlock=z^re}var $=this._lBlock;this._lBlock=this._rBlock,this._rBlock=$,j.call(this,1,1431655765),M.call(this,8,16711935),M.call(this,2,858993459),j.call(this,16,65535),j.call(this,4,252645135),V[A]=this._lBlock,V[A+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function j(V,A){var C=(this._lBlock>>>V^this._rBlock)&A;this._rBlock^=C,this._lBlock^=C<<V}function M(V,A){var C=(this._rBlock>>>V^this._lBlock)&A;this._lBlock^=C,this._rBlock^=C<<V}T.DES=ie._createHelper(q);var R=N.TripleDES=ie.extend({_doReset:function(){var V=this._key,A=V.words;if(A.length!==2&&A.length!==4&&A.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var C=A.slice(0,2),H=A.length<4?A.slice(0,2):A.slice(2,4),_=A.length<6?A.slice(0,2):A.slice(4,6);this._des1=q.createEncryptor(Q.create(C)),this._des2=q.createEncryptor(Q.create(H)),this._des3=q.createEncryptor(Q.create(_))},encryptBlock:function(V,A){this._des1.encryptBlock(V,A),this._des2.decryptBlock(V,A),this._des3.encryptBlock(V,A)},decryptBlock:function(V,A){this._des3.decryptBlock(V,A),this._des2.encryptBlock(V,A),this._des1.decryptBlock(V,A)},keySize:192/32,ivSize:64/32,blockSize:64/32});T.TripleDES=ie._createHelper(R)})(),Y.TripleDES})})(an)),an.exports}var on={exports:{}},L0=on.exports,Wi;function K0(){return Wi||(Wi=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),Wt(),$t(),kt(),tt())})(L0,function(Y){return(function(){var T=Y,O=T.lib,Q=O.StreamCipher,ie=T.algo,N=ie.RC4=Q.extend({_doReset:function(){for(var B=this._key,b=B.words,D=B.sigBytes,q=this._S=[],j=0;j<256;j++)q[j]=j;for(var j=0,M=0;j<256;j++){var R=j%D,V=b[R>>>2]>>>24-R%4*8&255;M=(M+q[j]+V)%256;var A=q[j];q[j]=q[M],q[M]=A}this._i=this._j=0},_doProcessBlock:function(B,b){B[b]^=k.call(this)},keySize:256/32,ivSize:0});function k(){for(var B=this._S,b=this._i,D=this._j,q=0,j=0;j<4;j++){b=(b+1)%256,D=(D+B[b])%256;var M=B[b];B[b]=B[D],B[D]=M,q|=B[(B[b]+B[D])%256]<<24-j*8}return this._i=b,this._j=D,q}T.RC4=Q._createHelper(N);var F=ie.RC4Drop=N.extend({cfg:N.cfg.extend({drop:192}),_doReset:function(){N._doReset.call(this);for(var B=this.cfg.drop;B>0;B--)k.call(this)}});T.RC4Drop=Q._createHelper(F)})(),Y.RC4})})(on)),on.exports}var un={exports:{}},M0=un.exports,$i;function U0(){return $i||($i=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),Wt(),$t(),kt(),tt())})(M0,function(Y){return(function(){var T=Y,O=T.lib,Q=O.StreamCipher,ie=T.algo,N=[],k=[],F=[],B=ie.Rabbit=Q.extend({_doReset:function(){for(var D=this._key.words,q=this.cfg.iv,j=0;j<4;j++)D[j]=(D[j]<<8|D[j]>>>24)&16711935|(D[j]<<24|D[j]>>>8)&4278255360;var M=this._X=[D[0],D[3]<<16|D[2]>>>16,D[1],D[0]<<16|D[3]>>>16,D[2],D[1]<<16|D[0]>>>16,D[3],D[2]<<16|D[1]>>>16],R=this._C=[D[2]<<16|D[2]>>>16,D[0]&4294901760|D[1]&65535,D[3]<<16|D[3]>>>16,D[1]&4294901760|D[2]&65535,D[0]<<16|D[0]>>>16,D[2]&4294901760|D[3]&65535,D[1]<<16|D[1]>>>16,D[3]&4294901760|D[0]&65535];this._b=0;for(var j=0;j<4;j++)b.call(this);for(var j=0;j<8;j++)R[j]^=M[j+4&7];if(q){var V=q.words,A=V[0],C=V[1],H=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,_=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,z=H>>>16|_&4294901760,J=_<<16|H&65535;R[0]^=H,R[1]^=z,R[2]^=_,R[3]^=J,R[4]^=H,R[5]^=z,R[6]^=_,R[7]^=J;for(var j=0;j<4;j++)b.call(this)}},_doProcessBlock:function(D,q){var j=this._X;b.call(this),N[0]=j[0]^j[5]>>>16^j[3]<<16,N[1]=j[2]^j[7]>>>16^j[5]<<16,N[2]=j[4]^j[1]>>>16^j[7]<<16,N[3]=j[6]^j[3]>>>16^j[1]<<16;for(var M=0;M<4;M++)N[M]=(N[M]<<8|N[M]>>>24)&16711935|(N[M]<<24|N[M]>>>8)&4278255360,D[q+M]^=N[M]},blockSize:128/32,ivSize:64/32});function b(){for(var D=this._X,q=this._C,j=0;j<8;j++)k[j]=q[j];q[0]=q[0]+1295307597+this._b|0,q[1]=q[1]+3545052371+(q[0]>>>0<k[0]>>>0?1:0)|0,q[2]=q[2]+886263092+(q[1]>>>0<k[1]>>>0?1:0)|0,q[3]=q[3]+1295307597+(q[2]>>>0<k[2]>>>0?1:0)|0,q[4]=q[4]+3545052371+(q[3]>>>0<k[3]>>>0?1:0)|0,q[5]=q[5]+886263092+(q[4]>>>0<k[4]>>>0?1:0)|0,q[6]=q[6]+1295307597+(q[5]>>>0<k[5]>>>0?1:0)|0,q[7]=q[7]+3545052371+(q[6]>>>0<k[6]>>>0?1:0)|0,this._b=q[7]>>>0<k[7]>>>0?1:0;for(var j=0;j<8;j++){var M=D[j]+q[j],R=M&65535,V=M>>>16,A=((R*R>>>17)+R*V>>>15)+V*V,C=((M&4294901760)*M|0)+((M&65535)*M|0);F[j]=A^C}D[0]=F[0]+(F[7]<<16|F[7]>>>16)+(F[6]<<16|F[6]>>>16)|0,D[1]=F[1]+(F[0]<<8|F[0]>>>24)+F[7]|0,D[2]=F[2]+(F[1]<<16|F[1]>>>16)+(F[0]<<16|F[0]>>>16)|0,D[3]=F[3]+(F[2]<<8|F[2]>>>24)+F[1]|0,D[4]=F[4]+(F[3]<<16|F[3]>>>16)+(F[2]<<16|F[2]>>>16)|0,D[5]=F[5]+(F[4]<<8|F[4]>>>24)+F[3]|0,D[6]=F[6]+(F[5]<<16|F[5]>>>16)+(F[4]<<16|F[4]>>>16)|0,D[7]=F[7]+(F[6]<<8|F[6]>>>24)+F[5]|0}T.Rabbit=Q._createHelper(B)})(),Y.Rabbit})})(un)),un.exports}var fn={exports:{}},z0=fn.exports,Gi;function W0(){return Gi||(Gi=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),Wt(),$t(),kt(),tt())})(z0,function(Y){return(function(){var T=Y,O=T.lib,Q=O.StreamCipher,ie=T.algo,N=[],k=[],F=[],B=ie.RabbitLegacy=Q.extend({_doReset:function(){var D=this._key.words,q=this.cfg.iv,j=this._X=[D[0],D[3]<<16|D[2]>>>16,D[1],D[0]<<16|D[3]>>>16,D[2],D[1]<<16|D[0]>>>16,D[3],D[2]<<16|D[1]>>>16],M=this._C=[D[2]<<16|D[2]>>>16,D[0]&4294901760|D[1]&65535,D[3]<<16|D[3]>>>16,D[1]&4294901760|D[2]&65535,D[0]<<16|D[0]>>>16,D[2]&4294901760|D[3]&65535,D[1]<<16|D[1]>>>16,D[3]&4294901760|D[0]&65535];this._b=0;for(var R=0;R<4;R++)b.call(this);for(var R=0;R<8;R++)M[R]^=j[R+4&7];if(q){var V=q.words,A=V[0],C=V[1],H=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,_=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,z=H>>>16|_&4294901760,J=_<<16|H&65535;M[0]^=H,M[1]^=z,M[2]^=_,M[3]^=J,M[4]^=H,M[5]^=z,M[6]^=_,M[7]^=J;for(var R=0;R<4;R++)b.call(this)}},_doProcessBlock:function(D,q){var j=this._X;b.call(this),N[0]=j[0]^j[5]>>>16^j[3]<<16,N[1]=j[2]^j[7]>>>16^j[5]<<16,N[2]=j[4]^j[1]>>>16^j[7]<<16,N[3]=j[6]^j[3]>>>16^j[1]<<16;for(var M=0;M<4;M++)N[M]=(N[M]<<8|N[M]>>>24)&16711935|(N[M]<<24|N[M]>>>8)&4278255360,D[q+M]^=N[M]},blockSize:128/32,ivSize:64/32});function b(){for(var D=this._X,q=this._C,j=0;j<8;j++)k[j]=q[j];q[0]=q[0]+1295307597+this._b|0,q[1]=q[1]+3545052371+(q[0]>>>0<k[0]>>>0?1:0)|0,q[2]=q[2]+886263092+(q[1]>>>0<k[1]>>>0?1:0)|0,q[3]=q[3]+1295307597+(q[2]>>>0<k[2]>>>0?1:0)|0,q[4]=q[4]+3545052371+(q[3]>>>0<k[3]>>>0?1:0)|0,q[5]=q[5]+886263092+(q[4]>>>0<k[4]>>>0?1:0)|0,q[6]=q[6]+1295307597+(q[5]>>>0<k[5]>>>0?1:0)|0,q[7]=q[7]+3545052371+(q[6]>>>0<k[6]>>>0?1:0)|0,this._b=q[7]>>>0<k[7]>>>0?1:0;for(var j=0;j<8;j++){var M=D[j]+q[j],R=M&65535,V=M>>>16,A=((R*R>>>17)+R*V>>>15)+V*V,C=((M&4294901760)*M|0)+((M&65535)*M|0);F[j]=A^C}D[0]=F[0]+(F[7]<<16|F[7]>>>16)+(F[6]<<16|F[6]>>>16)|0,D[1]=F[1]+(F[0]<<8|F[0]>>>24)+F[7]|0,D[2]=F[2]+(F[1]<<16|F[1]>>>16)+(F[0]<<16|F[0]>>>16)|0,D[3]=F[3]+(F[2]<<8|F[2]>>>24)+F[1]|0,D[4]=F[4]+(F[3]<<16|F[3]>>>16)+(F[2]<<16|F[2]>>>16)|0,D[5]=F[5]+(F[4]<<8|F[4]>>>24)+F[3]|0,D[6]=F[6]+(F[5]<<16|F[5]>>>16)+(F[4]<<16|F[4]>>>16)|0,D[7]=F[7]+(F[6]<<8|F[6]>>>24)+F[5]|0}T.RabbitLegacy=Q._createHelper(B)})(),Y.RabbitLegacy})})(fn)),fn.exports}var $0=Br.exports,Xi;function G0(){return Xi||(Xi=1,(function(te,me){(function(Y,T,O){te.exports=T(Be(),cn(),Wa(),Ga(),Wt(),Za(),$t(),zn(),ss(),r0(),as(),s0(),o0(),f0(),Wn(),l0(),kt(),tt(),p0(),y0(),S0(),w0(),F0(),C0(),B0(),I0(),T0(),N0(),O0(),q0(),V0(),K0(),U0(),W0())})($0,function(Y){return Y})})(Br)),Br.exports}var X0=G0();const uo=Un(X0);var On,Yi;function Y0(){if(Yi)return On;Yi=1;const{BigInteger:te}=hn();function me(k){let F=k.toString(16);if(F[0]!=="-")F.length%2===1?F="0"+F:F.match(/^[0-7]/)||(F="00"+F);else{F=F.substr(1);let B=F.length;B%2===1?B+=1:F.match(/^[0-7]/)||(B+=2);let b="";for(let D=0;D<B;D++)b+="f";b=new te(b,16),F=b.xor(k).add(te.ONE),F=F.toString(16).replace(/^-/,"")}return F}class Y{constructor(){this.tlv=null,this.t="00",this.l="00",this.v=""}getEncodedHex(){return this.tlv||(this.v=this.getValue(),this.l=this.getLength(),this.tlv=this.t+this.l+this.v),this.tlv}getLength(){const F=this.v.length/2;let B=F.toString(16);return B.length%2===1&&(B="0"+B),F<128?B:(128+B.length/2).toString(16)+B}getValue(){return""}}class T extends Y{constructor(F){super(),this.t="02",F&&(this.v=me(F))}getValue(){return this.v}}class O extends Y{constructor(F){super(),this.t="30",this.asn1Array=F}getValue(){return this.v=this.asn1Array.map(F=>F.getEncodedHex()).join(""),this.v}}function Q(k,F){return+k[F+2]<8?1:+k.substr(F+2,2)&128}function ie(k,F){const B=Q(k,F),b=k.substr(F+2,B*2);return b?(+b[0]<8?new te(b,16):new te(b.substr(2),16)).intValue():-1}function N(k,F){const B=Q(k,F);return F+(B+1)*2}return On={encodeDer(k,F){const B=new T(k),b=new T(F);return new O([B,b]).getEncodedHex()},decodeDer(k){const F=N(k,0),B=N(k,F),b=ie(k,F),D=k.substr(B,b*2),q=B+D.length,j=N(k,q),M=ie(k,q),R=k.substr(j,M*2),V=new te(D,16),A=new te(R,16);return{r:V,s:A}}},On}var jn,Zi;function Z0(){if(Zi)return jn;Zi=1;const{BigInteger:te}=hn(),me=new te("2"),Y=new te("3");class T{constructor(N,k){this.x=k,this.q=N}equals(N){return N===this?!0:this.q.equals(N.q)&&this.x.equals(N.x)}toBigInteger(){return this.x}negate(){return new T(this.q,this.x.negate().mod(this.q))}add(N){return new T(this.q,this.x.add(N.toBigInteger()).mod(this.q))}subtract(N){return new T(this.q,this.x.subtract(N.toBigInteger()).mod(this.q))}multiply(N){return new T(this.q,this.x.multiply(N.toBigInteger()).mod(this.q))}divide(N){return new T(this.q,this.x.multiply(N.toBigInteger().modInverse(this.q)).mod(this.q))}square(){return new T(this.q,this.x.square().mod(this.q))}}class O{constructor(N,k,F,B){this.curve=N,this.x=k,this.y=F,this.z=B??te.ONE,this.zinv=null}getX(){return this.zinv===null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}getY(){return this.zinv===null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}equals(N){return N===this?!0:this.isInfinity()?N.isInfinity():N.isInfinity()?this.isInfinity():N.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(N.z)).mod(this.curve.q).equals(te.ZERO)?N.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(N.z)).mod(this.curve.q).equals(te.ZERO):!1}isInfinity(){return this.x===null&&this.y===null?!0:this.z.equals(te.ZERO)&&!this.y.toBigInteger().equals(te.ZERO)}negate(){return new O(this.curve,this.x,this.y.negate(),this.z)}add(N){if(this.isInfinity())return N;if(N.isInfinity())return this;const k=this.x.toBigInteger(),F=this.y.toBigInteger(),B=this.z,b=N.x.toBigInteger(),D=N.y.toBigInteger(),q=N.z,j=this.curve.q,M=k.multiply(q).mod(j),R=b.multiply(B).mod(j),V=M.subtract(R),A=F.multiply(q).mod(j),C=D.multiply(B).mod(j),H=A.subtract(C);if(te.ZERO.equals(V))return te.ZERO.equals(H)?this.twice():this.curve.infinity;const _=M.add(R),z=B.multiply(q).mod(j),J=V.square().mod(j),re=V.multiply(J).mod(j),ae=z.multiply(H.square()).subtract(_.multiply(J)).mod(j),$=V.multiply(ae).mod(j),Z=H.multiply(J.multiply(M).subtract(ae)).subtract(A.multiply(re)).mod(j),ne=re.multiply(z).mod(j);return new O(this.curve,this.curve.fromBigInteger($),this.curve.fromBigInteger(Z),ne)}twice(){if(this.isInfinity())return this;if(!this.y.toBigInteger().signum())return this.curve.infinity;const N=this.x.toBigInteger(),k=this.y.toBigInteger(),F=this.z,B=this.curve.q,b=this.curve.a.toBigInteger(),D=N.square().multiply(Y).add(b.multiply(F.square())).mod(B),q=k.shiftLeft(1).multiply(F).mod(B),j=k.square().mod(B),M=j.multiply(N).multiply(F).mod(B),R=q.square().mod(B),V=D.square().subtract(M.shiftLeft(3)).mod(B),A=q.multiply(V).mod(B),C=D.multiply(M.shiftLeft(2).subtract(V)).subtract(R.shiftLeft(1).multiply(j)).mod(B),H=q.multiply(R).mod(B);return new O(this.curve,this.curve.fromBigInteger(A),this.curve.fromBigInteger(C),H)}multiply(N){if(this.isInfinity())return this;if(!N.signum())return this.curve.infinity;const k=N.multiply(Y),F=this.negate();let B=this;for(let b=k.bitLength()-2;b>0;b--){B=B.twice();const D=k.testBit(b),q=N.testBit(b);D!==q&&(B=B.add(D?this:F))}return B}}class Q{constructor(N,k,F){this.q=N,this.a=this.fromBigInteger(k),this.b=this.fromBigInteger(F),this.infinity=new O(this,null,null)}equals(N){return N===this?!0:this.q.equals(N.q)&&this.a.equals(N.a)&&this.b.equals(N.b)}fromBigInteger(N){return new T(this.q,N)}decodePointHex(N){switch(parseInt(N.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:const k=this.fromBigInteger(new te(N.substr(2),16));let F=this.fromBigInteger(k.multiply(k.square()).add(k.multiply(this.a)).add(this.b).toBigInteger().modPow(this.q.divide(new te("4")).add(te.ONE),this.q));return F.toBigInteger().mod(me).equals(new te(N.substr(0,2),16).subtract(me))||(F=F.negate()),new O(this,k,F);case 4:case 6:case 7:const B=(N.length-2)/2,b=N.substr(2,B),D=N.substr(B+2,B);return new O(this,this.fromBigInteger(new te(b,16)),this.fromBigInteger(new te(D,16)));default:return null}}}return jn={ECPointFp:O,ECCurveFp:Q},jn}var qn,Ji;function J0(){if(Ji)return qn;Ji=1;const{BigInteger:te,SecureRandom:me}=hn(),{ECCurveFp:Y}=Z0(),T=new me,{curve:O,G:Q,n:ie}=k();function N(){return O}function k(){const A=new te("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF",16),C=new te("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC",16),H=new te("28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93",16),_=new Y(A,C,H),re=_.decodePointHex("04"+"32C4AE2C1F1981195F9904466A39C9948FE30BBFF2660BE1715A4589334C74C7"+"BC3736A2F4F6779C59BDCEE36B692153D0A9877CC62A474002DF32E52139F0A0"),ae=new te("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123",16);return{curve:_,G:re,n:ae}}function F(A,C,H){const z=(A?new te(A,C,H):new te(ie.bitLength(),T)).mod(ie.subtract(te.ONE)).add(te.ONE),J=D(z.toString(16),64),re=Q.multiply(z),ae=D(re.getX().toBigInteger().toString(16),64),$=D(re.getY().toBigInteger().toString(16),64),Z="04"+ae+$;return{privateKey:J,publicKey:Z}}function B(A){if(A.length!==130)throw new Error("Invalid public key to compress");const C=(A.length-2)/2,H=A.substr(2,C),_=new te(A.substr(C+2,C),16);let z="03";return _.mod(new te("2")).equals(te.ZERO)&&(z="02"),z+H}function b(A){A=unescape(encodeURIComponent(A));const C=A.length,H=[];for(let z=0;z<C;z++)H[z>>>2]|=(A.charCodeAt(z)&255)<<24-z%4*8;const _=[];for(let z=0;z<C;z++){const J=H[z>>>2]>>>24-z%4*8&255;_.push((J>>>4).toString(16)),_.push((J&15).toString(16))}return _.join("")}function D(A,C){return A.length>=C?A:new Array(C-A.length+1).join("0")+A}function q(A){return A.map(C=>(C=C.toString(16),C.length===1?"0"+C:C)).join("")}function j(A){const C=[];let H=0;for(let _=0;_<A.length*2;_+=2)C[_>>>3]|=parseInt(A[H],10)<<24-_%8*4,H++;try{const _=[];for(let z=0;z<A.length;z++){const J=C[z>>>2]>>>24-z%4*8&255;_.push(String.fromCharCode(J))}return decodeURIComponent(escape(_.join("")))}catch{throw new Error("Malformed UTF-8 data")}}function M(A){const C=[];let H=A.length;H%2!==0&&(A=D(A,H+1)),H=A.length;for(let _=0;_<H;_+=2)C.push(parseInt(A.substr(_,2),16));return C}function R(A){const C=O.decodePointHex(A);if(!C)return!1;const H=C.getX();return C.getY().square().equals(H.multiply(H.square()).add(H.multiply(O.a)).add(O.b))}function V(A,C){const H=O.decodePointHex(A);if(!H)return!1;const _=O.decodePointHex(C);return _?H.equals(_):!1}return qn={getGlobalCurve:N,generateEcparam:k,generateKeyPairHex:F,compressPublicKeyHex:B,utf8ToHex:b,leftPad:D,arrayToHex:q,arrayToUtf8:j,hexToArray:M,verifyPublicKey:R,comparePublicKeyHex:V},qn}var kn,Qi;function os(){if(Qi)return kn;Qi=1;const te=new Uint32Array(68),me=new Uint32Array(64);function Y(b,D){const q=D&31;return b<<q|b>>>32-q}function T(b,D){const q=[];for(let j=b.length-1;j>=0;j--)q[j]=(b[j]^D[j])&255;return q}function O(b){return b^Y(b,9)^Y(b,17)}function Q(b){return b^Y(b,15)^Y(b,23)}function ie(b){let D=b.length*8,q=D%512;q=q>=448?512-q%448-1:448-q-1;const j=new Array((q-7)/8),M=new Array(8);for(let _=0,z=j.length;_<z;_++)j[_]=0;for(let _=0,z=M.length;_<z;_++)M[_]=0;D=D.toString(2);for(let _=7;_>=0;_--)if(D.length>8){const z=D.length-8;M[_]=parseInt(D.substr(z),2),D=D.substr(0,z)}else D.length>0&&(M[_]=parseInt(D,2),D="");const R=new Uint8Array([...b,128,...j,...M]),V=new DataView(R.buffer,0),A=R.length/64,C=new Uint32Array([1937774191,1226093241,388252375,3666478592,2842636476,372324522,3817729613,2969243214]);for(let _=0;_<A;_++){te.fill(0),me.fill(0);const z=16*_;for(let oe=0;oe<16;oe++)te[oe]=V.getUint32((z+oe)*4,!1);for(let oe=16;oe<68;oe++)te[oe]=Q(te[oe-16]^te[oe-9]^Y(te[oe-3],15))^Y(te[oe-13],7)^te[oe-6];for(let oe=0;oe<64;oe++)me[oe]=te[oe]^te[oe+4];const J=2043430169,re=2055708042;let ae=C[0],$=C[1],Z=C[2],ne=C[3],se=C[4],ge=C[5],ye=C[6],Se=C[7],Fe,Ce,Re,Pe,ce;for(let oe=0;oe<64;oe++)ce=oe>=0&&oe<=15?J:re,Fe=Y(Y(ae,12)+se+Y(ce,oe),7),Ce=Fe^Y(ae,12),Re=(oe>=0&&oe<=15?ae^$^Z:ae&$|ae&Z|$&Z)+ne+Ce+me[oe],Pe=(oe>=0&&oe<=15?se^ge^ye:se&ge|~se&ye)+Se+Fe+te[oe],ne=Z,Z=Y($,9),$=ae,ae=Re,Se=ye,ye=Y(ge,19),ge=se,se=O(Pe);C[0]^=ae,C[1]^=$,C[2]^=Z,C[3]^=ne,C[4]^=se,C[5]^=ge,C[6]^=ye,C[7]^=Se}const H=[];for(let _=0,z=C.length;_<z;_++){const J=C[_];H.push((J&4278190080)>>>24,(J&16711680)>>>16,(J&65280)>>>8,J&255)}return H}const N=64,k=new Uint8Array(N),F=new Uint8Array(N);for(let b=0;b<N;b++)k[b]=54,F[b]=92;function B(b,D){for(D.length>N&&(D=ie(D));D.length<N;)D.push(0);const q=T(D,k),j=T(D,F),M=ie([...q,...b]);return ie([...j,...M])}return kn={sm3:ie,hmac:B},kn}var Vn,es;function Q0(){if(es)return Vn;es=1;const{BigInteger:te}=hn(),{encodeDer:me,decodeDer:Y}=Y0(),T=J0(),O=os().sm3,{G:Q,curve:ie,n:N}=T.generateEcparam(),k=0;function F(R,V,A=1){R=typeof R=="string"?T.hexToArray(T.utf8ToHex(R)):Array.prototype.slice.call(R),V=T.getGlobalCurve().decodePointHex(V);const C=T.generateKeyPairHex(),H=new te(C.privateKey,16);let _=C.publicKey;_.length>128&&(_=_.substr(_.length-128));const z=V.multiply(H),J=T.hexToArray(T.leftPad(z.getX().toBigInteger().toRadix(16),64)),re=T.hexToArray(T.leftPad(z.getY().toBigInteger().toRadix(16),64)),ae=T.arrayToHex(O([].concat(J,R,re)));let $=1,Z=0,ne=[];const se=[].concat(J,re),ge=()=>{ne=O([...se,$>>24&255,$>>16&255,$>>8&255,$&255]),$++,Z=0};ge();for(let Se=0,Fe=R.length;Se<Fe;Se++)Z===ne.length&&ge(),R[Se]^=ne[Z++]&255;const ye=T.arrayToHex(R);return A===k?_+ye+ae:_+ae+ye}function B(R,V,A=1,{output:C="string"}={}){V=new te(V,16);let H=R.substr(128,64),_=R.substr(192);A===k&&(H=R.substr(R.length-64),_=R.substr(128,R.length-128-64));const z=T.hexToArray(_),J=T.getGlobalCurve().decodePointHex("04"+R.substr(0,128));if(!J||!T.verifyPublicKey("04"+R.substr(0,128)))return C==="array"?[]:"";const re=J.multiply(V),ae=T.hexToArray(T.leftPad(re.getX().toBigInteger().toRadix(16),64)),$=T.hexToArray(T.leftPad(re.getY().toBigInteger().toRadix(16),64));let Z=1,ne=0,se=[];const ge=[].concat(ae,$),ye=()=>{se=O([...ge,Z>>24&255,Z>>16&255,Z>>8&255,Z&255]),Z++,ne=0};ye();for(let Fe=0,Ce=z.length;Fe<Ce;Fe++)ne===se.length&&ye(),z[Fe]^=se[ne++]&255;return T.arrayToHex(O([].concat(ae,z,$)))===H.toLowerCase()?C==="array"?z:T.arrayToUtf8(z):C==="array"?[]:""}function b(R,V,{pointPool:A,der:C,hash:H,publicKey:_,userId:z}={}){let J=typeof R=="string"?T.utf8ToHex(R):T.arrayToHex(R);H&&(_=_||j(V),J=q(J,_,z));const re=new te(V,16),ae=new te(J,16);let $=null,Z=null,ne=null;do{do{let se;A&&A.length?se=A.pop():se=M(),$=se.k,Z=ae.add(se.x1).mod(N)}while(Z.equals(te.ZERO)||Z.add($).equals(N));ne=re.add(te.ONE).modInverse(N).multiply($.subtract(Z.multiply(re))).mod(N)}while(ne.equals(te.ZERO));return C?me(Z,ne):T.leftPad(Z.toString(16),64)+T.leftPad(ne.toString(16),64)}function D(R,V,A,{der:C,hash:H,userId:_}={}){let z=typeof R=="string"?T.utf8ToHex(R):T.arrayToHex(R);H&&(z=q(z,A,_));let J,re;if(C){const ye=Y(V);J=ye.r,re=ye.s}else J=new te(V.substring(0,64),16),re=new te(V.substring(64),16);const ae=N.subtract(te.ONE);if(J.compareTo(te.ONE)<0||J.compareTo(ae)>0||re.compareTo(te.ONE)<0||re.compareTo(ae)>0)return!1;const $=ie.decodePointHex(A);if(!$||!T.verifyPublicKey(A))return!1;const Z=new te(z,16),ne=J.add(re).mod(N);if(ne.equals(te.ZERO))return!1;const se=Q.multiply(re).add($.multiply(ne)),ge=Z.add(se.getX().toBigInteger()).mod(N);return J.equals(ge)}function q(R,V,A="1234567812345678"){A=T.utf8ToHex(A);const C=T.leftPad(Q.curve.a.toBigInteger().toRadix(16),64),H=T.leftPad(Q.curve.b.toBigInteger().toRadix(16),64),_=T.leftPad(Q.getX().toBigInteger().toRadix(16),64),z=T.leftPad(Q.getY().toBigInteger().toRadix(16),64);let J,re;if(V.length===128)J=V.substr(0,64),re=V.substr(64,64);else{const ne=Q.curve.decodePointHex(V);J=T.leftPad(ne.getX().toBigInteger().toRadix(16),64),re=T.leftPad(ne.getY().toBigInteger().toRadix(16),64)}const ae=T.hexToArray(A+C+H+_+z+J+re),$=A.length*4;ae.unshift($&255),ae.unshift($>>8&255);const Z=O(ae);return T.arrayToHex(O(Z.concat(T.hexToArray(R))))}function j(R){const V=Q.multiply(new te(R,16)),A=T.leftPad(V.getX().toBigInteger().toString(16),64),C=T.leftPad(V.getY().toBigInteger().toString(16),64);return"04"+A+C}function M(){const R=T.generateKeyPairHex(),V=ie.decodePointHex(R.publicKey);return R.k=new te(R.privateKey,16),R.x1=V.getX().toBigInteger(),R}return Vn={generateKeyPairHex:T.generateKeyPairHex,compressPublicKeyHex:T.compressPublicKeyHex,comparePublicKeyHex:T.comparePublicKeyHex,doEncrypt:F,doDecrypt:B,doSignature:b,doVerifySignature:D,getPublicKeyFromPrivateKey:j,getPoint:M,verifyPublicKey:T.verifyPublicKey},Vn}var Ln,ts;function eo(){if(ts)return Ln;ts=1;const{sm3:te,hmac:me}=os();function Y(ie,N){return ie.length>=N?ie:new Array(N-ie.length+1).join("0")+ie}function T(ie){return ie.map(N=>(N=N.toString(16),N.length===1?"0"+N:N)).join("")}function O(ie){const N=[];let k=ie.length;k%2!==0&&(ie=Y(ie,k+1)),k=ie.length;for(let F=0;F<k;F+=2)N.push(parseInt(ie.substr(F,2),16));return N}function Q(ie){const N=[];for(let k=0,F=ie.length;k<F;k++){const B=ie.codePointAt(k);if(B<=127)N.push(B);else if(B<=2047)N.push(192|B>>>6),N.push(128|B&63);else if(B<=55295||B>=57344&&B<=65535)N.push(224|B>>>12),N.push(128|B>>>6&63),N.push(128|B&63);else if(B>=65536&&B<=1114111)k++,N.push(240|B>>>18&28),N.push(128|B>>>12&63),N.push(128|B>>>6&63),N.push(128|B&63);else throw N.push(B),new Error("input is not supported")}return N}return Ln=function(ie,N){if(ie=typeof ie=="string"?Q(ie):Array.prototype.slice.call(ie),N){if((N.mode||"hmac")!=="hmac")throw new Error("invalid mode");let F=N.key;if(!F)throw new Error("invalid key");return F=typeof F=="string"?O(F):Array.prototype.slice.call(F),T(me(ie,F))}return T(te(ie))},Ln}var Kn,rs;function to(){if(rs)return Kn;rs=1;const te=0,me=32,Y=16,T=[214,144,233,254,204,225,61,183,22,182,20,194,40,251,44,5,43,103,154,118,42,190,4,195,170,68,19,38,73,134,6,153,156,66,80,244,145,239,152,122,51,84,11,67,237,207,172,98,228,179,28,169,201,8,232,149,128,223,148,250,117,143,63,166,71,7,167,252,243,115,23,186,131,89,60,25,230,133,79,168,104,107,129,178,113,100,218,139,248,235,15,75,112,86,157,53,30,36,14,94,99,88,209,162,37,34,124,59,1,33,120,135,212,0,70,87,159,211,39,82,76,54,2,231,160,196,200,158,234,191,138,210,64,199,56,181,163,247,242,206,249,97,21,161,224,174,93,164,155,52,26,85,173,147,50,48,245,140,177,227,29,246,226,46,130,102,202,96,192,41,35,171,13,83,78,111,213,219,55,69,222,253,142,47,3,255,106,114,109,108,91,81,141,27,175,146,187,221,188,127,17,217,92,65,31,16,90,216,10,193,49,136,165,205,123,189,45,116,208,18,184,229,180,176,137,105,151,74,12,150,119,126,101,185,241,9,197,110,198,132,24,240,125,236,58,220,77,32,121,238,95,62,215,203,57,72],O=[462357,472066609,943670861,1415275113,1886879365,2358483617,2830087869,3301692121,3773296373,4228057617,404694573,876298825,1347903077,1819507329,2291111581,2762715833,3234320085,3705924337,4177462797,337322537,808926789,1280531041,1752135293,2223739545,2695343797,3166948049,3638552301,4110090761,269950501,741554753,1213159005,1684763257];function Q(R){const V=[];for(let A=0,C=R.length;A<C;A+=2)V.push(parseInt(R.substr(A,2),16));return V}function ie(R){return R.map(V=>(V=V.toString(16),V.length===1?"0"+V:V)).join("")}function N(R){const V=[];for(let A=0,C=R.length;A<C;A++){const H=R.codePointAt(A);if(H<=127)V.push(H);else if(H<=2047)V.push(192|H>>>6),V.push(128|H&63);else if(H<=55295||H>=57344&&H<=65535)V.push(224|H>>>12),V.push(128|H>>>6&63),V.push(128|H&63);else if(H>=65536&&H<=1114111)A++,V.push(240|H>>>18&28),V.push(128|H>>>12&63),V.push(128|H>>>6&63),V.push(128|H&63);else throw V.push(H),new Error("input is not supported")}return V}function k(R){const V=[];for(let A=0,C=R.length;A<C;A++)R[A]>=240&&R[A]<=247?(V.push(String.fromCodePoint(((R[A]&7)<<18)+((R[A+1]&63)<<12)+((R[A+2]&63)<<6)+(R[A+3]&63))),A+=3):R[A]>=224&&R[A]<=239?(V.push(String.fromCodePoint(((R[A]&15)<<12)+((R[A+1]&63)<<6)+(R[A+2]&63))),A+=2):R[A]>=192&&R[A]<=223?(V.push(String.fromCodePoint(((R[A]&31)<<6)+(R[A+1]&63))),A++):V.push(String.fromCodePoint(R[A]));return V.join("")}function F(R,V){const A=V&31;return R<<A|R>>>32-A}function B(R){return(T[R>>>24&255]&255)<<24|(T[R>>>16&255]&255)<<16|(T[R>>>8&255]&255)<<8|T[R&255]&255}function b(R){return R^F(R,2)^F(R,10)^F(R,18)^F(R,24)}function D(R){return R^F(R,13)^F(R,23)}function q(R,V,A){const C=new Array(4),H=new Array(4);for(let _=0;_<4;_++)H[0]=R[4*_]&255,H[1]=R[4*_+1]&255,H[2]=R[4*_+2]&255,H[3]=R[4*_+3]&255,C[_]=H[0]<<24|H[1]<<16|H[2]<<8|H[3];for(let _=0,z;_<32;_+=4)z=C[1]^C[2]^C[3]^A[_+0],C[0]^=b(B(z)),z=C[2]^C[3]^C[0]^A[_+1],C[1]^=b(B(z)),z=C[3]^C[0]^C[1]^A[_+2],C[2]^=b(B(z)),z=C[0]^C[1]^C[2]^A[_+3],C[3]^=b(B(z));for(let _=0;_<16;_+=4)V[_]=C[3-_/4]>>>24&255,V[_+1]=C[3-_/4]>>>16&255,V[_+2]=C[3-_/4]>>>8&255,V[_+3]=C[3-_/4]&255}function j(R,V,A){const C=new Array(4),H=new Array(4);for(let _=0;_<4;_++)H[0]=R[0+4*_]&255,H[1]=R[1+4*_]&255,H[2]=R[2+4*_]&255,H[3]=R[3+4*_]&255,C[_]=H[0]<<24|H[1]<<16|H[2]<<8|H[3];C[0]^=2746333894,C[1]^=1453994832,C[2]^=1736282519,C[3]^=2993693404;for(let _=0,z;_<32;_+=4)z=C[1]^C[2]^C[3]^O[_+0],V[_+0]=C[0]^=D(B(z)),z=C[2]^C[3]^C[0]^O[_+1],V[_+1]=C[1]^=D(B(z)),z=C[3]^C[0]^C[1]^O[_+2],V[_+2]=C[2]^=D(B(z)),z=C[0]^C[1]^C[2]^O[_+3],V[_+3]=C[3]^=D(B(z));if(A===te)for(let _=0,z;_<16;_++)z=V[_],V[_]=V[31-_],V[31-_]=z}function M(R,V,A,{padding:C="pkcs#7",mode:H,iv:_=[],output:z="string"}={}){if(H==="cbc"&&(typeof _=="string"&&(_=Q(_)),_.length!==128/8))throw new Error("iv is invalid");if(typeof V=="string"&&(V=Q(V)),V.length!==128/8)throw new Error("key is invalid");if(typeof R=="string"?A!==te?R=N(R):R=Q(R):R=[...R],(C==="pkcs#5"||C==="pkcs#7")&&A!==te){const ne=Y-R.length%Y;for(let se=0;se<ne;se++)R.push(ne)}const J=new Array(me);j(V,J,A);const re=[];let ae=_,$=R.length,Z=0;for(;$>=Y;){const ne=R.slice(Z,Z+16),se=new Array(16);if(H==="cbc")for(let ge=0;ge<Y;ge++)A!==te&&(ne[ge]^=ae[ge]);q(ne,se,J);for(let ge=0;ge<Y;ge++)H==="cbc"&&A===te&&(se[ge]^=ae[ge]),re[Z+ge]=se[ge];H==="cbc"&&(A!==te?ae=se:ae=ne),$-=Y,Z+=Y}if((C==="pkcs#5"||C==="pkcs#7")&&A===te){const ne=re.length,se=re[ne-1];for(let ge=1;ge<=se;ge++)if(re[ne-ge]!==se)throw new Error("padding is invalid");re.splice(ne-se,se)}return z!=="array"?A!==te?ie(re):k(re):re}return Kn={encrypt(R,V,A){return M(R,V,1,A)},decrypt(R,V,A){return M(R,V,0,A)}},Kn}var Mn,ns;function ro(){return ns||(ns=1,Mn={sm2:Q0(),sm3:eo(),sm4:to()}),Mn}var no=ro();const fo=Un(no);var pe={},is;function io(){if(is)return pe;is=1;var te={};te.userAgent=!1;var me={},Y="11.1.1",T="jsrsasign(all) 11.1.1 (2026-02-21) (c) 2010-2023 Kenji Urushima | kjur.github.io/jsrsasign/license";/*! CryptoJS v3.1.2 core-fix.js
 * code.google.com/p/crypto-js
 * (c) 2009-2013 by Jeff Mott. All rights reserved.
 * code.google.com/p/crypto-js/wiki/License
 * THIS IS FIX of 'core.js' to fix Hmac issue.
 * https://code.google.com/p/crypto-js/issues/detail?id=84
 * https://crypto-js.googlecode.com/svn-history/r667/branches/3.x/src/core.js
 */var O=O||(function(e,t){var r={},n=r.lib={},a=n.Base=(function(){function o(){}return{extend:function(l){o.prototype=this;var h=new o;return l&&h.mixIn(l),h.hasOwnProperty("init")||(h.init=function(){h.$super.init.apply(this,arguments)}),h.init.prototype=h,h.$super=this,h},create:function(){var l=this.extend();return l.init.apply(l,arguments),l},init:function(){},mixIn:function(l){for(var h in l)l.hasOwnProperty(h)&&(this[h]=l[h]);l.hasOwnProperty("toString")&&(this.toString=l.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),i=n.WordArray=a.extend({init:function(o,l){o=this.words=o||[],l!=t?this.sigBytes=l:this.sigBytes=o.length*4},toString:function(o){return(o||f).stringify(this)},concat:function(o){var l=this.words,h=o.words,d=this.sigBytes,p=o.sigBytes;if(this.clamp(),d%4)for(var y=0;y<p;y++){var I=h[y>>>2]>>>24-y%4*8&255;l[d+y>>>2]|=I<<24-(d+y)%4*8}else for(var y=0;y<p;y+=4)l[d+y>>>2]=h[y>>>2];return this.sigBytes+=p,this},clamp:function(){var o=this.words,l=this.sigBytes;o[l>>>2]&=4294967295<<32-l%4*8,o.length=e.ceil(l/4)},clone:function(){var o=a.clone.call(this);return o.words=this.words.slice(0),o},random:function(o){for(var l=[],h=0;h<o;h+=4)l.push(e.random()*4294967296|0);return new i.init(l,o)}}),u=r.enc={},f=u.Hex={stringify:function(o){for(var l=o.words,h=o.sigBytes,d=[],p=0;p<h;p++){var y=l[p>>>2]>>>24-p%4*8&255;d.push((y>>>4).toString(16)),d.push((y&15).toString(16))}return d.join("")},parse:function(o){for(var l=o.length,h=[],d=0;d<l;d+=2)h[d>>>3]|=parseInt(o.substr(d,2),16)<<24-d%8*4;return new i.init(h,l/2)}},v=u.Latin1={stringify:function(o){for(var l=o.words,h=o.sigBytes,d=[],p=0;p<h;p++){var y=l[p>>>2]>>>24-p%4*8&255;d.push(String.fromCharCode(y))}return d.join("")},parse:function(o){for(var l=o.length,h=[],d=0;d<l;d++)h[d>>>2]|=(o.charCodeAt(d)&255)<<24-d%4*8;return new i.init(h,l)}},c=u.Utf8={stringify:function(o){try{return decodeURIComponent(escape(v.stringify(o)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(o){return v.parse(unescape(encodeURIComponent(o)))}},g=n.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new i.init,this._nDataBytes=0},_append:function(o){typeof o=="string"&&(o=c.parse(o)),this._data.concat(o),this._nDataBytes+=o.sigBytes},_process:function(o){var l=this._data,h=l.words,d=l.sigBytes,p=this.blockSize,y=p*4,I=d/y;o?I=e.ceil(I):I=e.max((I|0)-this._minBufferSize,0);var K=I*p,L=e.min(K*4,d);if(K){for(var W=0;W<K;W+=p)this._doProcessBlock(h,W);var m=h.splice(0,K);l.sigBytes-=L}return new i.init(m,L)},clone:function(){var o=a.clone.call(this);return o._data=this._data.clone(),o},_minBufferSize:0});n.Hasher=g.extend({cfg:a.extend(),init:function(o){this.cfg=this.cfg.extend(o),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(o){return this._append(o),this._process(),this},finalize:function(o){o&&this._append(o);var l=this._doFinalize();return l},blockSize:512/32,_createHelper:function(o){return function(l,h){return new o.init(h).finalize(l)}},_createHmacHelper:function(o){return function(l,h){return new x.HMAC.init(o,h).finalize(l)}}});var x=r.algo={};return r})(Math);(function(e){var a=O,t=a.lib,r=t.Base,n=t.WordArray,a=a.x64={};a.Word=r.extend({init:function(i,u){this.high=i,this.low=u}}),a.WordArray=r.extend({init:function(i,u){i=this.words=i||[],this.sigBytes=u!=e?u:8*i.length},toX32:function(){for(var i=this.words,u=i.length,f=[],v=0;v<u;v++){var c=i[v];f.push(c.high),f.push(c.low)}return n.create(f,this.sigBytes)},clone:function(){for(var i=r.clone.call(this),u=i.words=this.words.slice(0),f=u.length,v=0;v<f;v++)u[v]=u[v].clone();return i}})})(),O.lib.Cipher||(function(e){var l=O,t=l.lib,r=t.Base,n=t.WordArray,a=t.BufferedBlockAlgorithm,i=l.enc.Base64,u=l.algo.EvpKDF,f=t.Cipher=a.extend({cfg:r.extend(),createEncryptor:function(d,p){return this.create(this._ENC_XFORM_MODE,d,p)},createDecryptor:function(d,p){return this.create(this._DEC_XFORM_MODE,d,p)},init:function(d,p,y){this.cfg=this.cfg.extend(y),this._xformMode=d,this._key=p,this.reset()},reset:function(){a.reset.call(this),this._doReset()},process:function(d){return this._append(d),this._process()},finalize:function(d){return d&&this._append(d),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(d){return{encrypt:function(p,y,I){return(typeof y=="string"?h:o).encrypt(d,p,y,I)},decrypt:function(p,y,I){return(typeof y=="string"?h:o).decrypt(d,p,y,I)}}}});t.StreamCipher=f.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var x=l.mode={},v=function(d,p,y){var I=this._iv;I?this._iv=e:I=this._prevBlock;for(var K=0;K<y;K++)d[p+K]^=I[K]},c=(t.BlockCipherMode=r.extend({createEncryptor:function(d,p){return this.Encryptor.create(d,p)},createDecryptor:function(d,p){return this.Decryptor.create(d,p)},init:function(d,p){this._cipher=d,this._iv=p}})).extend();c.Encryptor=c.extend({processBlock:function(d,p){var y=this._cipher,I=y.blockSize;v.call(this,d,p,I),y.encryptBlock(d,p),this._prevBlock=d.slice(p,p+I)}}),c.Decryptor=c.extend({processBlock:function(d,p){var y=this._cipher,I=y.blockSize,K=d.slice(p,p+I);y.decryptBlock(d,p),v.call(this,d,p,I),this._prevBlock=K}}),x=x.CBC=c,c=(l.pad={}).Pkcs7={pad:function(d,p){for(var y=4*p,y=y-d.sigBytes%y,I=y<<24|y<<16|y<<8|y,K=[],L=0;L<y;L+=4)K.push(I);y=n.create(K,y),d.concat(y)},unpad:function(d){d.sigBytes-=d.words[d.sigBytes-1>>>2]&255}},t.BlockCipher=f.extend({cfg:f.cfg.extend({mode:x,padding:c}),reset:function(){f.reset.call(this);var p=this.cfg,d=p.iv,p=p.mode;if(this._xformMode==this._ENC_XFORM_MODE)var y=p.createEncryptor;else y=p.createDecryptor,this._minBufferSize=1;this._mode=y.call(p,this,d&&d.words)},_doProcessBlock:function(d,p){this._mode.processBlock(d,p)},_doFinalize:function(){var d=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){d.pad(this._data,this.blockSize);var p=this._process(!0)}else p=this._process(!0),d.unpad(p);return p},blockSize:4});var g=t.CipherParams=r.extend({init:function(d){this.mixIn(d)},toString:function(d){return(d||this.formatter).stringify(this)}}),x=(l.format={}).OpenSSL={stringify:function(d){var p=d.ciphertext;return d=d.salt,(d?n.create([1398893684,1701076831]).concat(d).concat(p):p).toString(i)},parse:function(d){d=i.parse(d);var p=d.words;if(p[0]==1398893684&&p[1]==1701076831){var y=n.create(p.slice(2,4));p.splice(0,4),d.sigBytes-=16}return g.create({ciphertext:d,salt:y})}},o=t.SerializableCipher=r.extend({cfg:r.extend({format:x}),encrypt:function(d,p,y,I){I=this.cfg.extend(I);var K=d.createEncryptor(y,I);return p=K.finalize(p),K=K.cfg,g.create({ciphertext:p,key:y,iv:K.iv,algorithm:d,mode:K.mode,padding:K.padding,blockSize:d.blockSize,formatter:I.format})},decrypt:function(d,p,y,I){return I=this.cfg.extend(I),p=this._parse(p,I.format),d.createDecryptor(y,I).finalize(p.ciphertext)},_parse:function(d,p){return typeof d=="string"?p.parse(d,this):d}}),l=(l.kdf={}).OpenSSL={execute:function(d,p,y,I){return I||(I=n.random(8)),d=u.create({keySize:p+y}).compute(d,I),y=n.create(d.words.slice(p),4*y),d.sigBytes=4*p,g.create({key:d,iv:y,salt:I})}},h=t.PasswordBasedCipher=o.extend({cfg:o.cfg.extend({kdf:l}),encrypt:function(d,p,y,I){return I=this.cfg.extend(I),y=I.kdf.execute(y,d.keySize,d.ivSize),I.iv=y.iv,d=o.encrypt.call(this,d,p,y.key,I),d.mixIn(y),d},decrypt:function(d,p,y,I){return I=this.cfg.extend(I),p=this._parse(p,I.format),y=I.kdf.execute(y,d.keySize,d.ivSize,p.salt),I.iv=y.iv,o.decrypt.call(this,d,p,y.key,I)}})})(),(function(){for(var e=O,t=e.lib.BlockCipher,m=e.algo,r=[],n=[],a=[],i=[],u=[],f=[],v=[],c=[],g=[],x=[],o=[],l=0;256>l;l++)o[l]=128>l?l<<1:l<<1^283;for(var h=0,d=0,l=0;256>l;l++){var p=d^d<<1^d<<2^d<<3^d<<4,p=p>>>8^p&255^99;r[h]=p,n[p]=h;var y=o[h],I=o[y],K=o[I],L=257*o[p]^16843008*p;a[h]=L<<24|L>>>8,i[h]=L<<16|L>>>16,u[h]=L<<8|L>>>24,f[h]=L,L=16843009*K^65537*I^257*y^16843008*h,v[p]=L<<24|L>>>8,c[p]=L<<16|L>>>16,g[p]=L<<8|L>>>24,x[p]=L,h?(h=y^o[o[o[K^y]]],d^=o[o[d]]):h=d=1}var W=[0,1,2,4,8,16,32,64,128,27,54],m=m.AES=t.extend({_doReset:function(){for(var S=this._key,w=S.words,E=S.sigBytes/4,S=4*((this._nRounds=E+6)+1),P=this._keySchedule=[],U=0;U<S;U++)if(U<E)P[U]=w[U];else{var X=P[U-1];U%E?6<E&&U%E==4&&(X=r[X>>>24]<<24|r[X>>>16&255]<<16|r[X>>>8&255]<<8|r[X&255]):(X=X<<8|X>>>24,X=r[X>>>24]<<24|r[X>>>16&255]<<16|r[X>>>8&255]<<8|r[X&255],X^=W[U/E|0]<<24),P[U]=P[U-E]^X}for(w=this._invKeySchedule=[],E=0;E<S;E++)U=S-E,X=E%4?P[U]:P[U-4],w[E]=4>E||4>=U?X:v[r[X>>>24]]^c[r[X>>>16&255]]^g[r[X>>>8&255]]^x[r[X&255]]},encryptBlock:function(w,E){this._doCryptBlock(w,E,this._keySchedule,a,i,u,f,r)},decryptBlock:function(w,E){var S=w[E+1];w[E+1]=w[E+3],w[E+3]=S,this._doCryptBlock(w,E,this._invKeySchedule,v,c,g,x,n),S=w[E+1],w[E+1]=w[E+3],w[E+3]=S},_doCryptBlock:function(w,E,S,P,U,X,fe,G){for(var ee=this._nRounds,Je=w[E]^S[0],et=w[E+1]^S[1],Qe=w[E+2]^S[2],Ge=w[E+3]^S[3],he=4,le=1;le<ee;le++)var nt=P[Je>>>24]^U[et>>>16&255]^X[Qe>>>8&255]^fe[Ge&255]^S[he++],Le=P[et>>>24]^U[Qe>>>16&255]^X[Ge>>>8&255]^fe[Je&255]^S[he++],je=P[Qe>>>24]^U[Ge>>>16&255]^X[Je>>>8&255]^fe[et&255]^S[he++],Ge=P[Ge>>>24]^U[Je>>>16&255]^X[et>>>8&255]^fe[Qe&255]^S[he++],Je=nt,et=Le,Qe=je;nt=(G[Je>>>24]<<24|G[et>>>16&255]<<16|G[Qe>>>8&255]<<8|G[Ge&255])^S[he++],Le=(G[et>>>24]<<24|G[Qe>>>16&255]<<16|G[Ge>>>8&255]<<8|G[Je&255])^S[he++],je=(G[Qe>>>24]<<24|G[Ge>>>16&255]<<16|G[Je>>>8&255]<<8|G[et&255])^S[he++],Ge=(G[Ge>>>24]<<24|G[Je>>>16&255]<<16|G[et>>>8&255]<<8|G[Qe&255])^S[he++],w[E]=nt,w[E+1]=Le,w[E+2]=je,w[E+3]=Ge},keySize:8});e.AES=t._createHelper(m)})(),(function(){function e(o,l){var h=(this._lBlock>>>o^this._rBlock)&l;this._rBlock^=h,this._lBlock^=h<<o}function t(o,l){var h=(this._rBlock>>>o^this._lBlock)&l;this._lBlock^=h,this._rBlock^=h<<o}var r=O,a=r.lib,n=a.WordArray,a=a.BlockCipher,i=r.algo,u=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],f=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],v=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],g=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],x=i.DES=a.extend({_doReset:function(){for(var o=this._key.words,l=[],h=0;56>h;h++){var d=u[h]-1;l[h]=o[d>>>5]>>>31-d%32&1}for(o=this._subKeys=[],d=0;16>d;d++){for(var p=o[d]=[],y=v[d],h=0;24>h;h++)p[h/6|0]|=l[(f[h]-1+y)%28]<<31-h%6,p[4+(h/6|0)]|=l[28+(f[h+24]-1+y)%28]<<31-h%6;for(p[0]=p[0]<<1|p[0]>>>31,h=1;7>h;h++)p[h]>>>=4*(h-1)+3;p[7]=p[7]<<5|p[7]>>>27}for(l=this._invSubKeys=[],h=0;16>h;h++)l[h]=o[15-h]},encryptBlock:function(o,l){this._doCryptBlock(o,l,this._subKeys)},decryptBlock:function(o,l){this._doCryptBlock(o,l,this._invSubKeys)},_doCryptBlock:function(o,l,h){this._lBlock=o[l],this._rBlock=o[l+1],e.call(this,4,252645135),e.call(this,16,65535),t.call(this,2,858993459),t.call(this,8,16711935),e.call(this,1,1431655765);for(var d=0;16>d;d++){for(var p=h[d],y=this._lBlock,I=this._rBlock,K=0,L=0;8>L;L++)K|=c[L][((I^p[L])&g[L])>>>0];this._lBlock=I,this._rBlock=y^K}h=this._lBlock,this._lBlock=this._rBlock,this._rBlock=h,e.call(this,1,1431655765),t.call(this,8,16711935),t.call(this,2,858993459),e.call(this,16,65535),e.call(this,4,252645135),o[l]=this._lBlock,o[l+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});r.DES=a._createHelper(x),i=i.TripleDES=a.extend({_doReset:function(){var o=this._key.words;this._des1=x.createEncryptor(n.create(o.slice(0,2))),this._des2=x.createEncryptor(n.create(o.slice(2,4))),this._des3=x.createEncryptor(n.create(o.slice(4,6)))},encryptBlock:function(o,l){this._des1.encryptBlock(o,l),this._des2.decryptBlock(o,l),this._des3.encryptBlock(o,l)},decryptBlock:function(o,l){this._des3.decryptBlock(o,l),this._des2.encryptBlock(o,l),this._des1.decryptBlock(o,l)},keySize:6,ivSize:2,blockSize:2}),r.TripleDES=a._createHelper(i)})(),(function(){var e=O,t=e.lib.WordArray;e.enc.Base64={stringify:function(r){var n=r.words,a=r.sigBytes,i=this._map;r.clamp(),r=[];for(var u=0;u<a;u+=3)for(var f=(n[u>>>2]>>>24-8*(u%4)&255)<<16|(n[u+1>>>2]>>>24-8*((u+1)%4)&255)<<8|n[u+2>>>2]>>>24-8*((u+2)%4)&255,v=0;4>v&&u+.75*v<a;v++)r.push(i.charAt(f>>>6*(3-v)&63));if(n=i.charAt(64))for(;r.length%4;)r.push(n);return r.join("")},parse:function(r){var n=r.length,a=this._map,i=a.charAt(64);i&&(i=r.indexOf(i),i!=-1&&(n=i));for(var i=[],u=0,f=0;f<n;f++)if(f%4){var v=a.indexOf(r.charAt(f-1))<<2*(f%4),c=a.indexOf(r.charAt(f))>>>6-2*(f%4);i[u>>>2]|=(v|c)<<24-8*(u%4),u++}return t.create(i,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})(),(function(e){function t(x,o,l,h,d,p,y){return x=x+(o&l|~o&h)+d+y,(x<<p|x>>>32-p)+o}function r(x,o,l,h,d,p,y){return x=x+(o&h|l&~h)+d+y,(x<<p|x>>>32-p)+o}function n(x,o,l,h,d,p,y){return x=x+(o^l^h)+d+y,(x<<p|x>>>32-p)+o}function a(x,o,l,h,d,p,y){return x=x+(l^(o|~h))+d+y,(x<<p|x>>>32-p)+o}for(var i=O,v=i.lib,u=v.WordArray,f=v.Hasher,v=i.algo,c=[],g=0;64>g;g++)c[g]=4294967296*e.abs(e.sin(g+1))|0;v=v.MD5=f.extend({_doReset:function(){this._hash=new u.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(x,o){for(var l=0;16>l;l++){var h=o+l,d=x[h];x[h]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360}var l=this._hash.words,h=x[o+0],d=x[o+1],p=x[o+2],y=x[o+3],I=x[o+4],K=x[o+5],L=x[o+6],W=x[o+7],m=x[o+8],w=x[o+9],E=x[o+10],S=x[o+11],P=x[o+12],U=x[o+13],X=x[o+14],fe=x[o+15],G=l[0],le=l[1],he=l[2],ee=l[3],G=t(G,le,he,ee,h,7,c[0]),ee=t(ee,G,le,he,d,12,c[1]),he=t(he,ee,G,le,p,17,c[2]),le=t(le,he,ee,G,y,22,c[3]),G=t(G,le,he,ee,I,7,c[4]),ee=t(ee,G,le,he,K,12,c[5]),he=t(he,ee,G,le,L,17,c[6]),le=t(le,he,ee,G,W,22,c[7]),G=t(G,le,he,ee,m,7,c[8]),ee=t(ee,G,le,he,w,12,c[9]),he=t(he,ee,G,le,E,17,c[10]),le=t(le,he,ee,G,S,22,c[11]),G=t(G,le,he,ee,P,7,c[12]),ee=t(ee,G,le,he,U,12,c[13]),he=t(he,ee,G,le,X,17,c[14]),le=t(le,he,ee,G,fe,22,c[15]),G=r(G,le,he,ee,d,5,c[16]),ee=r(ee,G,le,he,L,9,c[17]),he=r(he,ee,G,le,S,14,c[18]),le=r(le,he,ee,G,h,20,c[19]),G=r(G,le,he,ee,K,5,c[20]),ee=r(ee,G,le,he,E,9,c[21]),he=r(he,ee,G,le,fe,14,c[22]),le=r(le,he,ee,G,I,20,c[23]),G=r(G,le,he,ee,w,5,c[24]),ee=r(ee,G,le,he,X,9,c[25]),he=r(he,ee,G,le,y,14,c[26]),le=r(le,he,ee,G,m,20,c[27]),G=r(G,le,he,ee,U,5,c[28]),ee=r(ee,G,le,he,p,9,c[29]),he=r(he,ee,G,le,W,14,c[30]),le=r(le,he,ee,G,P,20,c[31]),G=n(G,le,he,ee,K,4,c[32]),ee=n(ee,G,le,he,m,11,c[33]),he=n(he,ee,G,le,S,16,c[34]),le=n(le,he,ee,G,X,23,c[35]),G=n(G,le,he,ee,d,4,c[36]),ee=n(ee,G,le,he,I,11,c[37]),he=n(he,ee,G,le,W,16,c[38]),le=n(le,he,ee,G,E,23,c[39]),G=n(G,le,he,ee,U,4,c[40]),ee=n(ee,G,le,he,h,11,c[41]),he=n(he,ee,G,le,y,16,c[42]),le=n(le,he,ee,G,L,23,c[43]),G=n(G,le,he,ee,w,4,c[44]),ee=n(ee,G,le,he,P,11,c[45]),he=n(he,ee,G,le,fe,16,c[46]),le=n(le,he,ee,G,p,23,c[47]),G=a(G,le,he,ee,h,6,c[48]),ee=a(ee,G,le,he,W,10,c[49]),he=a(he,ee,G,le,X,15,c[50]),le=a(le,he,ee,G,K,21,c[51]),G=a(G,le,he,ee,P,6,c[52]),ee=a(ee,G,le,he,y,10,c[53]),he=a(he,ee,G,le,E,15,c[54]),le=a(le,he,ee,G,d,21,c[55]),G=a(G,le,he,ee,m,6,c[56]),ee=a(ee,G,le,he,fe,10,c[57]),he=a(he,ee,G,le,L,15,c[58]),le=a(le,he,ee,G,U,21,c[59]),G=a(G,le,he,ee,I,6,c[60]),ee=a(ee,G,le,he,S,10,c[61]),he=a(he,ee,G,le,p,15,c[62]),le=a(le,he,ee,G,w,21,c[63]);l[0]=l[0]+G|0,l[1]=l[1]+le|0,l[2]=l[2]+he|0,l[3]=l[3]+ee|0},_doFinalize:function(){var x=this._data,o=x.words,l=8*this._nDataBytes,h=8*x.sigBytes;o[h>>>5]|=128<<24-h%32;var d=e.floor(l/4294967296);for(o[(h+64>>>9<<4)+15]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,o[(h+64>>>9<<4)+14]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360,x.sigBytes=4*(o.length+1),this._process(),x=this._hash,o=x.words,l=0;4>l;l++)h=o[l],o[l]=(h<<8|h>>>24)&16711935|(h<<24|h>>>8)&4278255360;return x},clone:function(){var x=f.clone.call(this);return x._hash=this._hash.clone(),x}}),i.MD5=f._createHelper(v),i.HmacMD5=f._createHmacHelper(v)})(Math),(function(){var e=O,a=e.lib,t=a.WordArray,r=a.Hasher,n=[],a=e.algo.SHA1=r.extend({_doReset:function(){this._hash=new t.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(i,u){for(var f=this._hash.words,v=f[0],c=f[1],g=f[2],x=f[3],o=f[4],l=0;80>l;l++){if(16>l)n[l]=i[u+l]|0;else{var h=n[l-3]^n[l-8]^n[l-14]^n[l-16];n[l]=h<<1|h>>>31}h=(v<<5|v>>>27)+o+n[l],h=20>l?h+((c&g|~c&x)+1518500249):40>l?h+((c^g^x)+1859775393):60>l?h+((c&g|c&x|g&x)-1894007588):h+((c^g^x)-899497514),o=x,x=g,g=c<<30|c>>>2,c=v,v=h}f[0]=f[0]+v|0,f[1]=f[1]+c|0,f[2]=f[2]+g|0,f[3]=f[3]+x|0,f[4]=f[4]+o|0},_doFinalize:function(){var i=this._data,u=i.words,f=8*this._nDataBytes,v=8*i.sigBytes;return u[v>>>5]|=128<<24-v%32,u[(v+64>>>9<<4)+14]=Math.floor(f/4294967296),u[(v+64>>>9<<4)+15]=f,i.sigBytes=4*u.length,this._process(),this._hash},clone:function(){var i=r.clone.call(this);return i._hash=this._hash.clone(),i}});e.SHA1=r._createHelper(a),e.HmacSHA1=r._createHmacHelper(a)})(),(function(e){for(var t=O,l=t.lib,r=l.WordArray,n=l.Hasher,l=t.algo,a=[],i=[],u=function(d){return 4294967296*(d-(d|0))|0},f=2,v=0;64>v;){var c;e:{c=f;for(var g=e.sqrt(c),x=2;x<=g;x++)if(!(c%x)){c=!1;break e}c=!0}c&&(8>v&&(a[v]=u(e.pow(f,.5))),i[v]=u(e.pow(f,1/3)),v++),f++}var o=[],l=l.SHA256=n.extend({_doReset:function(){this._hash=new r.init(a.slice(0))},_doProcessBlock:function(h,d){for(var p=this._hash.words,y=p[0],I=p[1],K=p[2],L=p[3],W=p[4],m=p[5],w=p[6],E=p[7],S=0;64>S;S++){if(16>S)o[S]=h[d+S]|0;else{var P=o[S-15],U=o[S-2];o[S]=((P<<25|P>>>7)^(P<<14|P>>>18)^P>>>3)+o[S-7]+((U<<15|U>>>17)^(U<<13|U>>>19)^U>>>10)+o[S-16]}P=E+((W<<26|W>>>6)^(W<<21|W>>>11)^(W<<7|W>>>25))+(W&m^~W&w)+i[S]+o[S],U=((y<<30|y>>>2)^(y<<19|y>>>13)^(y<<10|y>>>22))+(y&I^y&K^I&K),E=w,w=m,m=W,W=L+P|0,L=K,K=I,I=y,y=P+U|0}p[0]=p[0]+y|0,p[1]=p[1]+I|0,p[2]=p[2]+K|0,p[3]=p[3]+L|0,p[4]=p[4]+W|0,p[5]=p[5]+m|0,p[6]=p[6]+w|0,p[7]=p[7]+E|0},_doFinalize:function(){var h=this._data,d=h.words,p=8*this._nDataBytes,y=8*h.sigBytes;return d[y>>>5]|=128<<24-y%32,d[(y+64>>>9<<4)+14]=e.floor(p/4294967296),d[(y+64>>>9<<4)+15]=p,h.sigBytes=4*d.length,this._process(),this._hash},clone:function(){var h=n.clone.call(this);return h._hash=this._hash.clone(),h}});t.SHA256=n._createHelper(l),t.HmacSHA256=n._createHmacHelper(l)})(Math),(function(){var e=O,t=e.lib.WordArray,n=e.algo,r=n.SHA256,n=n.SHA224=r.extend({_doReset:function(){this._hash=new t.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var a=r._doFinalize.call(this);return a.sigBytes-=4,a}});e.SHA224=r._createHelper(n),e.HmacSHA224=r._createHmacHelper(n)})(),(function(){function e(){return n.create.apply(n,arguments)}for(var t=O,r=t.lib.Hasher,i=t.x64,n=i.Word,a=i.WordArray,i=t.algo,u=[e(1116352408,3609767458),e(1899447441,602891725),e(3049323471,3964484399),e(3921009573,2173295548),e(961987163,4081628472),e(1508970993,3053834265),e(2453635748,2937671579),e(2870763221,3664609560),e(3624381080,2734883394),e(310598401,1164996542),e(607225278,1323610764),e(1426881987,3590304994),e(1925078388,4068182383),e(2162078206,991336113),e(2614888103,633803317),e(3248222580,3479774868),e(3835390401,2666613458),e(4022224774,944711139),e(264347078,2341262773),e(604807628,2007800933),e(770255983,1495990901),e(1249150122,1856431235),e(1555081692,3175218132),e(1996064986,2198950837),e(2554220882,3999719339),e(2821834349,766784016),e(2952996808,2566594879),e(3210313671,3203337956),e(3336571891,1034457026),e(3584528711,2466948901),e(113926993,3758326383),e(338241895,168717936),e(666307205,1188179964),e(773529912,1546045734),e(1294757372,1522805485),e(1396182291,2643833823),e(1695183700,2343527390),e(1986661051,1014477480),e(2177026350,1206759142),e(2456956037,344077627),e(2730485921,1290863460),e(2820302411,3158454273),e(3259730800,3505952657),e(3345764771,106217008),e(3516065817,3606008344),e(3600352804,1432725776),e(4094571909,1467031594),e(275423344,851169720),e(430227734,3100823752),e(506948616,1363258195),e(659060556,3750685593),e(883997877,3785050280),e(958139571,3318307427),e(1322822218,3812723403),e(1537002063,2003034995),e(1747873779,3602036899),e(1955562222,1575990012),e(2024104815,1125592928),e(2227730452,2716904306),e(2361852424,442776044),e(2428436474,593698344),e(2756734187,3733110249),e(3204031479,2999351573),e(3329325298,3815920427),e(3391569614,3928383900),e(3515267271,566280711),e(3940187606,3454069534),e(4118630271,4000239992),e(116418474,1914138554),e(174292421,2731055270),e(289380356,3203993006),e(460393269,320620315),e(685471733,587496836),e(852142971,1086792851),e(1017036298,365543100),e(1126000580,2618297676),e(1288033470,3409855158),e(1501505948,4234509866),e(1607167915,987167468),e(1816402316,1246189591)],f=[],v=0;80>v;v++)f[v]=e();i=i.SHA512=r.extend({_doReset:function(){this._hash=new a.init([new n.init(1779033703,4089235720),new n.init(3144134277,2227873595),new n.init(1013904242,4271175723),new n.init(2773480762,1595750129),new n.init(1359893119,2917565137),new n.init(2600822924,725511199),new n.init(528734635,4215389547),new n.init(1541459225,327033209)])},_doProcessBlock:function(c,g){for(var I=this._hash.words,x=I[0],o=I[1],l=I[2],h=I[3],d=I[4],p=I[5],y=I[6],I=I[7],K=x.high,L=x.low,W=o.high,m=o.low,w=l.high,E=l.low,S=h.high,P=h.low,U=d.high,X=d.low,fe=p.high,G=p.low,ee=y.high,he=y.low,le=I.high,nt=I.low,Le=K,je=L,Ge=W,Je=m,et=w,Qe=E,tr=S,at=P,De=U,Ne=X,Ke=fe,Me=G,ct=ee,We=he,rr=le,jt=nt,yt=0;80>yt;yt++){var Pt=f[yt];if(16>yt)var xt=Pt.high=c[g+2*yt]|0,Te=Pt.low=c[g+2*yt+1]|0;else{var xt=f[yt-15],Te=xt.high,wt=xt.low,xt=(Te>>>1|wt<<31)^(Te>>>8|wt<<24)^Te>>>7,wt=(wt>>>1|Te<<31)^(wt>>>8|Te<<24)^(wt>>>7|Te<<25),qt=f[yt-2],Te=qt.high,Ve=qt.low,qt=(Te>>>19|Ve<<13)^(Te<<3|Ve>>>29)^Te>>>6,Ve=(Ve>>>19|Te<<13)^(Ve<<3|Te>>>29)^(Ve>>>6|Te<<26),Te=f[yt-7],Hn=Te.high,Bt=f[yt-16],Et=Bt.high,Bt=Bt.low,Te=wt+Te.low,xt=xt+Hn+(Te>>>0<wt>>>0?1:0),Te=Te+Ve,xt=xt+qt+(Te>>>0<Ve>>>0?1:0),Te=Te+Bt,xt=xt+Et+(Te>>>0<Bt>>>0?1:0);Pt.high=xt,Pt.low=Te}var Hn=De&Ke^~De&ct,Bt=Ne&Me^~Ne&We,Pt=Le&Ge^Le&et^Ge&et,ka=je&Je^je&Qe^Je&Qe,wt=(Le>>>28|je<<4)^(Le<<30|je>>>2)^(Le<<25|je>>>7),qt=(je>>>28|Le<<4)^(je<<30|Le>>>2)^(je<<25|Le>>>7),Ve=u[yt],Va=Ve.high,vi=Ve.low,Ve=jt+((Ne>>>14|De<<18)^(Ne>>>18|De<<14)^(Ne<<23|De>>>9)),Et=rr+((De>>>14|Ne<<18)^(De>>>18|Ne<<14)^(De<<23|Ne>>>9))+(Ve>>>0<jt>>>0?1:0),Ve=Ve+Bt,Et=Et+Hn+(Ve>>>0<Bt>>>0?1:0),Ve=Ve+vi,Et=Et+Va+(Ve>>>0<vi>>>0?1:0),Ve=Ve+Te,Et=Et+xt+(Ve>>>0<Te>>>0?1:0),Te=qt+ka,Pt=wt+Pt+(Te>>>0<qt>>>0?1:0),rr=ct,jt=We,ct=Ke,We=Me,Ke=De,Me=Ne,Ne=at+Ve|0,De=tr+Et+(Ne>>>0<at>>>0?1:0)|0,tr=et,at=Qe,et=Ge,Qe=Je,Ge=Le,Je=je,je=Ve+Te|0,Le=Et+Pt+(je>>>0<Ve>>>0?1:0)|0}L=x.low=L+je,x.high=K+Le+(L>>>0<je>>>0?1:0),m=o.low=m+Je,o.high=W+Ge+(m>>>0<Je>>>0?1:0),E=l.low=E+Qe,l.high=w+et+(E>>>0<Qe>>>0?1:0),P=h.low=P+at,h.high=S+tr+(P>>>0<at>>>0?1:0),X=d.low=X+Ne,d.high=U+De+(X>>>0<Ne>>>0?1:0),G=p.low=G+Me,p.high=fe+Ke+(G>>>0<Me>>>0?1:0),he=y.low=he+We,y.high=ee+ct+(he>>>0<We>>>0?1:0),nt=I.low=nt+jt,I.high=le+rr+(nt>>>0<jt>>>0?1:0)},_doFinalize:function(){var c=this._data,g=c.words,x=8*this._nDataBytes,o=8*c.sigBytes;return g[o>>>5]|=128<<24-o%32,g[(o+128>>>10<<5)+30]=Math.floor(x/4294967296),g[(o+128>>>10<<5)+31]=x,c.sigBytes=4*g.length,this._process(),this._hash.toX32()},clone:function(){var c=r.clone.call(this);return c._hash=this._hash.clone(),c},blockSize:32}),t.SHA512=r._createHelper(i),t.HmacSHA512=r._createHmacHelper(i)})(),(function(){var e=O,a=e.x64,t=a.Word,r=a.WordArray,a=e.algo,n=a.SHA512,a=a.SHA384=n.extend({_doReset:function(){this._hash=new r.init([new t.init(3418070365,3238371032),new t.init(1654270250,914150663),new t.init(2438529370,812702999),new t.init(355462360,4144912697),new t.init(1731405415,4290775857),new t.init(2394180231,1750603025),new t.init(3675008525,1694076839),new t.init(1203062813,3204075428)])},_doFinalize:function(){var i=n._doFinalize.call(this);return i.sigBytes-=16,i}});e.SHA384=n._createHelper(a),e.HmacSHA384=n._createHmacHelper(a)})(),(function(){var e=O,c=e.lib,t=c.WordArray,r=c.Hasher,c=e.algo,n=t.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),a=t.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),i=t.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),u=t.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),f=t.create([0,1518500249,1859775393,2400959708,2840853838]),v=t.create([1352829926,1548603684,1836072691,2053994217,0]),c=c.RIPEMD160=r.extend({_doReset:function(){this._hash=t.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(g,x){for(var o=0;16>o;o++){var l=x+o,h=g[l];g[l]=(h<<8|h>>>24)&16711935|(h<<24|h>>>8)&4278255360}var l=this._hash.words,h=f.words,d=v.words,p=n.words,y=a.words,I=i.words,K=u.words,L,W,m,w,E,S,P,U,X,fe;S=L=l[0],P=W=l[1],U=m=l[2],X=w=l[3],fe=E=l[4];for(var G,o=0;80>o;o+=1)G=L+g[x+p[o]]|0,G=16>o?G+((W^m^w)+h[0]):32>o?G+((W&m|~W&w)+h[1]):48>o?G+(((W|~m)^w)+h[2]):64>o?G+((W&w|m&~w)+h[3]):G+((W^(m|~w))+h[4]),G|=0,G=G<<I[o]|G>>>32-I[o],G=G+E|0,L=E,E=w,w=m<<10|m>>>22,m=W,W=G,G=S+g[x+y[o]]|0,G=16>o?G+((P^(U|~X))+d[0]):32>o?G+((P&X|U&~X)+d[1]):48>o?G+(((P|~U)^X)+d[2]):64>o?G+((P&U|~P&X)+d[3]):G+((P^U^X)+d[4]),G|=0,G=G<<K[o]|G>>>32-K[o],G=G+fe|0,S=fe,fe=X,X=U<<10|U>>>22,U=P,P=G;G=l[1]+m+X|0,l[1]=l[2]+w+fe|0,l[2]=l[3]+E+S|0,l[3]=l[4]+L+P|0,l[4]=l[0]+W+U|0,l[0]=G},_doFinalize:function(){var g=this._data,x=g.words,o=8*this._nDataBytes,l=8*g.sigBytes;for(x[l>>>5]|=128<<24-l%32,x[(l+64>>>9<<4)+14]=(o<<8|o>>>24)&16711935|(o<<24|o>>>8)&4278255360,g.sigBytes=4*(x.length+1),this._process(),g=this._hash,x=g.words,o=0;5>o;o++)l=x[o],x[o]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360;return g},clone:function(){var g=r.clone.call(this);return g._hash=this._hash.clone(),g}});e.RIPEMD160=r._createHelper(c),e.HmacRIPEMD160=r._createHmacHelper(c)})(),(function(){var e=O,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(r,n){r=this._hasher=new r.init,typeof n=="string"&&(n=t.parse(n));var a=r.blockSize,i=4*a;n.sigBytes>i&&(n=r.finalize(n)),n.clamp();for(var u=this._oKey=n.clone(),f=this._iKey=n.clone(),v=u.words,c=f.words,g=0;g<a;g++)v[g]^=1549556828,c[g]^=909522486;u.sigBytes=f.sigBytes=i,this.reset()},reset:function(){var r=this._hasher;r.reset(),r.update(this._iKey)},update:function(r){return this._hasher.update(r),this},finalize:function(r){var n=this._hasher;return r=n.finalize(r),n.reset(),n.finalize(this._oKey.clone().concat(r))}})})(),(function(){var e=O,n=e.lib,t=n.Base,r=n.WordArray,n=e.algo,a=n.HMAC,i=n.PBKDF2=t.extend({cfg:t.extend({keySize:4,hasher:n.SHA1,iterations:1}),init:function(u){this.cfg=this.cfg.extend(u)},compute:function(u,f){for(var h=this.cfg,v=a.create(h.hasher,u),c=r.create(),g=r.create([1]),x=c.words,o=g.words,l=h.keySize,h=h.iterations;x.length<l;){var d=v.update(f).finalize(g);v.reset();for(var p=d.words,y=p.length,I=d,K=1;K<h;K++){I=v.finalize(I),v.reset();for(var L=I.words,W=0;W<y;W++)p[W]^=L[W]}c.concat(d),o[0]++}return c.sigBytes=4*l,c}});e.PBKDF2=function(u,f,v){return i.create(v).compute(u,f)}})();/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */var Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ie="=";function N(e){var t,r,n="";for(t=0;t+3<=e.length;t+=3)r=parseInt(e.substring(t,t+3),16),n+=Q.charAt(r>>6)+Q.charAt(r&63);for(t+1==e.length?(r=parseInt(e.substring(t,t+1),16),n+=Q.charAt(r<<2)):t+2==e.length&&(r=parseInt(e.substring(t,t+2),16),n+=Q.charAt(r>>2)+Q.charAt((r&3)<<4));(n.length&3)>0;)n+=ie;return n}function k(e){var t="",r,n=0,a,i;for(r=0;r<e.length&&e.charAt(r)!=ie;++r)i=Q.indexOf(e.charAt(r)),!(i<0)&&(n==0?(t+=_(i>>2),a=i&3,n=1):n==1?(t+=_(a<<2|i>>4),a=i&15,n=2):n==2?(t+=_(a),t+=_(i>>2),a=i&3,n=3):(t+=_(a<<2|i>>4),t+=_(i&15),n=0));return n==1&&(t+=_(a<<2)),t}function F(e){var t=k(e),r,n=new Array;for(r=0;2*r<t.length;++r)n[r]=parseInt(t.substring(2*r,2*r+2),16);return n}/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
*/var B;function b(e,t,r){e!=null&&(typeof e=="number"?this.fromNumber(e,t,r):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}function D(){return new b(null)}function q(e,t,r,n,a,i){for(;--i>=0;){var u=t*this[e++]+r[n]+a;a=Math.floor(u/67108864),r[n++]=u&67108863}return a}function j(e,t,r,n,a,i){for(var u=t&32767,f=t>>15;--i>=0;){var v=this[e]&32767,c=this[e++]>>15,g=f*v+c*u;v=u*v+((g&32767)<<15)+r[n]+(a&1073741823),a=(v>>>30)+(g>>>15)+f*c+(a>>>30),r[n++]=v&1073741823}return a}function M(e,t,r,n,a,i){for(var u=t&16383,f=t>>14;--i>=0;){var v=this[e]&16383,c=this[e++]>>14,g=f*v+c*u;v=u*v+((g&16383)<<14)+r[n]+a,a=(v>>28)+(g>>14)+f*c,r[n++]=v&268435455}return a}te.appName=="Microsoft Internet Explorer"?(b.prototype.am=j,B=30):te.appName!="Netscape"?(b.prototype.am=q,B=26):(b.prototype.am=M,B=28),b.prototype.DB=B,b.prototype.DM=(1<<B)-1,b.prototype.DV=1<<B;var R=52;b.prototype.FV=Math.pow(2,R),b.prototype.F1=R-B,b.prototype.F2=2*B-R;var V="0123456789abcdefghijklmnopqrstuvwxyz",A=new Array,C,H;for(C=48,H=0;H<=9;++H)A[C++]=H;for(C=97,H=10;H<36;++H)A[C++]=H;for(C=65,H=10;H<36;++H)A[C++]=H;function _(e){return V.charAt(e)}function z(e,t){var r=A[e.charCodeAt(t)];return r??-1}function J(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function re(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function ae(e){var t=D();return t.fromInt(e),t}function $(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var n=e.length,a=!1,i=0;--n>=0;){var u=r==8?e[n]&255:z(e,n);if(u<0){e.charAt(n)=="-"&&(a=!0);continue}a=!1,i==0?this[this.t++]=u:i+r>this.DB?(this[this.t-1]|=(u&(1<<this.DB-i)-1)<<i,this[this.t++]=u>>this.DB-i):this[this.t-1]|=u<<i,i+=r,i>=this.DB&&(i-=this.DB)}r==8&&(e[0]&128)!=0&&(this.s=-1,i>0&&(this[this.t-1]|=(1<<this.DB-i)-1<<i)),this.clamp(),a&&b.ZERO.subTo(this,this)}function Z(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t}function ne(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,n,a=!1,i="",u=this.t,f=this.DB-u*this.DB%t;if(u-- >0)for(f<this.DB&&(n=this[u]>>f)>0&&(a=!0,i=_(n));u>=0;)f<t?(n=(this[u]&(1<<f)-1)<<t-f,n|=this[--u]>>(f+=this.DB-t)):(n=this[u]>>(f-=t)&r,f<=0&&(f+=this.DB,--u)),n>0&&(a=!0),a&&(i+=_(n));return a?i:"0"}function se(){var e=D();return b.ZERO.subTo(this,e),e}function ge(){return this.s<0?this.negate():this}function ye(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this[r]-e[r])!=0)return t;return 0}function Se(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}function Fe(){return this.t<=0?0:this.DB*(this.t-1)+Se(this[this.t-1]^this.s&this.DM)}function Ce(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s}function Re(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s}function Pe(e,t){var r=e%this.DB,n=this.DB-r,a=(1<<n)-1,i=Math.floor(e/this.DB),u=this.s<<r&this.DM,f;for(f=this.t-1;f>=0;--f)t[f+i+1]=this[f]>>n|u,u=(this[f]&a)<<r;for(f=i-1;f>=0;--f)t[f]=0;t[i]=u,t.t=this.t+i+1,t.s=this.s,t.clamp()}function ce(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var n=e%this.DB,a=this.DB-n,i=(1<<n)-1;t[0]=this[r]>>n;for(var u=r+1;u<this.t;++u)t[u-r-1]|=(this[u]&i)<<a,t[u-r]=this[u]>>n;n>0&&(t[this.t-r-1]|=(this.s&i)<<a),t.t=this.t-r,t.clamp()}function oe(e,t){for(var r=0,n=0,a=Math.min(e.t,this.t);r<a;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()}function xe(e,t){var r=this.abs(),n=e.abs(),a=r.t;for(t.t=a+n.t;--a>=0;)t[a]=0;for(a=0;a<n.t;++a)t[a+r.t]=r.am(0,n[a],t,a,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&b.ZERO.subTo(t,t)}function de(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()}function qe(e,t,r){var n=e.abs();if(!(n.t<=0)){var a=this.abs();if(a.t<n.t){t!=null&&t.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=D());var i=D(),u=this.s,f=e.s,v=this.DB-Se(n[n.t-1]);v>0?(n.lShiftTo(v,i),a.lShiftTo(v,r)):(n.copyTo(i),a.copyTo(r));var c=i.t,g=i[c-1];if(g!=0){var x=g*(1<<this.F1)+(c>1?i[c-2]>>this.F2:0),o=this.FV/x,l=(1<<this.F1)/x,h=1<<this.F2,d=r.t,p=d-c,y=t??D();for(i.dlShiftTo(p,y),r.compareTo(y)>=0&&(r[r.t++]=1,r.subTo(y,r)),b.ONE.dlShiftTo(c,y),y.subTo(i,i);i.t<c;)i[i.t++]=0;for(;--p>=0;){var I=r[--d]==g?this.DM:Math.floor(r[d]*o+(r[d-1]+h)*l);if((r[d]+=i.am(0,I,r,p,0,c))<I)for(i.dlShiftTo(p,y),r.subTo(y,r);r[d]<--I;)r.subTo(y,r)}t!=null&&(r.drShiftTo(c,t),u!=f&&b.ZERO.subTo(t,t)),r.t=c,r.clamp(),v>0&&r.rShiftTo(v,r),u<0&&b.ZERO.subTo(r,r)}}}function _e(e){var t=D();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(b.ZERO)>0&&e.subTo(t,t),t}function Ue(e){this.m=e}function Ee(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function It(e){return e}function At(e){e.divRemTo(this.m,null,e)}function Gt(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function Rt(e,t){e.squareTo(t),this.reduce(t)}Ue.prototype.convert=Ee,Ue.prototype.revert=It,Ue.prototype.reduce=At,Ue.prototype.mulTo=Gt,Ue.prototype.sqrTo=Rt;function lt(){if(this.t<1)return 0;var e=this[0];if((e&1)==0)return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function $e(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function Vt(e){var t=D();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(b.ZERO)>0&&this.m.subTo(t,t),t}function Tt(e){var t=D();return e.copyTo(t),this.reduce(t),t}function Lt(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e[t]&32767,n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e[r]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function Ht(e,t){e.squareTo(t),this.reduce(t)}function Xt(e,t,r){e.multiplyTo(t,r),this.reduce(r)}$e.prototype.convert=Vt,$e.prototype.revert=Tt,$e.prototype.reduce=Lt,$e.prototype.mulTo=Xt,$e.prototype.sqrTo=Ht;function Nt(){return(this.t>0?this[0]&1:this.s)==0}function dt(e,t){if(e>4294967295||e<1)return b.ONE;var r=D(),n=D(),a=t.convert(this),i=Se(e)-1;for(a.copyTo(r);--i>=0;)if(t.sqrTo(r,n),(e&1<<i)>0)t.mulTo(n,a,r);else{var u=r;r=n,n=u}return t.revert(r)}function ot(e,t){var r;return e<256||t.isEven()?r=new Ue(t):r=new $e(t),this.exp(e,r)}b.prototype.copyTo=J,b.prototype.fromInt=re,b.prototype.fromString=$,b.prototype.clamp=Z,b.prototype.dlShiftTo=Ce,b.prototype.drShiftTo=Re,b.prototype.lShiftTo=Pe,b.prototype.rShiftTo=ce,b.prototype.subTo=oe,b.prototype.multiplyTo=xe,b.prototype.squareTo=de,b.prototype.divRemTo=qe,b.prototype.invDigit=lt,b.prototype.isEven=Nt,b.prototype.exp=dt,b.prototype.toString=ne,b.prototype.negate=se,b.prototype.abs=ge,b.prototype.compareTo=ye,b.prototype.bitLength=Fe,b.prototype.mod=_e,b.prototype.modPowInt=ot,b.ZERO=ae(0),b.ONE=ae(1);/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */function mt(){var e=D();return this.copyTo(e),e}function Kt(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function nr(){return this.t==0?this.s:this[0]<<24>>24}function Ct(){return this.t==0?this.s:this[0]<<16>>16}function _t(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function ln(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function ir(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=ae(r),a=D(),i=D(),u="";for(this.divRemTo(n,a,i);a.signum()>0;)u=(r+i.intValue()).toString(e).substr(1)+u,a.divRemTo(n,a,i);return i.intValue().toString(e)+u}function sr(e,t){this.fromInt(0),t==null&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),a=!1,i=0,u=0,f=0;f<e.length;++f){var v=z(e,f);if(v<0){e.charAt(f)=="-"&&this.signum()==0&&(a=!0);continue}u=t*u+v,++i>=r&&(this.dMultiply(n),this.dAddOffset(u,0),i=0,u=0)}i>0&&(this.dMultiply(Math.pow(t,i)),this.dAddOffset(u,0)),a&&b.ZERO.subTo(this,this)}function Dt(e,t,r){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(b.ONE.shiftLeft(e-1),Yt,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(b.ONE.shiftLeft(e-1),this);else{var n=new Array,a=e&7;n.length=(e>>3)+1,t.nextBytes(n),a>0?n[0]&=(1<<a)-1:n[0]=0,this.fromString(n,256)}}function Ot(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,n,a=0;if(e-- >0)for(r<this.DB&&(n=this[e]>>r)!=(this.s&this.DM)>>r&&(t[a++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this[e]&(1<<r)-1)<<8-r,n|=this[--e]>>(r+=this.DB-8)):(n=this[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),(n&128)!=0&&(n|=-256),a==0&&(this.s&128)!=(n&128)&&++a,(a>0||n!=this.s)&&(t[a++]=n);return t}function dn(e){return this.compareTo(e)==0}function ar(e){return this.compareTo(e)<0?this:e}function or(e){return this.compareTo(e)>0?this:e}function vn(e,t,r){var n,a,i=Math.min(e.t,this.t);for(n=0;n<i;++n)r[n]=t(this[n],e[n]);if(e.t<this.t){for(a=e.s&this.DM,n=i;n<this.t;++n)r[n]=t(this[n],a);r.t=this.t}else{for(a=this.s&this.DM,n=i;n<e.t;++n)r[n]=t(a,e[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function xn(e,t){return e&t}function ur(e){var t=D();return this.bitwiseTo(e,xn,t),t}function Yt(e,t){return e|t}function fr(e){var t=D();return this.bitwiseTo(e,Yt,t),t}function hr(e,t){return e^t}function cr(e){var t=D();return this.bitwiseTo(e,hr,t),t}function lr(e,t){return e&~t}function pn(e){var t=D();return this.bitwiseTo(e,lr,t),t}function gn(){for(var e=D(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e}function dr(e){var t=D();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function yn(e){var t=D();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function mn(e){if(e==0)return-1;var t=0;return(e&65535)==0&&(e>>=16,t+=16),(e&255)==0&&(e>>=8,t+=8),(e&15)==0&&(e>>=4,t+=4),(e&3)==0&&(e>>=2,t+=2),(e&1)==0&&++t,t}function vr(){for(var e=0;e<this.t;++e)if(this[e]!=0)return e*this.DB+mn(this[e]);return this.s<0?this.t*this.DB:-1}function Sn(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function xr(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=Sn(this[r]^t);return e}function it(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this[t]&1<<e%this.DB)!=0}function St(e,t){var r=b.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function pr(e){return this.changeBit(e,Yt)}function bn(e){return this.changeBit(e,lr)}function us(e){return this.changeBit(e,hr)}function fs(e,t){for(var r=0,n=0,a=Math.min(e.t,this.t);r<a;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()}function hs(e){var t=D();return this.addTo(e,t),t}function cs(e){var t=D();return this.subTo(e,t),t}function ls(e){var t=D();return this.multiplyTo(e,t),t}function ds(){var e=D();return this.squareTo(e),e}function vs(e){var t=D();return this.divRemTo(e,t,null),t}function xs(e){var t=D();return this.divRemTo(e,null,t),t}function ps(e){var t=D(),r=D();return this.divRemTo(e,t,r),new Array(t,r)}function gs(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function ys(e,t){if(e!=0){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}}function Zt(){}function $n(e){return e}function ms(e,t,r){e.multiplyTo(t,r)}function Ss(e,t){e.squareTo(t)}Zt.prototype.convert=$n,Zt.prototype.revert=$n,Zt.prototype.mulTo=ms,Zt.prototype.sqrTo=Ss;function bs(e){return this.exp(e,new Zt)}function ws(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r[--n]=0;var a;for(a=r.t-this.t;n<a;++n)r[n+this.t]=this.am(0,e[n],r,n,0,this.t);for(a=Math.min(e.t,t);n<a;++n)this.am(0,e[n],r,n,0,t-n);r.clamp()}function Es(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function Mt(e){this.r2=D(),this.q3=D(),b.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function Fs(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=D();return e.copyTo(t),this.reduce(t),t}function As(e){return e}function Cs(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function Ds(e,t){e.squareTo(t),this.reduce(t)}function Bs(e,t,r){e.multiplyTo(t,r),this.reduce(r)}Mt.prototype.convert=Fs,Mt.prototype.revert=As,Mt.prototype.reduce=Cs,Mt.prototype.mulTo=Bs,Mt.prototype.sqrTo=Ds;function Ps(e,t){var r=e.bitLength(),n,a=ae(1),i;if(r<=0)return a;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?i=new Ue(t):t.isEven()?i=new Mt(t):i=new $e(t);var u=new Array,f=3,v=n-1,c=(1<<n)-1;if(u[1]=i.convert(this),n>1){var g=D();for(i.sqrTo(u[1],g);f<=c;)u[f]=D(),i.mulTo(g,u[f-2],u[f]),f+=2}var x=e.t-1,o,l=!0,h=D(),d;for(r=Se(e[x])-1;x>=0;){for(r>=v?o=e[x]>>r-v&c:(o=(e[x]&(1<<r+1)-1)<<v-r,x>0&&(o|=e[x-1]>>this.DB+r-v)),f=n;(o&1)==0;)o>>=1,--f;if((r-=f)<0&&(r+=this.DB,--x),l)u[o].copyTo(a),l=!1;else{for(;f>1;)i.sqrTo(a,h),i.sqrTo(h,a),f-=2;f>0?i.sqrTo(a,h):(d=a,a=h,h=d),i.mulTo(h,u[o],a)}for(;x>=0&&(e[x]&1<<r)==0;)i.sqrTo(a,h),d=a,a=h,h=d,--r<0&&(r=this.DB-1,--x)}return i.revert(a)}function Is(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var a=t.getLowestSetBit(),i=r.getLowestSetBit();if(i<0)return t;for(a<i&&(i=a),i>0&&(t.rShiftTo(i,t),r.rShiftTo(i,r));t.signum()>0;)(a=t.getLowestSetBit())>0&&t.rShiftTo(a,t),(a=r.getLowestSetBit())>0&&r.rShiftTo(a,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return i>0&&r.lShiftTo(i,r),r}function Rs(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this[n])%e;return r}function Ts(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return b.ZERO;for(var r=e.clone(),n=this.clone(),a=ae(1),i=ae(0),u=ae(0),f=ae(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),t?((!a.isEven()||!i.isEven())&&(a.addTo(this,a),i.subTo(e,i)),a.rShiftTo(1,a)):i.isEven()||i.subTo(e,i),i.rShiftTo(1,i);for(;n.isEven();)n.rShiftTo(1,n),t?((!u.isEven()||!f.isEven())&&(u.addTo(this,u),f.subTo(e,f)),u.rShiftTo(1,u)):f.isEven()||f.subTo(e,f),f.rShiftTo(1,f);r.compareTo(n)>=0?(r.subTo(n,r),t&&a.subTo(u,a),i.subTo(f,i)):(n.subTo(r,n),t&&u.subTo(a,u),f.subTo(i,f))}if(n.compareTo(b.ONE)!=0)return b.ZERO;if(f.compareTo(e)>=0)return f.subtract(e);if(f.signum()<0)f.addTo(e,f);else return f;return f.signum()<0?f.add(e):f}var st=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Hs=(1<<26)/st[st.length-1];function Ns(e){var t,r=this.abs();if(r.t==1&&r[0]<=st[st.length-1]){for(t=0;t<st.length;++t)if(r[0]==st[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<st.length;){for(var n=st[t],a=t+1;a<st.length&&n<Hs;)n*=st[a++];for(n=r.modInt(n);t<a;)if(n%st[t++]==0)return!1}return r.millerRabin(e)}function _s(e){var t=this.subtract(b.ONE),r=t.getLowestSetBit();if(r<=0)return!1;var n=t.shiftRight(r);e=e+1>>1,e>st.length&&(e=st.length);for(var a=D(),i=0;i<e;++i){a.fromInt(st[Math.floor(Math.random()*st.length)]);var u=a.modPow(n,this);if(u.compareTo(b.ONE)!=0&&u.compareTo(t)!=0){for(var f=1;f++<r&&u.compareTo(t)!=0;)if(u=u.modPowInt(2,this),u.compareTo(b.ONE)==0)return!1;if(u.compareTo(t)!=0)return!1}}return!0}b.prototype.chunkSize=_t,b.prototype.toRadix=ir,b.prototype.fromRadix=sr,b.prototype.fromNumber=Dt,b.prototype.bitwiseTo=vn,b.prototype.changeBit=St,b.prototype.addTo=fs,b.prototype.dMultiply=gs,b.prototype.dAddOffset=ys,b.prototype.multiplyLowerTo=ws,b.prototype.multiplyUpperTo=Es,b.prototype.modInt=Rs,b.prototype.millerRabin=_s,b.prototype.clone=mt,b.prototype.intValue=Kt,b.prototype.byteValue=nr,b.prototype.shortValue=Ct,b.prototype.signum=ln,b.prototype.toByteArray=Ot,b.prototype.equals=dn,b.prototype.min=ar,b.prototype.max=or,b.prototype.and=ur,b.prototype.or=fr,b.prototype.xor=cr,b.prototype.andNot=pn,b.prototype.not=gn,b.prototype.shiftLeft=dr,b.prototype.shiftRight=yn,b.prototype.getLowestSetBit=vr,b.prototype.bitCount=xr,b.prototype.testBit=it,b.prototype.setBit=pr,b.prototype.clearBit=bn,b.prototype.flipBit=us,b.prototype.add=hs,b.prototype.subtract=cs,b.prototype.multiply=ls,b.prototype.divide=vs,b.prototype.remainder=xs,b.prototype.divideAndRemainder=ps,b.prototype.modPow=Ps,b.prototype.modInverse=Ts,b.prototype.pow=bs,b.prototype.gcd=Is,b.prototype.isProbablePrime=Ns,b.prototype.square=ds;/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */function wn(){this.i=0,this.j=0,this.S=new Array}function Os(e){var t,r,n;for(t=0;t<256;++t)this.S[t]=t;for(r=0,t=0;t<256;++t)r=r+this.S[t]+e[t%e.length]&255,n=this.S[t],this.S[t]=this.S[r],this.S[r]=n;this.i=0,this.j=0}function js(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]}wn.prototype.init=Os,wn.prototype.next=js;function qs(){return new wn}var En=256;/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */var gr,vt,Ze;function ks(e){vt[Ze++]^=e&255,vt[Ze++]^=e>>8&255,vt[Ze++]^=e>>16&255,vt[Ze++]^=e>>24&255,Ze>=En&&(Ze-=En)}function Fn(){ks(new Date().getTime())}if(vt==null){vt=new Array,Ze=0;var pt;if(me!==void 0&&(me.crypto!==void 0||me.msCrypto!==void 0)){var Gn=me.crypto||me.msCrypto;if(Gn.getRandomValues){var Xn=new Uint8Array(32);for(Gn.getRandomValues(Xn),pt=0;pt<32;++pt)vt[Ze++]=Xn[pt]}else if(te.appName=="Netscape"&&te.appVersion<"5"){var Yn=me.crypto.random(32);for(pt=0;pt<Yn.length;++pt)vt[Ze++]=Yn.charCodeAt(pt)&255}}for(;Ze<En;)pt=Math.floor(65536*Math.random()),vt[Ze++]=pt>>>8,vt[Ze++]=pt&255;Ze=0,Fn()}function Vs(){if(gr==null){for(Fn(),gr=qs(),gr.init(vt),Ze=0;Ze<vt.length;++Ze)vt[Ze]=0;Ze=0}return gr.next()}function Ls(e){var t;for(t=0;t<e.length;++t)e[t]=Vs()}function Ut(){}Ut.prototype.nextBytes=Ls;/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */function ut(e,t){return new b(e,t)}function we(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function Ks(e,t){if(this.isPublic=!0,this.isPrivate=!1,typeof e!="string")this.n=e,this.e=t;else if(e!=null&&t!=null&&e.length>0&&t.length>0)this.n=ut(e,16),this.e=parseInt(t,16);else throw"Invalid RSA public key";if(this.n==null||typeof this.n.compareTo!="function"||this.n.compareTo(b.ONE)<=0||this.e==null||isNaN(this.e)||this.e<=0)throw"Invalid RSA public key"}function Ms(e){return e.modPowInt(this.e,this.n)}we.prototype.doPublic=Ms,we.prototype.setPublic=Ks,we.prototype.type="RSA";function Us(e,t,r){if(this.isPrivate=!0,typeof e!="string")this.n=e,this.e=t,this.d=r;else if(e!=null&&t!=null&&e.length>0&&t.length>0)this.n=ut(e,16),this.e=parseInt(t,16),this.d=ut(r,16);else throw"Invalid RSA private key"}function zs(e,t,r,n,a,i,u,f){if(this.isPrivate=!0,this.isPublic=!1,e==null)throw"RSASetPrivateEx N == null";if(t==null)throw"RSASetPrivateEx E == null";if(e.length==0)throw"RSASetPrivateEx N.length == 0";if(t.length==0)throw"RSASetPrivateEx E.length == 0";if(e!=null&&t!=null&&e.length>0&&t.length>0)this.n=ut(e,16),this.e=parseInt(t,16),this.d=ut(r,16),this.p=ut(n,16),this.q=ut(a,16),this.dmp1=ut(i,16),this.dmq1=ut(u,16),this.coeff=ut(f,16);else throw"Invalid RSA private key in RSASetPrivateEx"}function Ws(e,t){var r=new Ut,n=e>>1;this.e=parseInt(t,16);for(var a=new b(t,16),i=e/2-100,u=b.ONE.shiftLeft(i);;){for(;this.p=new b(e-n,1,r),!(this.p.subtract(b.ONE).gcd(a).compareTo(b.ONE)==0&&this.p.isProbablePrime(10)););for(;this.q=new b(n,1,r),!(this.q.subtract(b.ONE).gcd(a).compareTo(b.ONE)==0&&this.q.isProbablePrime(10)););if(this.p.compareTo(this.q)<=0){var f=this.p;this.p=this.q,this.q=f}var v=this.q.subtract(this.p).abs();if(!(v.bitLength()<i||v.compareTo(u)<=0)){var c=this.p.subtract(b.ONE),g=this.q.subtract(b.ONE),x=c.multiply(g);if(x.gcd(a).compareTo(b.ONE)==0&&(this.n=this.p.multiply(this.q),this.n.bitLength()==e)){this.d=a.modInverse(x),this.dmp1=this.d.mod(c),this.dmq1=this.d.mod(g),this.coeff=this.q.modInverse(this.p);break}}}this.isPrivate=!0}function $s(e){if(this.p==null||this.q==null)return e.modPow(this.d,this.n);for(var t=e.mod(this.p).modPow(this.dmp1,this.p),r=e.mod(this.q).modPow(this.dmq1,this.q);t.compareTo(r)<0;)t=t.add(this.p);return t.subtract(r).multiply(this.coeff).mod(this.p).multiply(this.q).add(r)}we.prototype.doPrivate=$s,we.prototype.setPrivate=Us,we.prototype.setPrivateEx=zs,we.prototype.generate=Ws;/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */function Xe(e,t){this.x=t,this.q=e}function Gs(e){return e==this?!0:this.q.equals(e.q)&&this.x.equals(e.x)}function Xs(){return this.x}function Ys(){return new Xe(this.q,this.x.negate().mod(this.q))}function Zs(e){return new Xe(this.q,this.x.add(e.toBigInteger()).mod(this.q))}function Js(e){return new Xe(this.q,this.x.subtract(e.toBigInteger()).mod(this.q))}function Qs(e){return new Xe(this.q,this.x.multiply(e.toBigInteger()).mod(this.q))}function ea(){return new Xe(this.q,this.x.square().mod(this.q))}function ta(e){return new Xe(this.q,this.x.multiply(e.toBigInteger().modInverse(this.q)).mod(this.q))}Xe.prototype.equals=Gs,Xe.prototype.toBigInteger=Xs,Xe.prototype.negate=Ys,Xe.prototype.add=Zs,Xe.prototype.subtract=Js,Xe.prototype.multiply=Qs,Xe.prototype.square=ea,Xe.prototype.divide=ta,Xe.prototype.sqrt=function(){return new Xe(this.q,this.x.sqrt().mod(this.q))};function Ie(e,t,r,n){this.curve=e,this.x=t,this.y=r,n==null?this.z=b.ONE:this.z=n,this.zinv=null}function ra(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function na(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function ia(e){if(e==this)return!0;if(this.isInfinity())return e.isInfinity();if(e.isInfinity())return this.isInfinity();var t,r;return t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),t.equals(b.ZERO)?(r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q),r.equals(b.ZERO)):!1}function sa(){return this.x==null&&this.y==null?!0:this.z.equals(b.ZERO)&&!this.y.toBigInteger().equals(b.ZERO)}function aa(){return new Ie(this.curve,this.x,this.y.negate(),this.z)}function oa(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);if(b.ZERO.equals(r))return b.ZERO.equals(t)?this.twice():this.curve.getInfinity();var n=new b("3"),a=this.x.toBigInteger(),i=this.y.toBigInteger();e.x.toBigInteger(),e.y.toBigInteger();var u=r.square(),f=u.multiply(r),v=a.multiply(u),c=t.square().multiply(this.z),g=c.subtract(v.shiftLeft(1)).multiply(e.z).subtract(f).multiply(r).mod(this.curve.q),x=v.multiply(n).multiply(t).subtract(i.multiply(f)).subtract(c.multiply(t)).multiply(e.z).add(t.multiply(f)).mod(this.curve.q),o=f.multiply(this.z).multiply(e.z).mod(this.curve.q);return new Ie(this.curve,this.curve.fromBigInteger(g),this.curve.fromBigInteger(x),o)}function ua(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var e=new b("3"),t=this.x.toBigInteger(),r=this.y.toBigInteger(),n=r.multiply(this.z),a=n.multiply(r).mod(this.curve.q),i=this.curve.a.toBigInteger(),u=t.square().multiply(e);b.ZERO.equals(i)||(u=u.add(this.z.square().multiply(i))),u=u.mod(this.curve.q);var f=u.square().subtract(t.shiftLeft(3).multiply(a)).shiftLeft(1).multiply(n).mod(this.curve.q),v=u.multiply(e).multiply(t).subtract(a.shiftLeft(1)).shiftLeft(2).multiply(a).subtract(u.square().multiply(u)).mod(this.curve.q),c=n.square().multiply(n).shiftLeft(3).mod(this.curve.q);return new Ie(this.curve,this.curve.fromBigInteger(f),this.curve.fromBigInteger(v),c)}function fa(e){if(this.isInfinity())return this;if(e.signum()==0)return this.curve.getInfinity();var t=e,r=t.multiply(new b("3")),n=this.negate(),a=this,i=this.curve.q.subtract(e),u=i.multiply(new b("3")),f=new Ie(this.curve,this.x,this.y),v=f.negate(),c;for(c=r.bitLength()-2;c>0;--c){a=a.twice();var g=r.testBit(c),x=t.testBit(c);g!=x&&(a=a.add(g?this:n))}for(c=u.bitLength()-2;c>0;--c){f=f.twice();var o=u.testBit(c),l=i.testBit(c);o!=l&&(f=f.add(o?f:v))}return a}function ha(e,t,r){var n;e.bitLength()>r.bitLength()?n=e.bitLength()-1:n=r.bitLength()-1;for(var a=this.curve.getInfinity(),i=this.add(t);n>=0;)a=a.twice(),e.testBit(n)?r.testBit(n)?a=a.add(i):a=a.add(this):r.testBit(n)&&(a=a.add(t)),--n;return a}Ie.prototype.getX=ra,Ie.prototype.getY=na,Ie.prototype.equals=ia,Ie.prototype.isInfinity=sa,Ie.prototype.negate=aa,Ie.prototype.add=oa,Ie.prototype.twice=ua,Ie.prototype.multiply=fa,Ie.prototype.multiplyTwo=ha;function Ft(e,t,r){this.q=e,this.a=this.fromBigInteger(t),this.b=this.fromBigInteger(r),this.infinity=new Ie(this,null,null)}function ca(){return this.q}function la(){return this.a}function da(){return this.b}function va(e){return e==this?!0:this.q.equals(e.q)&&this.a.equals(e.a)&&this.b.equals(e.b)}function xa(){return this.infinity}function pa(e){return new Xe(this.q,e)}function ga(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:var t=e.substr(0,2);e.substr(2);var r=this.fromBigInteger(new b(v,16)),n=this.getA(),a=this.getB(),i=r.square().add(n).multiply(r).add(a),u=i.sqrt();return t=="03"&&(u=u.negate()),new Ie(this,r,u);case 4:case 6:case 7:var f=(e.length-2)/2,v=e.substr(2,f),c=e.substr(f+2,f);return new Ie(this,this.fromBigInteger(new b(v,16)),this.fromBigInteger(new b(c,16)));default:return null}}Ft.prototype.getQ=ca,Ft.prototype.getA=la,Ft.prototype.getB=da,Ft.prototype.equals=va,Ft.prototype.getInfinity=xa,Ft.prototype.fromBigInteger=pa,Ft.prototype.decodePointHex=ga;/*! (c) Stefan Thomas | https://github.com/bitcoinjs/bitcoinjs-lib
 */Xe.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},Ie.prototype.getEncoded=function(e){var t=function(i,u){var f=i.toByteArrayUnsigned();if(u<f.length)f=f.slice(f.length-u);else for(;u>f.length;)f.unshift(0);return f},r=this.getX().toBigInteger(),n=this.getY().toBigInteger(),a=t(r,32);return e?n.isEven()?a.unshift(2):a.unshift(3):(a.unshift(4),a=a.concat(t(n,32))),a},Ie.decodeFrom=function(e,t){t[0];var r=t.length-1,n=t.slice(1,1+r/2),a=t.slice(1+r/2,1+r);n.unshift(0),a.unshift(0);var i=new b(n),u=new b(a);return new Ie(e,e.fromBigInteger(i),e.fromBigInteger(u))},Ie.decodeFromHex=function(e,t){t.substr(0,2);var r=t.length-2,n=t.substr(2,r/2),a=t.substr(2+r/2,r/2),i=new b(n,16),u=new b(a,16);return new Ie(e,e.fromBigInteger(i),e.fromBigInteger(u))},Ie.prototype.add2D=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;if(this.x.equals(e.x))return this.y.equals(e.y)?this.twice():this.curve.getInfinity();var t=e.x.subtract(this.x),r=e.y.subtract(this.y),n=r.divide(t),a=n.square().subtract(this.x).subtract(e.x),i=n.multiply(this.x.subtract(a)).subtract(this.y);return new Ie(this.curve,a,i)},Ie.prototype.twice2D=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var e=this.curve.fromBigInteger(b.valueOf(2)),t=this.curve.fromBigInteger(b.valueOf(3)),r=this.x.square().multiply(t).add(this.curve.a).divide(this.y.multiply(e)),n=r.square().subtract(this.x.multiply(e)),a=r.multiply(this.x.subtract(n)).subtract(this.y);return new Ie(this.curve,n,a)},Ie.prototype.multiply2D=function(e){if(this.isInfinity())return this;if(e.signum()==0)return this.curve.getInfinity();var t=e,r=t.multiply(new b("3")),n=this.negate(),a=this,i;for(i=r.bitLength()-2;i>0;--i){a=a.twice();var u=r.testBit(i),f=t.testBit(i);u!=f&&(a=a.add2D(u?this:n))}return a},Ie.prototype.isOnCurve=function(){var e=this.getX().toBigInteger(),t=this.getY().toBigInteger(),r=this.curve.getA().toBigInteger(),n=this.curve.getB().toBigInteger(),a=this.curve.getQ(),i=t.multiply(t).mod(a),u=e.multiply(e).multiply(e).add(r.multiply(e)).add(n).mod(a);return i.equals(u)},Ie.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},Ie.prototype.validate=function(){var e=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var t=this.getX().toBigInteger(),r=this.getY().toBigInteger();if(t.compareTo(b.ONE)<0||t.compareTo(e.subtract(b.ONE))>0)throw new Error("x coordinate out of bounds");if(r.compareTo(b.ONE)<0||r.compareTo(e.subtract(b.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(e).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};/*! Mike Samuel (c) 2009 | code.google.com/p/json-sans-eval
 */var Zn=(function(){var e="(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)",t='(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))',r='(?:"'+t+'*")',n=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+e+"|"+r+")","g"),a=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),i={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function u(g,x,o){return x?i[x]:String.fromCharCode(parseInt(o,16))}var f=new String(""),v="\\",c=Object.hasOwnProperty;return function(g,x){var o=g.match(n),l,h=o[0],d=!1;h==="{"?l={}:h==="["?l=[]:(l=[],d=!0);for(var p,y=[l],I=1-d,K=o.length;I<K;++I){h=o[I];var L;switch(h.charCodeAt(0)){default:L=y[0],L[p||L.length]=+h,p=void 0;break;case 34:if(h=h.substring(1,h.length-1),h.indexOf(v)!==-1&&(h=h.replace(a,u)),L=y[0],!p)if(L instanceof Array)p=L.length;else{p=h||f;break}L[p]=h,p=void 0;break;case 91:L=y[0],y.unshift(L[p||L.length]=[]),p=void 0;break;case 93:y.shift();break;case 102:L=y[0],L[p||L.length]=!1,p=void 0;break;case 110:L=y[0],L[p||L.length]=null,p=void 0;break;case 116:L=y[0],L[p||L.length]=!0,p=void 0;break;case 123:L=y[0],y.unshift(L[p||L.length]={}),p=void 0;break;case 125:y.shift();break}}if(d){if(y.length!==1)throw new Error;l=l[0]}else if(y.length)throw new Error;if(x){var W=function(m,w){var E=m[w];if(E&&typeof E=="object"){var S=null;for(var P in E)if(c.call(E,P)&&E!==m){var U=W(E,P);U!==void 0?E[P]=U:(S||(S=[]),S.push(P))}if(S)for(var X=S.length;--X>=0;)delete E[S[X]]}return x.call(m,w,E)};l=W({"":l},"")}return l}})();(typeof s>"u"||!s)&&(s={}),(typeof s.asn1>"u"||!s.asn1)&&(s.asn1={}),s.asn1.ASN1Util=new function(){this.integerToByteHex=function(e){var t=e.toString(16);return t.length%2==1&&(t="0"+t),t},this.bigIntToMinTwosComplementsHex=function(e){return er(e)},this.getPEMStringFromHex=function(e,t){return rt(e,t)},this.newObject=function(e){var t=s,r=t.asn1,n=r.ASN1Object,a=r.DERBoolean,i=r.DERInteger,u=r.DERBitString,f=r.DEROctetString,v=r.DERNull,c=r.DERObjectIdentifier,g=r.DEREnumerated,x=r.DERUTF8String,o=r.DERNumericString,l=r.DERPrintableString,h=r.DERTeletexString,d=r.DERIA5String,p=r.DERUTCTime,y=r.DERGeneralizedTime,I=r.DERVisibleString,K=r.DERBMPString,L=r.DERSequence,W=r.DERSet,m=r.DERTaggedObject,w=r.ASN1Util.newObject;if(e instanceof r.ASN1Object)return e;var E=Object.keys(e);if(E.length!=1)throw new Error("key of param shall be only one.");var S=E[0];if(":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+S+":")==-1)throw new Error("undefined key: "+S);if(S=="bool")return new a(e[S]);if(S=="int")return new i(e[S]);if(S=="bitstr")return new u(e[S]);if(S=="octstr")return new f(e[S]);if(S=="null")return new v(e[S]);if(S=="oid")return new c(e[S]);if(S=="enum")return new g(e[S]);if(S=="utf8str")return new x(e[S]);if(S=="numstr")return new o(e[S]);if(S=="prnstr")return new l(e[S]);if(S=="telstr")return new h(e[S]);if(S=="ia5str")return new d(e[S]);if(S=="utctime")return new p(e[S]);if(S=="gentime")return new y(e[S]);if(S=="visstr")return new I(e[S]);if(S=="bmpstr")return new K(e[S]);if(S=="asn1")return new n(e[S]);if(S=="seq"){for(var P=e[S],U=[],X=0;X<P.length;X++){var fe=w(P[X]);U.push(fe)}return new L({array:U})}if(S=="set"){for(var P=e[S],U=[],X=0;X<P.length;X++){var fe=w(P[X]);U.push(fe)}return new W({array:U})}if(S=="tag"){var G=e[S];if(Object.prototype.toString.call(G)==="[object Array]"&&G.length==3){var ee=w(G[2]);return new m({tag:G[0],explicit:G[1],obj:ee})}else return new m(G)}},this.jsonToASN1HEX=function(e){var t=this.newObject(e);return t.tohex()}},s.asn1.ASN1Util.oidHexToInt=function(e){for(var a="",t=parseInt(e.substr(0,2),16),r=Math.floor(t/40),n=t%40,a=r+"."+n,i="",u=2;u<e.length;u+=2){var f=parseInt(e.substr(u,2),16),v=("00000000"+f.toString(2)).slice(-8);if(i=i+v.substr(1,7),v.substr(0,1)=="0"){var c=new b(i,2);a=a+"."+c.toString(10),i=""}}return a},s.asn1.ASN1Util.oidIntToHex=function(e){var t=function(f){var v=f.toString(16);return v.length==1&&(v="0"+v),v},r=function(f){var v="",c=new b(f,10),g=c.toString(2),x=7-g.length%7;x==7&&(x=0);for(var o="",l=0;l<x;l++)o+="0";g=o+g;for(var l=0;l<g.length-1;l+=7){var h=g.substr(l,7);l!=g.length-7&&(h="1"+h),v+=t(parseInt(h,2))}return v};if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var n="",a=e.split("."),i=parseInt(a[0])*40+parseInt(a[1]);n+=t(i),a.splice(0,2);for(var u=0;u<a.length;u++)n+=r(a[u]);return n},s.asn1.ASN1Object=function(e){var t="";this.params=null,this.getLengthHexFromValue=function(){if(typeof this.hV>"u"||this.hV==null)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n="+t.length+",v="+this.hV);var r=this.hV.length/2,n=r.toString(16);if(n.length%2==1&&(n="0"+n),r<128)return n;var a=n.length/2;if(a>15)throw new Error("ASN.1 length too long to represent by 8x: n = "+r.toString(16));var i=128+a;return i.toString(16)+n},this.tohex=function(){return(this.hTLV==null||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.getValueHex=function(){return this.tohex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(r){this.params=r},e!=null&&e.tlv!=null&&(this.hTLV=e.tlv,this.isModified=!1)},s.asn1.DERAbstractString=function(e){s.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=mr(this.s).toLowerCase()},this.setStringHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.getFreshValueHex=function(){return this.hV},typeof e<"u"&&(typeof e=="string"?this.setString(e):typeof e.str<"u"?this.setString(e.str):typeof e.hex<"u"&&this.setStringHex(e.hex))},ue(s.asn1.DERAbstractString,s.asn1.ASN1Object),s.asn1.DERAbstractTime=function(e){s.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(t){var r=t.getTime()+t.getTimezoneOffset()*6e4,n=new Date(r);return n},this.formatDate=function(t,r,n){var a=this.zeroPadding,i=this.localDateToUTC(t),u=String(i.getFullYear());r=="utc"&&(u=u.substr(2,2));var f=a(String(i.getMonth()+1),2),v=a(String(i.getDate()),2),c=a(String(i.getHours()),2),g=a(String(i.getMinutes()),2),x=a(String(i.getSeconds()),2),o=u+f+v+c+g+x;if(n===!0){var l=i.getMilliseconds();if(l!=0){var h=a(String(l),3);h=h.replace(/[0]+$/,""),o=o+"."+h}}return o+"Z"},this.zeroPadding=function(t,r){return t.length>=r?t:new Array(r-t.length+1).join("0")+t},this.setByParam=function(t){this.hV=null,this.hTLV=null,this.params=t},this.getString=function(){},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.str=t},this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.date=t},this.setByDateValue=function(t,r,n,a,i,u){var f=new Date(Date.UTC(t,r-1,n,a,i,u,0));this.setByDate(f)},this.getFreshValueHex=function(){return this.hV}},ue(s.asn1.DERAbstractTime,s.asn1.ASN1Object),s.asn1.DERAbstractStructured=function(e){s.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array=t},this.appendASN1Object=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array.push(t)},this.asn1Array=new Array,typeof e<"u"&&typeof e.array<"u"&&(this.asn1Array=e.array)},ue(s.asn1.DERAbstractStructured,s.asn1.ASN1Object),s.asn1.DERBoolean=function(e){s.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",e==!1?this.hTLV="010100":this.hTLV="0101ff"},ue(s.asn1.DERBoolean,s.asn1.ASN1Object),s.asn1.DERInteger=function(e){s.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.params=null;var t=er;this.setByBigInteger=function(r){this.isModified=!0,this.params={bigint:r}},this.setByInteger=function(r){this.isModified=!0,this.params=r},this.setValueHex=function(r){this.isModified=!0,this.params={hex:r}},this.getFreshValueHex=function(){var r=this.params,n=null;if(r==null)throw new Error("value not set");if(typeof r=="object"&&r.hex!=null)return this.hV=r.hex,this.hV;if(typeof r=="number")n=new b(String(r),10);else if(r.int!=null)n=new b(String(r.int),10);else if(r.bigint!=null)n=r.bigint;else throw new Error("wrong parameter");return this.hV=t(n),this.hV},e!=null&&(this.params=e)},ue(s.asn1.DERInteger,s.asn1.ASN1Object),s.asn1.DERBitString=function(e){if(e!==void 0&&typeof e.obj<"u"){var t=s.asn1.ASN1Util.newObject(e.obj);e.hex="00"+t.tohex()}s.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(r){this.hTLV=null,this.isModified=!0,this.hV=r},this.setUnusedBitsAndHexValue=function(r,n){if(r<0||7<r)throw"unused bits shall be from 0 to 7: u = "+r;var a="0"+r;this.hTLV=null,this.isModified=!0,this.hV=a+n},this.setByBinaryString=function(r){r=r.replace(/0+$/,"");var n=8-r.length%8;n==8&&(n=0),r+="0000000".substr(0,n);for(var a="",i=0;i<r.length-1;i+=8){var u=r.substr(i,8),f=parseInt(u,2).toString(16);f.length==1&&(f="0"+f),a+=f}this.hTLV=null,this.isModified=!0,this.hV="0"+n+a},this.setByBooleanArray=function(r){for(var n="",a=0;a<r.length;a++)r[a]==!0?n+="1":n+="0";this.setByBinaryString(n)},this.newFalseArray=function(r){for(var n=new Array(r),a=0;a<r;a++)n[a]=!1;return n},this.getFreshValueHex=function(){return this.hV},typeof e<"u"&&(typeof e=="string"&&e.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(e):typeof e.hex<"u"?this.setHexValueIncludingUnusedBits(e.hex):typeof e.bin<"u"?this.setByBinaryString(e.bin):typeof e.array<"u"&&this.setByBooleanArray(e.array))},ue(s.asn1.DERBitString,s.asn1.ASN1Object),s.asn1.DEROctetString=function(e){if(e!==void 0&&typeof e.obj<"u"){var t=s.asn1.ASN1Util.newObject(e.obj);e.hex=t.tohex()}s.asn1.DEROctetString.superclass.constructor.call(this,e),this.hT="04"},ue(s.asn1.DEROctetString,s.asn1.DERAbstractString),s.asn1.DERNull=function(){s.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},ue(s.asn1.DERNull,s.asn1.ASN1Object),s.asn1.DERObjectIdentifier=function(e){s.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){var r=ai(t);if(r==null)throw new Error("malformed oid string: "+t);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=r},this.setValueName=function(t){var r=s.asn1.x509.OID.name2oid(t);if(r!=="")this.setValueOidString(r);else throw new Error("DERObjectIdentifier oidName undefined: "+t)},this.setValueNameOrOid=function(t){t.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(t):this.setValueName(t)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(t){typeof t=="string"?this.setValueNameOrOid(t):t.oid!==void 0?this.setValueNameOrOid(t.oid):t.name!==void 0?this.setValueNameOrOid(t.name):t.hex!==void 0&&this.setValueHex(t.hex)},e!==void 0&&this.setByParam(e)},ue(s.asn1.DERObjectIdentifier,s.asn1.ASN1Object),s.asn1.DEREnumerated=function(e){s.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=er(t)},this.setByInteger=function(t){var r=new b(String(t),10);this.setByBigInteger(r)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},typeof e<"u"&&(typeof e.int<"u"?this.setByInteger(e.int):typeof e=="number"?this.setByInteger(e):typeof e.hex<"u"&&this.setValueHex(e.hex))},ue(s.asn1.DEREnumerated,s.asn1.ASN1Object),s.asn1.DERUTF8String=function(e){s.asn1.DERUTF8String.superclass.constructor.call(this,e),this.hT="0c"},ue(s.asn1.DERUTF8String,s.asn1.DERAbstractString),s.asn1.DERNumericString=function(e){s.asn1.DERNumericString.superclass.constructor.call(this,e),this.hT="12"},ue(s.asn1.DERNumericString,s.asn1.DERAbstractString),s.asn1.DERPrintableString=function(e){s.asn1.DERPrintableString.superclass.constructor.call(this,e),this.hT="13"},ue(s.asn1.DERPrintableString,s.asn1.DERAbstractString),s.asn1.DERTeletexString=function(e){s.asn1.DERTeletexString.superclass.constructor.call(this,e),this.hT="14"},ue(s.asn1.DERTeletexString,s.asn1.DERAbstractString),s.asn1.DERIA5String=function(e){s.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="16"},ue(s.asn1.DERIA5String,s.asn1.DERAbstractString),s.asn1.DERVisibleString=function(e){s.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="1a"},ue(s.asn1.DERVisibleString,s.asn1.DERAbstractString),s.asn1.DERBMPString=function(e){s.asn1.DERBMPString.superclass.constructor.call(this,e),this.hT="1e"},ue(s.asn1.DERBMPString,s.asn1.DERAbstractString),s.asn1.DERUTCTime=function(e){s.asn1.DERUTCTime.superclass.constructor.call(this,e),this.hT="17",this.params=void 0,this.getFreshValueHex=function(){var t=this.params;if(this.params==null&&(t={date:new Date}),typeof t=="string")if(t.match(/^[0-9]{12}Z$/)||t.match(/^[0-9]{12}\.[0-9]+Z$/))this.hV=ft(t);else throw new Error("malformed string for UTCTime: "+t);else if(t.str!=null)this.hV=ft(t.str);else if(t.date==null&&t.millis==!0){var r=new Date;this.hV=ft(this.formatDate(r,"utc",!0))}else if(t.date!=null&&t.date instanceof Date){var n=t.millis===!0;this.hV=ft(this.formatDate(t.date,"utc",n))}else t instanceof Date&&(this.hV=ft(this.formatDate(t,"utc")));if(this.hV==null)throw new Error("parameter not specified properly for UTCTime");return this.hV},e!=null&&this.setByParam(e)},ue(s.asn1.DERUTCTime,s.asn1.DERAbstractTime),s.asn1.DERGeneralizedTime=function(e){s.asn1.DERGeneralizedTime.superclass.constructor.call(this,e),this.hT="18",this.params=e,this.getFreshValueHex=function(){var t=this.params;if(this.params==null&&(t={date:new Date}),typeof t=="string")if(t.match(/^[0-9]{14}Z$/)||t.match(/^[0-9]{14}\.[0-9]+Z$/))this.hV=ft(t);else throw new Error("malformed string for GeneralizedTime: "+t);else if(t.str!=null)this.hV=ft(t.str);else if(t.date==null&&t.millis==!0){var r=new Date;this.hV=ft(this.formatDate(r,"gen",!0))}else if(t.date!=null&&t.date instanceof Date){var n=t.millis===!0;this.hV=ft(this.formatDate(t.date,"gen",n))}else t instanceof Date&&(this.hV=ft(this.formatDate(t,"gen")));if(this.hV==null)throw new Error("parameter not specified properly for GeneralizedTime");return this.hV},e!=null&&this.setByParam(e)},ue(s.asn1.DERGeneralizedTime,s.asn1.DERAbstractTime),s.asn1.DERSequence=function(e){s.asn1.DERSequence.superclass.constructor.call(this,e),this.hT="30",this.getFreshValueHex=function(){for(var t="",r=0;r<this.asn1Array.length;r++){var n=this.asn1Array[r];t+=n.tohex()}return this.hV=t,this.hV}},ue(s.asn1.DERSequence,s.asn1.DERAbstractStructured),s.asn1.DERSet=function(e){s.asn1.DERSet.superclass.constructor.call(this,e),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var t=new Array,r=0;r<this.asn1Array.length;r++){var n=this.asn1Array[r];t.push(n.tohex())}return this.sortFlag==!0&&t.sort(),this.hV=t.join(""),this.hV},typeof e<"u"&&typeof e.sortflag<"u"&&e.sortflag==!1&&(this.sortFlag=!1)},ue(s.asn1.DERSet,s.asn1.DERAbstractStructured),s.asn1.DERTaggedObject=function(e){s.asn1.DERTaggedObject.superclass.constructor.call(this);var t=s.asn1,r=ve,n=r.getV;r.isASN1HEX;var a=t.ASN1Util.newObject;this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.params={tag:"a0",explicit:!0},this.setASN1Object=function(i,u,f){this.params={tag:u,explicit:i,obj:f}},this.getFreshValueHex=function(){var i=this.params;if(i.explicit==null&&(i.explicit=!0),i.tage!=null&&(i.tag=i.tage,i.explicit=!0),i.tagi!=null&&(i.tag=i.tagi,i.explicit=!1),i.str!=null)this.hV=mr(i.str);else if(i.hex!=null)this.hV=i.hex;else if(i.obj!=null){var u;i.obj instanceof t.ASN1Object?u=i.obj.tohex():typeof i.obj=="object"&&(u=a(i.obj).tohex()),i.explicit?this.hV=u:this.hV=n(u,0)}else throw new Error("str, hex nor obj not specified");return i.tag==null&&(i.tag="a0"),this.hT=i.tag,this.hTLV=null,this.isModified=!0,this.hV},this.setByParam=function(i){this.params=i},e!==void 0&&this.setByParam(e)},ue(s.asn1.DERTaggedObject,s.asn1.ASN1Object);var ve=new function(){};ve.getLblen=function(e,t){if(e.substr(t+2,1)!="8")return 1;var r=parseInt(e.substr(t+3,1));return r==0?-1:0<r&&r<10?r+1:-2},ve.getL=function(e,t){var r=ve.getLblen(e,t);return r<1?"":e.substr(t+2,r*2)},ve.getVblen=function(e,t){var r,n;return r=ve.getL(e,t),r==""?-1:(r.substr(0,1)==="8"?n=new b(r.substr(2),16):n=new b(r,16),n.intValue())},ve.getVidx=function(e,t){var r=ve.getLblen(e,t);return r<0?r:t+(r+1)*2},ve.getV=function(e,t){var r=ve.getVidx(e,t),n=ve.getVblen(e,t);return e.substr(r,n*2)},ve.getTLV=function(e,t){return e.substr(t,2)+ve.getL(e,t)+ve.getV(e,t)},ve.getTLVblen=function(e,t){return 2+ve.getLblen(e,t)*2+ve.getVblen(e,t)*2},ve.getNextSiblingIdx=function(e,t){var r=ve.getVidx(e,t),n=ve.getVblen(e,t);return r+n*2},ve.getChildIdx=function(e,t){var r=ve,n=[],a,i,u;a=r.getVidx(e,t),i=r.getVblen(e,t)*2,e.substr(t,2)=="03"&&(a+=2,i-=2),u=0;for(var f=a;u<=i;){var v=r.getTLVblen(e,f);if(u+=v,u<=i&&n.push(f),f+=v,u>=i)break}return n},ve.getNthChildIdx=function(e,t,r){var n=ve.getChildIdx(e,t);return n[r]},ve.getIdxbyList=function(e,t,r,n){var a=ve,i,u;return r.length==0?n!==void 0&&e.substr(t,2)!==n?-1:t:(i=r.shift(),u=a.getChildIdx(e,t),i>=u.length?-1:a.getIdxbyList(e,u[i],r,n))},ve.getIdxbyListEx=function(e,t,r,n){var a=ve,i,u;if(r.length==0)return n!==void 0&&e.substr(t,2)!==n?-1:t;i=r.shift(),u=a.getChildIdx(e,t);for(var f=0,v=0;v<u.length;v++){var c=e.substr(u[v],2);if(typeof i=="number"&&!a.isContextTag(c)&&f==i||typeof i=="string"&&a.isContextTag(c,i))return a.getIdxbyListEx(e,u[v],r,n);a.isContextTag(c)||f++}return-1},ve.getTLVbyList=function(e,t,r,n){var a=ve,i=a.getIdxbyList(e,t,r,n);return i==-1||i>=e.length?null:a.getTLV(e,i)},ve.getTLVbyListEx=function(e,t,r,n){var a=ve,i=a.getIdxbyListEx(e,t,r,n);return i==-1?null:a.getTLV(e,i)},ve.getVbyList=function(e,t,r,n,a){var i=ve,u,f;return u=i.getIdxbyList(e,t,r,n),u==-1||u>=e.length?null:(f=i.getV(e,u),a===!0&&(f=f.substr(2)),f)},ve.getVbyListEx=function(e,t,r,n,a){var i=ve,u,f;return u=i.getIdxbyListEx(e,t,r,n),u==-1?null:(f=i.getV(e,u),e.substr(u,2)=="03"&&a!==!1&&(f=f.substr(2)),f)},ve.getInt=function(e,t,r){r==null&&(r=-1);try{var n=e.substr(t,2);if(n!="02"&&n!="03")return r;var a=ve.getV(e,t);return n=="02"?parseInt(a,16):ui(a)}catch{return r}},ve.getOID=function(e,t,r){r==null&&(r=null);try{if(e.substr(t,2)!="06")return r;var n=ve.getV(e,t);return Ar(n)}catch{return r}},ve.getOIDName=function(e,t,r){r==null&&(r=null);try{var n=ve.getOID(e,t,r);if(n==r)return r;var a=s.asn1.x509.OID.oid2name(n);return a==""?n:a}catch{return r}},ve.getString=function(e,t,r){r==null&&(r=null);try{var n=ve.getV(e,t);return ht(n)}catch{return r}},ve.hextooidstr=function(e){var t=function(x,o){return x.length>=o?x:new Array(o-x.length+1).join("0")+x},r=[],n=e.substr(0,2),a=parseInt(n,16);r[0]=new String(Math.floor(a/40)),r[1]=new String(a%40);for(var i=e.substr(2),u=[],f=0;f<i.length/2;f++)u.push(parseInt(i.substr(f*2,2),16));for(var v=[],c="",f=0;f<u.length;f++)u[f]&128?c=c+t((u[f]&127).toString(2),7):(c=c+t((u[f]&127).toString(2),7),v.push(new String(parseInt(c,2))),c="");var g=r.join(".");return v.length>0&&(g=g+"."+v.join(".")),g},ve.dump=function(e,t,r,n){var a=ve,i=a.getV,u=a.dump,f=a.getChildIdx,v=e;e instanceof s.asn1.ASN1Object&&(v=e.tohex());var c=function(w,E){if(w.length<=E*2)return w;var S=w.substr(0,E)+"..(total "+w.length/2+"bytes).."+w.substr(w.length-E,E);return S};t===void 0&&(t={ommit_long_octet:32}),r===void 0&&(r=0),n===void 0&&(n="");var g=t.ommit_long_octet,W=v.substr(r,2);if(W=="01"){var x=i(v,r);return x=="00"?n+`BOOLEAN FALSE
`:n+`BOOLEAN TRUE
`}if(W=="02"){var x=i(v,r);return n+"INTEGER "+c(x,g)+`
`}if(W=="03"){var x=i(v,r);if(a.isASN1HEX(x.substr(2))){var o=n+`BITSTRING, encapsulates
`;return o=o+u(x.substr(2),t,0,n+"  "),o}else return n+"BITSTRING "+c(x,g)+`
`}if(W=="04"){var x=i(v,r);if(a.isASN1HEX(x)){var o=n+`OCTETSTRING, encapsulates
`;return o=o+u(x,t,0,n+"  "),o}else return n+"OCTETSTRING "+c(x,g)+`
`}if(W=="05")return n+`NULL
`;if(W=="06"){var l=i(v,r),h=s.asn1.ASN1Util.oidHexToInt(l),d=s.asn1.x509.OID.oid2name(h),p=h.replace(/\./g," ");return d!=""?n+"ObjectIdentifier "+d+" ("+p+`)
`:n+"ObjectIdentifier ("+p+`)
`}if(W=="0a")return n+"ENUMERATED "+parseInt(i(v,r))+`
`;if(W=="0c")return n+"UTF8String '"+He(i(v,r))+`'
`;if(W=="13")return n+"PrintableString '"+He(i(v,r))+`'
`;if(W=="14")return n+"TeletexString '"+He(i(v,r))+`'
`;if(W=="16")return n+"IA5String '"+He(i(v,r))+`'
`;if(W=="17")return n+"UTCTime "+He(i(v,r))+`
`;if(W=="18")return n+"GeneralizedTime "+He(i(v,r))+`
`;if(W=="1a")return n+"VisualString '"+He(i(v,r))+`'
`;if(W=="1e")return n+"BMPString '"+In(i(v,r))+`'
`;if(W=="30"){if(v.substr(r,4)=="3000")return n+`SEQUENCE {}
`;var o=n+`SEQUENCE
`,y=f(v,r),I=t;if((y.length==2||y.length==3)&&v.substr(y[0],2)=="06"&&v.substr(y[y.length-1],2)=="04"){var d=a.oidname(i(v,y[0])),K=JSON.parse(JSON.stringify(t));K.x509ExtName=d,I=K}for(var L=0;L<y.length;L++)o=o+u(v,I,y[L],n+"  ");return o}if(W=="31"){for(var o=n+`SET
`,y=f(v,r),L=0;L<y.length;L++)o=o+u(v,t,y[L],n+"  ");return o}var W=parseInt(W,16);if((W&128)!=0){var m=W&31;if((W&32)!=0){for(var o=n+"["+m+`]
`,y=f(v,r),L=0;L<y.length;L++)o=o+u(v,t,y[L],n+"  ");return o}else{var x=i(v,r);if(ve.isASN1HEX(x)){var o=n+"["+m+`]
`;return o=o+u(x,t,0,n+"  "),o}else(x.substr(0,8)=="68747470"||t.x509ExtName==="subjectAltName"&&m==2)&&(x=He(x));var o=n+"["+m+"] "+x+`
`;return o}}return n+"UNKNOWN("+W+") "+i(v,r)+`
`},ve.parse=function(e){var t=ve,r=t.parse,n=t.isASN1HEX,a=t.getV,i=t.getTLV,u=t.getChildIdx,f=s.asn1,v=f.ASN1Util.oidHexToInt,c=f.x509.OID.oid2name,g=He,x=In,o=Ea,l={"0c":"utf8str",12:"numstr",13:"prnstr",14:"telstr",16:"ia5str",17:"utctime",18:"gentime","1a":"visstr","1e":"bmpstr",30:"seq",31:"set"},h=function(S){for(var P=[],U=u(S,0),X=0;X<U.length;X++){var fe=U[X],G=i(S,fe),ee=r(G);P.push(ee)}return P},d=e.substr(0,2),p={},y=a(e,0);if(d=="01")return e=="0101ff"?{bool:!0}:{bool:!1};if(d=="02")return{int:{hex:y}};if(d=="03")try{if(y.substr(0,2)!="00")throw"not encap";var I=y.substr(2);if(!n(I))throw"not encap";return{bitstr:{obj:r(I)}}}catch{var K=null;return y.length<=10&&(K=hi(y)),K==null?{bitstr:{hex:y}}:{bitstr:{bin:K}}}else if(d=="04")try{if(!n(y))throw"not encap";return{octstr:{obj:r(y)}}}catch{return{octstr:{hex:y}}}else{if(d=="05")return{null:""};if(d=="06"){var L=v(y),W=c(L);return W==""?{oid:L}:{oid:W}}else{if(d=="0a")return y.length>4?{enum:{hex:y}}:{enum:parseInt(y,16)};if(d=="30"||d=="31")return p[l[d]]=h(e),p;if(d=="14"){var m=o(y);return p[l[d]]={str:m},p}else if(d=="1e"){var m=x(y);return p[l[d]]={str:m},p}else if(":0c:12:13:16:17:18:1a:".indexOf(d)!=-1){var m=g(y);return p[l[d]]={str:m},p}else if(d.match(/^8[0-9]$/)){var m=g(y);return m==null|m==""?{tag:{tag:d,explicit:!1,hex:y}}:m.match(/[\x00-\x1F\x7F-\x9F]/)!=null||m.match(/[\u0000-\u001F\u0080â\u009F]/)!=null?{tag:{tag:d,explicit:!1,hex:y}}:{tag:{tag:d,explicit:!1,str:m}}}else if(d.match(/^a[0-9]$/))try{if(!n(y))throw new Error("not encap");return{tag:{tag:d,explicit:!0,obj:r(y)}}}catch{return{tag:{tag:d,explicit:!0,hex:y}}}else{var w=new s.asn1.ASN1Object;w.hV=y;var E=w.getLengthHexFromValue();return{asn1:{tlv:d+E+y}}}}}},ve.isContextTag=function(e,t){e=e.toLowerCase();var r,n;try{r=parseInt(e,16)}catch{return-1}if(t===void 0)return(r&192)==128;try{var a=t.match(/^\[[0-9]+\]$/);return a==null||(n=parseInt(t.substr(1,t.length-1),10),n>31)?!1:(r&192)==128&&(r&31)==n}catch{return!1}},ve.isASN1HEX=function(e){var t=ve;if(e.length%2==1)return!1;var r=t.getVblen(e,0),n=e.substr(0,2),a=t.getL(e,0),i=e.length-n.length-a.length;return i==r*2},ve.checkStrictDER=function(e,t,r,n,a){var i=ve;if(r===void 0){if(typeof e!="string")throw new Error("not hex string");if(e=e.toLowerCase(),!s.lang.String.isHex(e))throw new Error("not hex string");r=e.length,n=e.length/2,n<128?a=1:a=Math.ceil(n.toString(16))+1}var u=i.getL(e,t);if(u.length>a*2)throw new Error("L of TLV too long: idx="+t);var f=i.getVblen(e,t);if(f>n)throw new Error("value of L too long than hex: idx="+t);var v=i.getTLV(e,t),c=v.length-2-i.getL(e,t).length;if(c!==f*2)throw new Error("V string length and L's value not the same:"+c+"/"+f*2);if(t===0&&e.length!=v.length)throw new Error("total length and TLV length unmatch:"+e.length+"!="+v.length);var g=e.substr(t,2);if(g==="02"){var x=i.getVidx(e,t);if(e.substr(x,2)=="00"&&e.charCodeAt(x+2)<56)throw new Error("not least zeros for DER INTEGER")}if(parseInt(g,16)&32){for(var o=i.getVblen(e,t),l=0,h=i.getChildIdx(e,t),d=0;d<h.length;d++){var p=i.getTLV(e,h[d]);l+=p.length,i.checkStrictDER(e,h[d],r,n,a)}if(o*2!=l)throw new Error("sum of children's TLV length and L unmatch: "+o*2+"!="+l)}},ve.oidname=function(e){var t=s.asn1;s.lang.String.isHex(e)&&(e=t.ASN1Util.oidHexToInt(e));var r=t.x509.OID.oid2name(e);return r===""&&(r=e),r},(typeof s>"u"||!s)&&(s={}),(typeof s.asn1>"u"||!s.asn1)&&(s.asn1={}),(typeof s.asn1.x509>"u"||!s.asn1.x509)&&(s.asn1.x509={}),s.asn1.x509.Certificate=function(e){s.asn1.x509.Certificate.superclass.constructor.call(this);var t=s,r=t.asn1,n=r.DERBitString,a=r.DERSequence,i=r.x509,u=i.TBSCertificate,f=i.AlgorithmIdentifier;this.params=void 0,this.setByParam=function(v){this.params=v},this.sign=function(){var v=this.params,c=v.sigalg;v.sigalg.name!=null&&(c=v.sigalg.name);var g=v.tbsobj.tohex(),x=new s.crypto.Signature({alg:c});x.init(v.cakey),x.updateHex(g),v.sighex=x.sign()},this.getPEM=function(){return rt(this.tohex(),"CERTIFICATE")},this.tohex=function(){var v=this.params;if((v.tbsobj==null||v.tbsobj==null)&&(v.tbsobj=new u(v)),v.sighex==null&&v.cakey!=null&&this.sign(),v.sighex==null)throw new Error("sighex or cakey parameter not defined");var c=[];c.push(v.tbsobj),c.push(new f({name:v.sigalg})),c.push(new n({hex:"00"+v.sighex}));var g=new a({array:c});return g.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&(this.params=e)},ue(s.asn1.x509.Certificate,s.asn1.ASN1Object),s.asn1.x509.TBSCertificate=function(e){s.asn1.x509.TBSCertificate.superclass.constructor.call(this);var t=s,r=t.asn1,n=r.x509,a=r.DERTaggedObject,i=r.DERInteger,u=r.DERSequence,f=n.AlgorithmIdentifier,v=n.Time,c=n.X500Name,g=n.Extensions,x=n.SubjectPublicKeyInfo;this.params=null,this.setByParam=function(o){this.params=o},this.tohex=function(){var o=[],l=this.params;if(l.version!=null||l.version!=1){var h=2;l.version!=null&&(h=l.version-1);var d=new a({obj:new i({int:h})});o.push(d)}o.push(new i(l.serial)),o.push(new f({name:l.sigalg})),o.push(new c(l.issuer)),o.push(new u({array:[new v(l.notbefore),new v(l.notafter)]})),o.push(new c(l.subject)),o.push(new x(Ae.getKey(l.sbjpubkey))),l.ext!==void 0&&l.ext.length>0&&o.push(new a({tag:"a3",obj:new g(l.ext)}));var p=new s.asn1.DERSequence({array:o});return p.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)},ue(s.asn1.x509.TBSCertificate,s.asn1.ASN1Object),s.asn1.x509.Extensions=function(e){s.asn1.x509.Extensions.superclass.constructor.call(this);var t=s,r=t.asn1,n=r.DERSequence,a=r.x509;this.aParam=[],this.setByParam=function(i){this.aParam=i},this.tohex=function(){for(var i=[],u=0;u<this.aParam.length;u++){var f=this.aParam[u],v=f.extname,c=null;if(f.extn!=null)c=new a.PrivateExtension(f);else if(v=="subjectKeyIdentifier")c=new a.SubjectKeyIdentifier(f);else if(v=="keyUsage")c=new a.KeyUsage(f);else if(v=="subjectAltName")c=new a.SubjectAltName(f);else if(v=="issuerAltName")c=new a.IssuerAltName(f);else if(v=="basicConstraints")c=new a.BasicConstraints(f);else if(v=="nameConstraints")c=new a.NameConstraints(f);else if(v=="cRLDistributionPoints")c=new a.CRLDistributionPoints(f);else if(v=="certificatePolicies")c=new a.CertificatePolicies(f);else if(v=="policyMappings")c=new a.PolicyMappings(f);else if(v=="policyConstraints")c=new a.PolicyConstraints(f);else if(v=="inhibitAnyPolicy")c=new a.InhibitAnyPolicy(f);else if(v=="authorityKeyIdentifier")c=new a.AuthorityKeyIdentifier(f);else if(v=="extKeyUsage")c=new a.ExtKeyUsage(f);else if(v=="authorityInfoAccess")c=new a.AuthorityInfoAccess(f);else if(v=="cRLNumber")c=new a.CRLNumber(f);else if(v=="cRLReason")c=new a.CRLReason(f);else if(v=="ocspNonce")c=new a.OCSPNonce(f);else if(v=="ocspNoCheck")c=new a.OCSPNoCheck(f);else if(v=="adobeTimeStamp")c=new a.AdobeTimeStamp(f);else if(v=="subjectDirectoryAttributes")c=new a.SubjectDirectoryAttributes(f);else throw new Error("extension not supported:"+JSON.stringify(f));c!=null&&i.push(c)}var g=new n({array:i});return g.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.x509.Extensions,s.asn1.ASN1Object),s.asn1.x509.Extension=function(e){s.asn1.x509.Extension.superclass.constructor.call(this);var t=s,r=t.asn1,n=r.DERObjectIdentifier,a=r.DEROctetString;r.DERBitString;var i=r.DERBoolean,u=r.DERSequence;this.tohex=function(){var f=new n({oid:this.oid}),v=new a({hex:this.getExtnValueHex()}),c=new Array;c.push(f),this.critical&&c.push(new i),c.push(v);var g=new u({array:c});return g.tohex()},this.getEncodedHex=function(){return this.tohex()},this.critical=!1,e!==void 0&&e.critical!==void 0&&(this.critical=e.critical)},ue(s.asn1.x509.Extension,s.asn1.ASN1Object),s.asn1.x509.KeyUsage=function(e){s.asn1.x509.KeyUsage.superclass.constructor.call(this,e);var t=Error,r={digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8};this.getExtnValueHex=function(){var n=this.getBinValue();return this.asn1ExtnValue=new s.asn1.DERBitString({bin:n}),this.asn1ExtnValue.tohex()},this.getBinValue=function(){var n=this.params;if(typeof n!="object"||typeof n.names!="object"&&typeof n.bin!="string")throw new t("parameter not yet set");if(n.names!=null)return Dr(n.names,r);if(n.bin!=null)return n.bin;throw new t("parameter not set properly")},this.oid="2.5.29.15",e!==void 0&&(this.params=e)},ue(s.asn1.x509.KeyUsage,s.asn1.x509.Extension),s.asn1.x509.BasicConstraints=function(e){s.asn1.x509.BasicConstraints.superclass.constructor.call(this,e);var t=s.asn1,r=t.DERBoolean,n=t.DERInteger,a=t.DERSequence;this.getExtnValueHex=function(){var i=new Array;this.cA&&i.push(new r),this.pathLen>-1&&i.push(new n({int:this.pathLen}));var u=new a({array:i});return this.asn1ExtnValue=u,this.asn1ExtnValue.tohex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,e!==void 0&&(e.cA!==void 0&&(this.cA=e.cA),e.pathLen!==void 0&&(this.pathLen=e.pathLen))},ue(s.asn1.x509.BasicConstraints,s.asn1.x509.Extension),s.asn1.x509.CRLDistributionPoints=function(e){s.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,e);var t=s,r=t.asn1,n=r.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.setByDPArray=function(a){for(var i=[],u=0;u<a.length;u++)if(a[u]instanceof s.asn1.ASN1Object)i.push(a[u]);else{var f=new n.DistributionPoint(a[u]);i.push(f)}this.asn1ExtnValue=new r.DERSequence({array:i})},this.setByOneURI=function(a){var i=new n.DistributionPoint({fulluri:a});this.setByDPArray([i])},this.oid="2.5.29.31",e!==void 0&&(e.array!==void 0?this.setByDPArray(e.array):e.uri!==void 0&&this.setByOneURI(e.uri))},ue(s.asn1.x509.CRLDistributionPoints,s.asn1.x509.Extension),s.asn1.x509.DistributionPoint=function(e){s.asn1.x509.DistributionPoint.superclass.constructor.call(this);var t=s,r=t.asn1,n=r.x509.DistributionPointName;this.tohex=function(){var a=new r.DERSequence;if(this.asn1DP!=null){var i=new r.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});a.appendASN1Object(i)}return this.hTLV=a.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(e.dpobj!==void 0?this.asn1DP=e.dpobj:e.dpname!==void 0?this.asn1DP=new n(e.dpname):e.fulluri!==void 0&&(this.asn1DP=new n({full:[{uri:e.fulluri}]})))},ue(s.asn1.x509.DistributionPoint,s.asn1.ASN1Object),s.asn1.x509.DistributionPointName=function(e){s.asn1.x509.DistributionPointName.superclass.constructor.call(this);var t=s,r=t.asn1,n=r.DERTaggedObject;if(this.tohex=function(){if(this.type!="full")throw new Error("currently type shall be 'full': "+this.type);return this.asn1Obj=new n({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0)if(r.x509.GeneralNames.prototype.isPrototypeOf(e))this.type="full",this.tag="a0",this.asn1V=e;else if(e.full!==void 0)this.type="full",this.tag="a0",this.asn1V=new r.x509.GeneralNames(e.full);else throw new Error("This class supports GeneralNames only as argument")},ue(s.asn1.x509.DistributionPointName,s.asn1.ASN1Object),s.asn1.x509.CertificatePolicies=function(e){s.asn1.x509.CertificatePolicies.superclass.constructor.call(this,e);var t=s,r=t.asn1,n=r.x509,a=r.DERSequence,i=n.PolicyInformation;this.params=null,this.getExtnValueHex=function(){for(var u=[],f=0;f<this.params.array.length;f++)u.push(new i(this.params.array[f]));var v=new a({array:u});return this.asn1ExtnValue=v,this.asn1ExtnValue.tohex()},this.oid="2.5.29.32",e!==void 0&&(this.params=e)},ue(s.asn1.x509.CertificatePolicies,s.asn1.x509.Extension),s.asn1.x509.PolicyInformation=function(e){s.asn1.x509.PolicyInformation.superclass.constructor.call(this,e);var t=s.asn1,r=t.DERSequence,n=t.DERObjectIdentifier,a=t.x509.PolicyQualifierInfo;this.params=null,this.tohex=function(){if(this.params.policyoid===void 0&&this.params.array===void 0)throw new Error("parameter oid and array missing");var i=[new n(this.params.policyoid)];if(this.params.array!==void 0){for(var u=[],f=0;f<this.params.array.length;f++)u.push(new a(this.params.array[f]));u.length>0&&i.push(new r({array:u}))}var v=new r({array:i});return v.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(this.params=e)},ue(s.asn1.x509.PolicyInformation,s.asn1.ASN1Object),s.asn1.x509.PolicyQualifierInfo=function(e){s.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,e);var t=s.asn1,r=t.DERSequence,n=t.DERIA5String,a=t.DERObjectIdentifier,i=t.x509.UserNotice;this.params=null,this.tohex=function(){if(this.params.cps!==void 0){var u=new r({array:[new a({oid:"1.3.6.1.5.5.7.2.1"}),new n({str:this.params.cps})]});return u.tohex()}if(this.params.unotice!=null){var u=new r({array:[new a({oid:"1.3.6.1.5.5.7.2.2"}),new i(this.params.unotice)]});return u.tohex()}},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(this.params=e)},ue(s.asn1.x509.PolicyQualifierInfo,s.asn1.ASN1Object),s.asn1.x509.UserNotice=function(e){s.asn1.x509.UserNotice.superclass.constructor.call(this,e);var t=s.asn1.DERSequence;s.asn1.DERInteger;var r=s.asn1.x509.DisplayText,n=s.asn1.x509.NoticeReference;this.params=null,this.tohex=function(){var a=[];this.params.noticeref!==void 0&&a.push(new n(this.params.noticeref)),this.params.exptext!==void 0&&a.push(new r(this.params.exptext));var i=new t({array:a});return i.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(this.params=e)},ue(s.asn1.x509.UserNotice,s.asn1.ASN1Object),s.asn1.x509.NoticeReference=function(e){s.asn1.x509.NoticeReference.superclass.constructor.call(this,e);var t=s.asn1.DERSequence,r=s.asn1.DERInteger,n=s.asn1.x509.DisplayText;this.params=null,this.tohex=function(){var a=[];if(this.params.org!==void 0&&a.push(new n(this.params.org)),this.params.noticenum!==void 0){for(var i=[],u=this.params.noticenum,f=0;f<u.length;f++)i.push(new r(u[f]));a.push(new t({array:i}))}if(a.length==0)throw new Error("parameter is empty");var v=new t({array:a});return v.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(this.params=e)},ue(s.asn1.x509.NoticeReference,s.asn1.ASN1Object),s.asn1.x509.DisplayText=function(e){s.asn1.x509.DisplayText.superclass.constructor.call(this,e),this.hT="0c",e!==void 0&&(e.type==="ia5"?this.hT="16":e.type==="vis"?this.hT="1a":e.type==="bmp"&&(this.hT="1e"))},ue(s.asn1.x509.DisplayText,s.asn1.DERAbstractString),s.asn1.x509.PolicyMappings=function(e){s.asn1.x509.PolicyMappings.superclass.constructor.call(this,e);var t=s,r=t.asn1;r.x509;var n=r.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){for(var a=this.params,i=[],u=0;u<a.array.length;u++){var f=a.array[u];i.push({seq:[{oid:f[0]},{oid:f[1]}]})}return this.asn1ExtnValue=n({seq:i}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.33",e!==void 0&&(this.params=e)},ue(s.asn1.x509.PolicyMappings,s.asn1.x509.Extension),s.asn1.x509.PolicyConstraints=function(e){s.asn1.x509.PolicyConstraints.superclass.constructor.call(this,e);var t=s,r=t.asn1;r.x509;var n=r.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){var a=this.params,i=[];return a.reqexp!=null&&i.push({tag:{tagi:"80",obj:{int:a.reqexp}}}),a.inhibit!=null&&i.push({tag:{tagi:"81",obj:{int:a.inhibit}}}),this.asn1ExtnValue=n({seq:i}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.36",e!==void 0&&(this.params=e)},ue(s.asn1.x509.PolicyConstraints,s.asn1.x509.Extension),s.asn1.x509.InhibitAnyPolicy=function(e){s.asn1.x509.InhibitAnyPolicy.superclass.constructor.call(this,e);var t=s,r=t.asn1;r.x509;var n=r.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=n({int:this.params.skip}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.54",e!==void 0&&(this.params=e)},ue(s.asn1.x509.InhibitAnyPolicy,s.asn1.x509.Extension),s.asn1.x509.NameConstraints=function(e){s.asn1.x509.NameConstraints.superclass.constructor.call(this,e);var t=s,r=t.asn1,n=r.x509,a=r.ASN1Util.newObject,i=n.GeneralSubtree;this.params=null,this.getExtnValueHex=function(){var u=this.params,f=[];if(u.permit!=null&&u.permit.length!=null){for(var v=[],c=0;c<u.permit.length;c++)v.push(new i(u.permit[c]));f.push({tag:{tagi:"a0",obj:{seq:v}}})}if(u.exclude!=null&&u.exclude.length!=null){for(var g=[],c=0;c<u.exclude.length;c++)g.push(new i(u.exclude[c]));f.push({tag:{tagi:"a1",obj:{seq:g}}})}return this.asn1ExtnValue=a({seq:f}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.30",e!==void 0&&(this.params=e)},ue(s.asn1.x509.NameConstraints,s.asn1.x509.Extension),s.asn1.x509.GeneralSubtree=function(e){s.asn1.x509.GeneralSubtree.superclass.constructor.call(this);var t=s.asn1,r=t.x509,n=r.GeneralName,a=t.ASN1Util.newObject;this.params=null,this.setByParam=function(i){this.params=i},this.tohex=function(){var i=this.params,u=[new n(i)];i.min!=null&&u.push({tag:{tagi:"80",obj:{int:i.min}}}),i.max!=null&&u.push({tag:{tagi:"81",obj:{int:i.max}}});var f=a({seq:u});return f.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)},ue(s.asn1.x509.GeneralSubtree,s.asn1.ASN1Object),s.asn1.x509.ExtKeyUsage=function(e){s.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,e);var t=s,r=t.asn1;this.setPurposeArray=function(n){this.asn1ExtnValue=new r.DERSequence;for(var a=0;a<n.length;a++){var i=new r.DERObjectIdentifier(n[a]);this.asn1ExtnValue.appendASN1Object(i)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.37",e!==void 0&&e.array!==void 0&&this.setPurposeArray(e.array)},ue(s.asn1.x509.ExtKeyUsage,s.asn1.x509.Extension),s.asn1.x509.AuthorityKeyIdentifier=function(e){s.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,e);var t=s,r=t.asn1,n=r.DERTaggedObject,a=r.x509.GeneralNames;t.crypto.Util.isKey,this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var i=new Array;this.asn1KID&&i.push(new n({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&i.push(new n({explicit:!1,tag:"a1",obj:new a([{dn:this.asn1CertIssuer}])})),this.asn1CertSN&&i.push(new n({explicit:!1,tag:"82",obj:this.asn1CertSN}));var u=new r.DERSequence({array:i});return this.asn1ExtnValue=u,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(i){if(i.str!==void 0||i.hex!==void 0)this.asn1KID=new s.asn1.DEROctetString(i);else if(typeof i=="object"&&s.crypto.Util.isKey(i)||typeof i=="string"&&i.indexOf("BEGIN ")!=-1){var u=i;typeof i=="string"&&(u=Ae.getKey(i));var f=Ae.getKeyID(u);this.asn1KID=new s.asn1.DEROctetString({hex:f})}},this.setCertIssuerByParam=function(i){i.str!==void 0||i.ldapstr!==void 0||i.hex!==void 0||i.certsubject!==void 0||i.certissuer!==void 0?this.asn1CertIssuer=new s.asn1.x509.X500Name(i):typeof i=="string"&&i.indexOf("BEGIN ")!=-1&&i.indexOf("CERTIFICATE")!=-1&&(this.asn1CertIssuer=new s.asn1.x509.X500Name({certissuer:i}))},this.setCertSNByParam=function(i){if(i.str!==void 0||i.bigint!==void 0||i.hex!==void 0)this.asn1CertSN=new s.asn1.DERInteger(i);else if(typeof i=="string"&&i.indexOf("BEGIN ")!=-1&&i.indexOf("CERTIFICATE")){var u=new be;u.readCertPEM(i);var f=u.getSerialNumberHex();this.asn1CertSN=new s.asn1.DERInteger({hex:f})}},this.oid="2.5.29.35",e!==void 0&&(e.kid!==void 0&&this.setKIDByParam(e.kid),e.issuer!==void 0&&this.setCertIssuerByParam(e.issuer),e.sn!==void 0&&this.setCertSNByParam(e.sn),e.issuersn!==void 0&&typeof e.issuersn=="string"&&e.issuersn.indexOf("BEGIN ")!=-1&&e.issuersn.indexOf("CERTIFICATE")&&(this.setCertSNByParam(e.issuersn),this.setCertIssuerByParam(e.issuersn)))},ue(s.asn1.x509.AuthorityKeyIdentifier,s.asn1.x509.Extension),s.asn1.x509.SubjectKeyIdentifier=function(e){s.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,e);var t=s,r=t.asn1,n=r.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(a){if(a.str!==void 0||a.hex!==void 0)this.asn1KID=new n(a);else if(typeof a=="object"&&s.crypto.Util.isKey(a)||typeof a=="string"&&a.indexOf("BEGIN")!=-1){var i=a;typeof a=="string"&&(i=Ae.getKey(a));var u=Ae.getKeyID(i);this.asn1KID=new s.asn1.DEROctetString({hex:u})}},this.oid="2.5.29.14",e!==void 0&&e.kid!==void 0&&this.setKIDByParam(e.kid)},ue(s.asn1.x509.SubjectKeyIdentifier,s.asn1.x509.Extension),s.asn1.x509.AuthorityInfoAccess=function(e){s.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,e),this.setAccessDescriptionArray=function(t){for(var r=new Array,n=s,a=n.asn1,i=a.DERSequence,u=a.DERObjectIdentifier,f=a.x509.GeneralName,v=0;v<t.length;v++){var c,g=t[v];if(g.ocsp!==void 0)c=new i({array:[new u({oid:"1.3.6.1.5.5.7.48.1"}),new f({uri:g.ocsp})]});else if(g.caissuer!==void 0)c=new i({array:[new u({oid:"1.3.6.1.5.5.7.48.2"}),new f({uri:g.caissuer})]});else throw new Error("unknown AccessMethod parameter: "+JSON.stringify(g));r.push(c)}this.asn1ExtnValue=new i({array:r})},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.1.1",e!==void 0&&e.array!==void 0&&this.setAccessDescriptionArray(e.array)},ue(s.asn1.x509.AuthorityInfoAccess,s.asn1.x509.Extension),s.asn1.x509.SubjectAltName=function(e){s.asn1.x509.SubjectAltName.superclass.constructor.call(this,e),this.setNameArray=function(t){this.asn1ExtnValue=new s.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.17",e!==void 0&&e.array!==void 0&&this.setNameArray(e.array)},ue(s.asn1.x509.SubjectAltName,s.asn1.x509.Extension),s.asn1.x509.IssuerAltName=function(e){s.asn1.x509.IssuerAltName.superclass.constructor.call(this,e),this.setNameArray=function(t){this.asn1ExtnValue=new s.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.18",e!==void 0&&e.array!==void 0&&this.setNameArray(e.array)},ue(s.asn1.x509.IssuerAltName,s.asn1.x509.Extension),s.asn1.x509.SubjectDirectoryAttributes=function(e){s.asn1.x509.SubjectDirectoryAttributes.superclass.constructor.call(this,e);var t=s.asn1,r=t.DERSequence,n=t.ASN1Util.newObject,a=t.x509.OID.name2oid;this.params=null,this.getExtnValueHex=function(){for(var i=[],u=0;u<this.params.array.length;u++){var f=this.params.array[u];if(f.attr!=null&&f.array!=null){var v={seq:[{oid:f.attr},{set:f.array}]};i.push(n(v));continue}var c={seq:[{oid:"1.2.3.4"},{set:[{utf8str:"DE"}]}]};if(f.attr=="dateOfBirth")c.seq[0].oid=a(f.attr),c.seq[1].set[0]={gentime:f.str};else if(f.attr=="placeOfBirth")c.seq[0].oid=a(f.attr),c.seq[1].set[0]={utf8str:f.str};else if(f.attr=="gender")c.seq[0].oid=a(f.attr),c.seq[1].set[0]={prnstr:f.str};else if(f.attr=="countryOfCitizenship")c.seq[0].oid=a(f.attr),c.seq[1].set[0]={prnstr:f.str};else if(f.attr=="countryOfResidence")c.seq[0].oid=a(f.attr),c.seq[1].set[0]={prnstr:f.str};else throw new Error("unsupported attribute: "+f.attr);i.push(new n(c))}var g=new r({array:i});return this.asn1ExtnValue=g,this.asn1ExtnValue.tohex()},this.oid="2.5.29.9",e!==void 0&&(this.params=e)},ue(s.asn1.x509.SubjectDirectoryAttributes,s.asn1.x509.Extension),s.asn1.x509.PrivateExtension=function(e){s.asn1.x509.PrivateExtension.superclass.constructor.call(this,e);var t=s,r=t.lang.String.isHex,n=t.asn1,a=n.x509.OID.name2oid,i=n.ASN1Util.newObject;this.params=null,this.setByParam=function(u){this.oid=a(u.extname),this.params=u},this.getExtnValueHex=function(){if(this.params.extname==null||this.params.extn==null)throw new Error("extname or extnhex not specified");var u=this.params.extn;if(typeof u=="string"&&r(u))return u;if(typeof u=="object")try{return i(u).tohex()}catch{}throw new Error("unsupported extn value")},e!=null&&this.setByParam(e)},ue(s.asn1.x509.PrivateExtension,s.asn1.x509.Extension),s.asn1.x509.CRL=function(e){s.asn1.x509.CRL.superclass.constructor.call(this);var t=s,r=t.asn1,n=r.DERSequence,a=r.DERBitString,i=r.x509,u=i.AlgorithmIdentifier,f=i.TBSCertList;this.params=void 0,this.setByParam=function(v){this.params=v},this.sign=function(){var v=new f(this.params).tohex(),c=new s.crypto.Signature({alg:this.params.sigalg});c.init(this.params.cakey),c.updateHex(v);var g=c.sign();this.params.sighex=g},this.getPEM=function(){return rt(this.tohex(),"X509 CRL")},this.tohex=function(){var v=this.params;if(v.tbsobj==null&&(v.tbsobj=new f(v)),v.sighex==null&&v.cakey!=null&&this.sign(),v.sighex==null)throw new Error("sighex or cakey parameter not defined");var c=[];c.push(v.tbsobj),c.push(new u({name:v.sigalg})),c.push(new a({hex:"00"+v.sighex}));var g=new n({array:c});return g.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&(this.params=e)},ue(s.asn1.x509.CRL,s.asn1.ASN1Object),s.asn1.x509.TBSCertList=function(e){s.asn1.x509.TBSCertList.superclass.constructor.call(this);var t=s,r=t.asn1,n=r.DERInteger,a=r.DERSequence,i=r.DERTaggedObject;r.DERObjectIdentifier;var u=r.x509,f=u.AlgorithmIdentifier,v=u.Time,c=u.Extensions,g=u.X500Name;this.params=null,this.setByParam=function(x){this.params=x},this.getRevCertSequence=function(){for(var x=[],o=this.params.revcert,l=0;l<o.length;l++){var h=[new n(o[l].sn),new v(o[l].date)];o[l].ext!=null&&h.push(new c(o[l].ext)),x.push(new a({array:h}))}return new a({array:x})},this.tohex=function(){var x=[],o=this.params;if(o.version!=null){var l=o.version-1,h=new n({int:l});x.push(h)}if(x.push(new f({name:o.sigalg})),x.push(new g(o.issuer)),x.push(new v(o.thisupdate)),o.nextupdate!=null&&x.push(new v(o.nextupdate)),o.revcert!=null&&x.push(this.getRevCertSequence()),o.ext!=null){var d=new c(o.ext);x.push(new i({tag:"a0",explicit:!0,obj:d}))}var p=new a({array:x});return p.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)},ue(s.asn1.x509.TBSCertList,s.asn1.ASN1Object),s.asn1.x509.CRLEntry=function(e){s.asn1.x509.CRLEntry.superclass.constructor.call(this);var t=s,r=t.asn1;this.setCertSerial=function(n){this.sn=new r.DERInteger(n)},this.setRevocationDate=function(n){this.time=new r.x509.Time(n)},this.tohex=function(){var n=new r.DERSequence({array:[this.sn,this.time]});return this.TLV=n.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(e.time!==void 0&&this.setRevocationDate(e.time),e.sn!==void 0&&this.setCertSerial(e.sn))},ue(s.asn1.x509.CRLEntry,s.asn1.ASN1Object),s.asn1.x509.CRLNumber=function(e){s.asn1.x509.CRLNumber.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new s.asn1.DERInteger(this.params.num),this.asn1ExtnValue.tohex()},this.oid="2.5.29.20",e!=null&&(this.params=e)},ue(s.asn1.x509.CRLNumber,s.asn1.x509.Extension),s.asn1.x509.CRLReason=function(e){s.asn1.x509.CRLReason.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new s.asn1.DEREnumerated(this.params.code),this.asn1ExtnValue.tohex()},this.oid="2.5.29.21",e!=null&&(this.params=e)},ue(s.asn1.x509.CRLReason,s.asn1.x509.Extension),s.asn1.x509.OCSPNonce=function(e){s.asn1.x509.OCSPNonce.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new s.asn1.DEROctetString(this.params),this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.2",e!=null&&(this.params=e)},ue(s.asn1.x509.OCSPNonce,s.asn1.x509.Extension),s.asn1.x509.OCSPNoCheck=function(e){s.asn1.x509.OCSPNoCheck.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new s.asn1.DERNull,this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.5",e!=null&&(this.params=e)},ue(s.asn1.x509.OCSPNoCheck,s.asn1.x509.Extension),s.asn1.x509.AdobeTimeStamp=function(e){s.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this,e);var t=s,r=t.asn1,n=r.DERInteger,a=r.DERBoolean,i=r.DERSequence,u=r.x509.GeneralName;this.params=null,this.getExtnValueHex=function(){var f=this.params,v=[new n(1)];return v.push(new u({uri:f.uri})),f.reqauth!=null&&v.push(new a(f.reqauth)),this.asn1ExtnValue=new i({array:v}),this.asn1ExtnValue.tohex()},this.oid="1.2.840.113583.1.1.9.1",e!==void 0&&this.setByParam(e)},ue(s.asn1.x509.AdobeTimeStamp,s.asn1.x509.Extension),s.asn1.x509.X500Name=function(e){s.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var t=s,r=t.asn1,n=r.x509,a=n.RDN;this.setByString=function(i,u){u!==void 0&&(this.sRule=u);var f=i.split("/");f.shift();for(var v=[],c=0;c<f.length;c++)if(f[c].match(/^[^=]+=.+$/))v.push(f[c]);else{var g=v.length-1;v[g]=v[g]+"/"+f[c]}for(var c=0;c<v.length;c++)this.asn1Array.push(new a({str:v[c],rule:this.sRule}))},this.setByLdapString=function(i,u){u!==void 0&&(this.sRule=u);var f=n.X500Name.ldapToCompat(i);this.setByString(f,u)},this.setByObject=function(i,u){u!==void 0&&(this.sRule=u);for(var f in i)if(i.hasOwnProperty(f)){var v=new a({str:f+"="+i[f],rule:this.sRule});this.asn1Array?this.asn1Array.push(v):this.asn1Array=[v]}},this.setByParam=function(i){if(i.rule!==void 0&&(this.sRule=i.rule),i.array!==void 0)this.paramArray=i.array;else if(i.str!==void 0)this.setByString(i.str);else if(i.ldapstr!==void 0)this.setByLdapString(i.ldapstr);else if(i.hex!==void 0)this.hTLV=i.hex;else if(i.certissuer!==void 0){var u=new be;u.readCertPEM(i.certissuer),this.hTLV=u.getIssuerHex()}else if(i.certsubject!==void 0){var u=new be;u.readCertPEM(i.certsubject),this.hTLV=u.getSubjectHex()}else typeof i=="object"&&i.certsubject===void 0&&i.certissuer===void 0&&this.setByObject(i)},this.tohex=function(){if(typeof this.hTLV=="string")return this.hTLV;if(this.asn1Array.length==0&&this.paramArray.length>0)for(var i=0;i<this.paramArray.length;i++){var u={array:this.paramArray[i]};this.sRule!="utf8"&&(u.rule=this.sRule);var f=new a(u);this.asn1Array.push(f)}var v=new r.DERSequence({array:this.asn1Array});return this.hTLV=v.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)},ue(s.asn1.x509.X500Name,s.asn1.ASN1Object),s.asn1.x509.X500Name.compatToLDAP=function(e){if(e.substr(0,1)!=="/")throw"malformed input";e=e.substr(1);var t=e.split("/");return t.reverse(),t=t.map(function(r){return r.replace(/,/,"\\,")}),t.join(",")},s.asn1.x509.X500Name.onelineToLDAP=function(e){return s.asn1.x509.X500Name.compatToLDAP(e)},s.asn1.x509.X500Name.ldapToCompat=function(e){for(var t=e.split(","),r=!1,n=[],a=0;t.length>0;a++){var i=t.shift();if(r===!0){var u=n.pop(),f=(u+","+i).replace(/\\,/g,",");n.push(f),r=!1}else n.push(i);i.substr(-1,1)==="\\"&&(r=!0)}return n=n.map(function(v){return v.replace("/","\\/")}),n.reverse(),"/"+n.join("/")},s.asn1.x509.X500Name.ldapToOneline=function(e){return s.asn1.x509.X500Name.ldapToCompat(e)},s.asn1.x509.RDN=function(e){s.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var t=s.asn1.x509.AttributeTypeAndValue;this.setByParam=function(r){r.rule!==void 0&&(this.sRule=r.rule),r.str!==void 0&&this.addByMultiValuedString(r.str),r.array!==void 0&&(this.paramArray=r.array)},this.addByString=function(r){this.asn1Array.push(new s.asn1.x509.AttributeTypeAndValue({str:r,rule:this.sRule}))},this.addByMultiValuedString=function(r){for(var n=s.asn1.x509.RDN.parseString(r),a=0;a<n.length;a++)this.addByString(n[a])},this.tohex=function(){if(this.asn1Array.length==0&&this.paramArray.length>0)for(var r=0;r<this.paramArray.length;r++){var n=this.paramArray[r];n.rule!==void 0&&this.sRule!="utf8"&&(n.rule=this.sRule);var a=new t(n);this.asn1Array.push(a)}var i=new s.asn1.DERSet({array:this.asn1Array});return this.TLV=i.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)},ue(s.asn1.x509.RDN,s.asn1.ASN1Object),s.asn1.x509.RDN.parseString=function(e){for(var t=e.split(/\+/),r=!1,n=[],a=0;t.length>0;a++){var i=t.shift();if(r===!0){var u=n.pop(),f=(u+"+"+i).replace(/\\\+/g,"+");n.push(f),r=!1}else n.push(i);i.substr(-1,1)==="\\"&&(r=!0)}for(var v=!1,c=[],a=0;n.length>0;a++){var i=n.shift();if(v===!0){var g=c.pop();if(i.match(/"$/)){var f=(g+"+"+i).replace(/^([^=]+)="(.*)"$/,"$1=$2");c.push(f),v=!1}else c.push(g+"+"+i)}else c.push(i);i.match(/^[^=]+="/)&&(v=!0)}return c},s.asn1.x509.AttributeTypeAndValue=function(e){s.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this),this.sRule="utf8",this.sType=null,this.sValue=null,this.dsType=null;var t=s,r=t.asn1,n=r.DERSequence,a=r.DERUTF8String,i=r.DERPrintableString,u=r.DERTeletexString,f=r.DERIA5String,v=r.DERVisibleString,c=r.DERBMPString,g=t.lang.String.isMail,x=t.lang.String.isPrintable;this.setByParam=function(o){if(o.rule!==void 0&&(this.sRule=o.rule),o.ds!==void 0&&(this.dsType=o.ds),o.value===void 0&&o.str!==void 0){var l=o.str,h=l.match(/^([^=]+)=(.+)$/);if(h)this.sType=h[1],this.sValue=h[2];else throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)}else this.sType=o.type,this.sValue=o.value},this.setByString=function(o,l){l!==void 0&&(this.sRule=l);var h=o.match(/^([^=]+)=(.+)$/);if(h)this.setByAttrTypeAndValueStr(h[1],h[2]);else throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)},this._getDsType=function(){var o=this.sType,l=this.sValue,h=this.sRule;return h==="prn"?o=="CN"&&g(l)?"ia5":x(l)?"prn":"utf8":h==="utf8"?o=="CN"&&g(l)?"ia5":o=="C"?"prn":"utf8":"utf8"},this.setByAttrTypeAndValueStr=function(o,l,h){h!==void 0&&(this.sRule=h),this.sType=o,this.sValue=l},this.getValueObj=function(o,l){if(o=="utf8")return new a({str:l});if(o=="prn")return new i({str:l});if(o=="tel")return new u({str:l});if(o=="ia5")return new f({str:l});if(o=="vis")return new v({str:l});if(o=="bmp")return new c({str:l});throw new Error("unsupported directory string type: type="+o+" value="+l)},this.tohex=function(){this.dsType==null&&(this.dsType=this._getDsType());var o=s.asn1.x509.OID.atype2obj(this.sType),l=this.getValueObj(this.dsType,this.sValue),h=new n({array:[o,l]});return this.TLV=h.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)},ue(s.asn1.x509.AttributeTypeAndValue,s.asn1.ASN1Object),s.asn1.x509.SubjectPublicKeyInfo=function(e){s.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var t=s,r=t.asn1,n=r.DERInteger,a=r.DERBitString,i=r.DERObjectIdentifier,u=r.DERSequence,f=r.ASN1Util.newObject,v=r.x509,c=v.AlgorithmIdentifier,g=t.crypto;g.ECDSA,g.DSA,this.getASN1Object=function(){if(this.asn1AlgId==null||this.asn1SubjPKey==null)throw"algId and/or subjPubKey not set";var x=new u({array:[this.asn1AlgId,this.asn1SubjPKey]});return x},this.tohex=function(){var x=this.getASN1Object();return this.hTLV=x.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.setPubKey=function(x){try{if(x instanceof we){var o=f({seq:[{int:{bigint:x.n}},{int:{int:x.e}}]}),l=o.tohex();this.asn1AlgId=new c({name:"rsaEncryption"}),this.asn1SubjPKey=new a({hex:"00"+l})}}catch{}try{if(x instanceof s.crypto.ECDSA){var h=new i({name:x.curveName});this.asn1AlgId=new c({name:"ecPublicKey",asn1params:h}),this.asn1SubjPKey=new a({hex:"00"+x.pubKeyHex})}}catch{}try{if(x instanceof s.crypto.DSA){var h=new f({seq:[{int:{bigint:x.p}},{int:{bigint:x.q}},{int:{bigint:x.g}}]});this.asn1AlgId=new c({name:"dsa",asn1params:h});var d=new n({bigint:x.y});this.asn1SubjPKey=new a({hex:"00"+d.tohex()})}}catch{}},e!==void 0&&this.setPubKey(e)},ue(s.asn1.x509.SubjectPublicKeyInfo,s.asn1.ASN1Object),s.asn1.x509.Time=function(e){s.asn1.x509.Time.superclass.constructor.call(this);var t=s,r=t.asn1,n=r.DERUTCTime,a=r.DERGeneralizedTime;this.params=null,this.type=null,this.setTimeParams=function(i){this.timeParams=i},this.setByParam=function(i){this.params=i},this.getType=function(i){return i.match(/^[0-9]{12}Z$/)?"utc":i.match(/^[0-9]{14}Z$/)?"gen":i.match(/^[0-9]{12}\.[0-9]+Z$/)?"utc":i.match(/^[0-9]{14}\.[0-9]+Z$/)?"gen":null},this.tohex=function(){var i=this.params,u=null;if(typeof i=="string"&&(i={str:i}),i!=null&&i.str&&(i.type==null||i.type==null)&&(i.type=this.getType(i.str)),i!=null&&i.str?(i.type=="utc"&&(u=new n(i.str)),i.type=="gen"&&(u=new a(i.str))):this.type=="gen"?u=new a:u=new n,u==null)throw new Error("wrong setting for Time");return this.TLV=u.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},s.asn1.x509.Time_bak=function(e){s.asn1.x509.Time_bak.superclass.constructor.call(this);var t=s,r=t.asn1,n=r.DERUTCTime,a=r.DERGeneralizedTime;this.setTimeParams=function(i){this.timeParams=i},this.tohex=function(){var i=null;return this.timeParams!=null?this.type=="utc"?i=new n(this.timeParams):i=new a(this.timeParams):this.type=="utc"?i=new n:i=new a,this.TLV=i.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},this.type="utc",e!==void 0&&(e.type!==void 0?this.type=e.type:e.str!==void 0&&(e.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),e.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=e)},ue(s.asn1.x509.Time,s.asn1.ASN1Object),s.asn1.x509.AlgorithmIdentifier=function(e){s.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var t=s,r=t.asn1,n=r.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;if(this.tohex=function(){if(this.nameAlg===null&&this.asn1Alg===null)throw new Error("algorithm not specified");if(this.nameAlg!==null){var i=null;for(var u in n)u===this.nameAlg&&(i=n[u]);if(i!==null)return this.hTLV=i,this.hTLV}this.nameAlg!==null&&this.asn1Alg===null&&(this.asn1Alg=r.x509.OID.name2obj(this.nameAlg));var f=[this.asn1Alg];this.asn1Params!==null&&f.push(this.asn1Params);var v=new r.DERSequence({array:f});return this.hTLV=v.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(e.name!==void 0&&(this.nameAlg=e.name),e.asn1params!==void 0&&(this.asn1Params=e.asn1params),e.paramempty!==void 0&&(this.paramEmpty=e.paramempty)),this.asn1Params===null&&this.paramEmpty===!1&&this.nameAlg!==null){this.nameAlg.name!==void 0&&(this.nameAlg=this.nameAlg.name);var a=this.nameAlg.toLowerCase();a.substr(-7,7)!=="withdsa"&&a.substr(-9,9)!=="withecdsa"&&(this.asn1Params=new r.DERNull)}},ue(s.asn1.x509.AlgorithmIdentifier,s.asn1.ASN1Object),s.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"},s.asn1.x509.GeneralName=function(e){s.asn1.x509.GeneralName.superclass.constructor.call(this);var t=s,r=t.asn1,n=r.x509,a=n.X500Name,i=n.OtherName,u=r.DERIA5String;r.DERPrintableString;var f=r.DEROctetString,v=r.DERTaggedObject,c=r.ASN1Object,g=Error;this.params=null,this.setByParam=function(x){this.params=x},this.tohex=function(){var x=this.params,o,h,l,h=!1;if(x.other!==void 0)o="a0",l=new i(x.other);else if(x.rfc822!==void 0)o="81",l=new u({str:x.rfc822});else if(x.dns!==void 0)o="82",l=new u({str:x.dns});else if(x.dn!==void 0)o="a4",h=!0,typeof x.dn=="string"?l=new a({str:x.dn}):x.dn instanceof s.asn1.x509.X500Name?l=x.dn:l=new a(x.dn);else if(x.ldapdn!==void 0)o="a4",h=!0,l=new a({ldapstr:x.ldapdn});else if(x.certissuer!==void 0||x.certsubj!==void 0){o="a4",h=!0;var d,p,y=null;if(x.certsubj!==void 0?(d=!1,p=x.certsubj):(d=!0,p=x.certissuer),p.match(/^[0-9A-Fa-f]+$/),p.indexOf("-----BEGIN ")!=-1&&(y=ze(p)),y==null)throw new Error("certsubj/certissuer not cert");var I=new be;I.hex=y;var K;d?K=I.getIssuerHex():K=I.getSubjectHex(),l=new c,l.hTLV=K}else if(x.uri!==void 0)o="86",l=new u({str:x.uri});else if(x.ip!==void 0){o="87";var L,W=x.ip;try{if(W.match(/^[0-9a-f]+$/)){var m=W.length;if(m==8||m==16||m==32||m==64)L=W;else throw"err"}else L=Pn(W)}catch(E){throw new g("malformed IP address: "+x.ip+":"+E.message)}l=new f({hex:L})}else throw new g("improper params");var w=new v({tag:o,explicit:h,obj:l});return w.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)},ue(s.asn1.x509.GeneralName,s.asn1.ASN1Object),s.asn1.x509.GeneralNames=function(e){s.asn1.x509.GeneralNames.superclass.constructor.call(this);var t=s,r=t.asn1;this.setByParamArray=function(n){for(var a=0;a<n.length;a++){var i=new r.x509.GeneralName(n[a]);this.asn1Array.push(i)}},this.tohex=function(){var n=new r.DERSequence({array:this.asn1Array});return n.tohex()},this.getEncodedHex=function(){return this.tohex()},this.asn1Array=new Array,typeof e<"u"&&this.setByParamArray(e)},ue(s.asn1.x509.GeneralNames,s.asn1.ASN1Object),s.asn1.x509.OtherName=function(e){s.asn1.x509.OtherName.superclass.constructor.call(this);var t=s,r=t.asn1,n=r.DERObjectIdentifier,a=r.DERSequence,i=r.ASN1Util.newObject;this.params=null,this.setByParam=function(u){this.params=u},this.tohex=function(){var u=this.params;if(u.oid==null||u.value==null)throw new Error("oid or value not specified");var f=new n({oid:u.oid}),v=i({tag:{tag:"a0",explicit:!0,obj:u.value}}),c=new a({array:[f,v]});return c.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)},ue(s.asn1.x509.OtherName,s.asn1.ASN1Object),s.asn1.x509.OID=new function(){var e=s.asn1.DERObjectIdentifier;this.name2oidList={"aes128-CBC":"2.16.840.1.101.3.4.1.2","aes256-CBC":"2.16.840.1.101.3.4.1.42",sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",hmacWithSHA1:"1.2.840.113549.2.7",hmacWithSHA224:"1.2.840.113549.2.8",hmacWithSHA256:"1.2.840.113549.2.9",hmacWithSHA384:"1.2.840.113549.2.10",hmacWithSHA512:"1.2.840.113549.2.11",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",policyMappings:"2.5.29.33",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",inhibitAnyPolicy:"2.5.29.54",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",smtpUTF8Mailbox:"1.3.6.1.5.5.7.8.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",secp521r1:"1.3.132.0.35",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1",smimeMailboxLegacy:"2.23.140.1.5.1.1",smimeMailboxMulti:"2.23.140.1.5.1.2",smimeMailboxStrict:"2.23.140.1.5.1.3",smimeOrganizationLegacy:"2.23.140.1.5.2.1",smimeOrganizationMulti:"2.23.140.1.5.2.2",smimeOrganizationStrict:"2.23.140.1.5.2.3",smimeSponsorLegacy:"2.23.140.1.5.3.1",smimeSponsorMulti:"2.23.140.1.5.3.2",smimeSponsorStrict:"2.23.140.1.5.3.3",smimeIndividualLegacy:"2.23.140.1.5.4.1",smimeIndividualMulti:"2.23.140.1.5.4.2",smimeIndividualStrict:"2.23.140.1.5.4.3"},this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",GN:"2.5.4.42",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.objCache={},this.name2obj=function(t){if(typeof this.objCache[t]<"u")return this.objCache[t];if(typeof this.name2oidList[t]>"u")throw"Name of ObjectIdentifier not defined: "+t;var r=this.name2oidList[t],n=new e({oid:r});return this.objCache[t]=n,n},this.atype2obj=function(t){if(this.objCache[t]!==void 0)return this.objCache[t];var r;if(t.match(/^\d+\.\d+\.[0-9.]+$/))r=t;else if(this.atype2oidList[t]!==void 0)r=this.atype2oidList[t];else if(this.name2oidList[t]!==void 0)r=this.name2oidList[t];else throw new Error("AttributeType name undefined: "+t);var n=new e({oid:r});return this.objCache[t]=n,n},this.registerOIDs=function(t){if(this.checkOIDs(t))for(var r in t)this.name2oidList[r]=t[r]},this.checkOIDs=function(t){try{var r=Object.keys(t);return r.length==0?!1:(r.map(function(n,a,i){var u=this[n];if(!u.match(/^[0-2]\.[0-9.]+$/))throw new Error("value is not OID")},t),!0)}catch{return!1}}},s.asn1.x509.OID.oid2name=function(e){var t=s.asn1.x509.OID.name2oidList;for(var r in t)if(t[r]==e)return r;return""},s.asn1.x509.OID.oid2atype=function(e){var t=s.asn1.x509.OID.atype2oidList;for(var r in t)if(t[r]==e)return r;return e},s.asn1.x509.OID.name2oid=function(e){if(e.match(/^[0-9.]+$/))return e;var t=s.asn1.x509.OID.name2oidList;return t[e]===void 0?"":t[e]},s.asn1.x509.X509Util={},s.asn1.x509.X509Util.newCertPEM=function(e){var t=s.asn1.x509;t.TBSCertificate;var r=t.Certificate,n=new r(e);return n.getPEM()},(typeof s>"u"||!s)&&(s={}),(typeof s.asn1>"u"||!s.asn1)&&(s.asn1={}),(typeof s.asn1.cms>"u"||!s.asn1.cms)&&(s.asn1.cms={}),s.asn1.cms.Attribute=function(e){var t=Error,r=s,n=r.asn1,a=n.DERSequence,i=n.DERSet,u=n.DERObjectIdentifier;this.params=null,this.typeOid=null,this.setByParam=function(f){this.params=f},this.getValueArray=function(){throw new t("not yet implemented abstract")},this.tohex=function(){var f=new u({oid:this.typeOid}),v=new i({array:this.getValueArray()}),c=new a({array:[f,v]});return c.tohex()},this.getEncodedHex=function(){return this.tohex()}},ue(s.asn1.cms.Attribute,s.asn1.ASN1Object),s.asn1.cms.ContentType=function(e){var t=s,r=t.asn1;r.cms.ContentType.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.3",this.getValueArray=function(){var n=new r.DERObjectIdentifier(this.params.type);return[n]},e!=null&&this.setByParam(e)},ue(s.asn1.cms.ContentType,s.asn1.cms.Attribute),s.asn1.cms.MessageDigest=function(e){var t=s,r=t.asn1,n=r.DEROctetString,a=r.cms;a.MessageDigest.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.4",this.getValueArray=function(){var i=new n(this.params);return[i]},e!=null&&this.setByParam(e)},ue(s.asn1.cms.MessageDigest,s.asn1.cms.Attribute),s.asn1.cms.SigningTime=function(e){var t=s,r=t.asn1;r.cms.SigningTime.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.5",this.getValueArray=function(){var n=new r.x509.Time(this.params);return[n]},e!=null&&this.setByParam(e)},ue(s.asn1.cms.SigningTime,s.asn1.cms.Attribute),s.asn1.cms.SigningCertificate=function(e){var t=Error,r=s,n=r.asn1,a=n.DERSequence,i=n.cms,u=i.ESSCertID;r.crypto,i.SigningCertificate.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.12",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new t("parameter 'array' not specified");for(var f=this.params.array,v=[],c=0;c<f.length;c++){var g=f[c];e.hasis==!1&&typeof g=="string"&&(g.indexOf("-----BEGIN")!=-1||ve.isASN1HEX(g))&&(g={cert:g}),g.hasis!=!1&&e.hasis==!1&&(g.hasis=!1),v.push(new u(g))}var x=new a({array:v}),o=new a({array:[x]});return[o]},e!=null&&this.setByParam(e)},ue(s.asn1.cms.SigningCertificate,s.asn1.cms.Attribute),s.asn1.cms.ESSCertID=function(e){s.asn1.cms.ESSCertID.superclass.constructor.call(this);var t=Error,r=s,n=r.asn1,a=n.DEROctetString,i=n.DERSequence,u=n.cms.IssuerSerial;this.params=null,this.getCertHash=function(f,v){if(f.hash!=null)return f.hash;if(typeof f=="string"&&f.indexOf("-----BEGIN")==-1&&!ve.isASN1HEX(f))return f;var c;if(typeof f=="string")c=f;else if(f.cert!=null)c=f.cert;else throw new t("hash nor cert unspecified");var g;c.indexOf("-----BEGIN")!=-1?g=ze(c):g=c,typeof f=="string"&&(f.indexOf("-----BEGIN")!=-1?g=ze(f):ve.isASN1HEX(f)&&(g=f));var x;if(f.alg!=null)x=f.alg;else if(v!=null)x=v;else throw new t("hash alg unspecified");return r.crypto.Util.hashHex(g,x)},this.tohex=function(){var f=this.params,v=this.getCertHash(f,"sha1"),c=[];c.push(new a({hex:v})),(typeof f=="string"&&f.indexOf("-----BEGIN")!=-1||f.cert!=null&&f.hasis!=!1||f.issuer!=null&&f.serial!=null)&&c.push(new u(f));var g=new i({array:c});return g.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.cms.ESSCertID,s.asn1.ASN1Object),s.asn1.cms.SigningCertificateV2=function(e){var t=Error,r=s,n=r.asn1,a=n.DERSequence;n.x509;var i=n.cms,u=i.ESSCertIDv2;r.crypto,i.SigningCertificateV2.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.47",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new t("parameter 'array' not specified");for(var f=this.params.array,v=[],c=0;c<f.length;c++){var g=f[c];(e.alg!=null||e.hasis==!1)&&typeof g=="string"&&(g.indexOf("-----BEGIN")!=-1||ve.isASN1HEX(g))&&(g={cert:g}),g.alg==null&&e.alg!=null&&(g.alg=e.alg),g.hasis!=!1&&e.hasis==!1&&(g.hasis=!1),v.push(new u(g))}var x=new a({array:v}),o=new a({array:[x]});return[o]},e!=null&&this.setByParam(e)},ue(s.asn1.cms.SigningCertificateV2,s.asn1.cms.Attribute),s.asn1.cms.ESSCertIDv2=function(e){s.asn1.cms.ESSCertIDv2.superclass.constructor.call(this);var t=s,r=t.asn1,n=r.DEROctetString,a=r.DERSequence,i=r.cms.IssuerSerial,u=r.x509.AlgorithmIdentifier;this.params=null,this.tohex=function(){var f=this.params,v=this.getCertHash(f,"sha256"),c=[];f.alg!=null&&f.alg!="sha256"&&c.push(new u({name:f.alg})),c.push(new n({hex:v})),(typeof f=="string"&&f.indexOf("-----BEGIN")!=-1||f.cert!=null&&f.hasis!=!1||f.issuer!=null&&f.serial!=null)&&c.push(new i(f));var g=new a({array:c});return g.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.cms.ESSCertIDv2,s.asn1.cms.ESSCertID),s.asn1.cms.IssuerSerial=function(e){var t=Error,r=s,n=r.asn1,a=n.DERInteger,i=n.DERSequence,u=n.cms,f=n.x509,v=f.GeneralNames,c=be;u.IssuerSerial.superclass.constructor.call(this),this.setByParam=function(g){this.params=g},this.tohex=function(){var g=this.params,x,o;if(typeof g=="string"&&g.indexOf("-----BEGIN")!=-1||g.cert!=null){var l;g.cert!=null?l=g.cert:l=g;var h=new c;h.readCertPEM(l),x=h.getIssuer(),o={hex:h.getSerialNumberHex()}}else if(g.issuer!=null&&g.serial)x=g.issuer,o=g.serial;else throw new t("cert or issuer and serial parameter not specified");var d=new v([{dn:x}]),p=new a(o),y=new i({array:[d,p]});return y.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.cms.IssuerSerial,s.asn1.ASN1Object),s.asn1.cms.SignerIdentifier=function(e){var t=s,r=t.asn1;r.DERInteger,r.DERSequence;var n=r.cms,a=n.IssuerAndSerialNumber,i=n.SubjectKeyIdentifier,u=r.x509;u.X500Name,n.SignerIdentifier.superclass.constructor.call(this),this.params=null,this.tohex=function(){var f=this.params;if(f.type=="isssn"){var v=new a(f);return v.tohex()}else if(f.type=="skid"){var c=new i(f);return c.tohex()}else throw new Error("wrong property for isssn or skid")},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.cms.SignerIdentifier,s.asn1.ASN1Object),s.asn1.cms.IssuerAndSerialNumber=function(e){var t=s,r=t.asn1,n=r.DERInteger,a=r.DERSequence,i=r.cms,u=r.x509,f=u.X500Name,v=be,c=Error;i.IssuerAndSerialNumber.superclass.constructor.call(this),this.params=null,this.tohex=function(){var g=this.params,x,o;if(typeof g=="string"&&g.indexOf("-----BEGIN")!=-1||g.cert!=null){var l;g.cert!=null?l=g.cert:l=g;var h=new v;h.readCertPEM(l),x=h.getIssuer(),o={hex:h.getSerialNumberHex()}}else if(g.issuer!=null&&g.serial)x=g.issuer,o=g.serial;else throw new c("cert or issuer and serial parameter not specified");var d=new f(x),p=new n(o),y=new a({array:[d,p]});return y.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(g){this.params=g},e!=null&&this.setByParam(e)},ue(s.asn1.cms.IssuerAndSerialNumber,s.asn1.ASN1Object),s.asn1.cms.SubjectKeyIdentifier=function(e){var t=s,r=t.asn1;r.DERInteger,r.DERSequence;var n=r.ASN1Util.newObject,a=r.cms;a.IssuerAndSerialName,a.SubjectKeyIdentifier;var i=r.x509;i.X500Name;var u=be,f=Error;a.SubjectKeyIdentifier.superclass.constructor.call(this),this.tohex=function(){var v=this.params;if(v.cert==null&&v.skid==null)throw new f("property cert nor skid undefined");var c;if(v.cert!=null){var g=new u(v.cert),x=g.getExtSubjectKeyIdentifier();c=x.kid.hex}else v.skid!=null&&(c=v.skid);var o=n({tag:{tage:"a0",obj:{octstr:{hex:c}}}});return o.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.cms.SubjectKeyIdentifier,s.asn1.ASN1Object),s.asn1.cms.AttributeList=function(e){var t=Error,r=s,n=r.asn1,a=n.DERSet,i=n.cms;i.AttributeList.superclass.constructor.call(this),this.params=null,this.hTLV=null,this.setByParam=function(u){this.params=u},this.tohex=function(){var u=this.params;if(this.hTLV!=null)return this.hTLV;var f=!0;u.sortflag!=null&&(f=u.sortflag);for(var v=u.array,c=[],g=0;g<v.length;g++){var x=v[g],o=x.attr;if(o=="contentType")c.push(new i.ContentType(x));else if(o=="messageDigest")c.push(new i.MessageDigest(x));else if(o=="signingTime")c.push(new i.SigningTime(x));else if(o=="signingCertificate")c.push(new i.SigningCertificate(x));else if(o=="signingCertificateV2")c.push(new i.SigningCertificateV2(x));else if(o=="signaturePolicyIdentifier")c.push(new s.asn1.cades.SignaturePolicyIdentifier(x));else if(o=="signatureTimeStamp"||o=="timeStampToken")c.push(new s.asn1.cades.SignatureTimeStamp(x));else throw new t("unknown attr: "+o)}var l=new a({array:c,sortflag:f});return this.hTLV=l.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.cms.AttributeList,s.asn1.ASN1Object),s.asn1.cms.SignerInfo=function(e){var t=Error,r=s,n=r.asn1,a=n.DERInteger,i=n.DEROctetString,u=n.DERSequence,f=n.DERTaggedObject,v=n.cms,c=v.SignerIdentifier,g=v.AttributeList;v.ContentType,v.EncapsulatedContentInfo,v.MessageDigest,v.SignedData;var x=n.x509,o=x.AlgorithmIdentifier,l=r.crypto,h=Ae;v.SignerInfo.superclass.constructor.call(this),this.params=null,this.sign=function(){var d=this.params,p=d.sigalg,y=new g(d.sattrs).tohex(),I=h.getKey(d.signkey),K=new l.Signature({alg:p});K.init(I),K.updateHex(y);var L=K.sign();d.sighex=L},this.tohex=function(){var d=this.params,p=[];if(p.push(new a({int:d.version})),p.push(new c(d.id)),p.push(new o({name:d.hashalg})),d.sattrs!=null){var y=new g(d.sattrs);try{p.push(new f({tag:"a0",explicit:!1,obj:y}))}catch(K){throw new t("si sattr error: "+K)}}if(d.sigalgfield!=null?p.push(new o({name:d.sigalgfield})):p.push(new o({name:d.sigalg})),d.sighex==null&&d.signkey!=null&&this.sign(),p.push(new i({hex:d.sighex})),d.uattrs!=null){var y=new g(d.uattrs);try{p.push(new f({tag:"a1",explicit:!1,obj:y}))}catch(L){throw new t("si uattr error: "+L)}}var I=new u({array:p});return I.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.cms.SignerInfo,s.asn1.ASN1Object),s.asn1.cms.EncapsulatedContentInfo=function(e){var t=s,r=t.asn1,n=r.DERTaggedObject,a=r.DERSequence,i=r.DERObjectIdentifier,u=r.DEROctetString,f=r.cms;f.EncapsulatedContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var v=this.params,c=[];if(c.push(new i(v.type)),v.content!=null&&(v.content.hex!=null||v.content.str!=null)&&v.isDetached!=!0){var g=new u(v.content),x=new n({tag:"a0",explicit:!0,obj:g});c.push(x)}var o=new a({array:c});return o.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(v){this.params=v},e!=null&&this.setByParam(e)},ue(s.asn1.cms.EncapsulatedContentInfo,s.asn1.ASN1Object),s.asn1.cms.ContentInfo=function(e){var t=s,r=t.asn1,n=r.DERTaggedObject,a=r.DERSequence,i=r.DERObjectIdentifier,u=r.x509;u.OID.name2obj,s.asn1.cms.ContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var f=this.params,v=[];v.push(new i(f.type));var c=new n({tag:"a0",explicit:!0,obj:f.obj});v.push(c);var g=new a({array:v});return g.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(f){this.params=f},e!=null&&this.setByParam(e)},ue(s.asn1.cms.ContentInfo,s.asn1.ASN1Object),s.asn1.cms.SignedData=function(e){var t=s,r=t.asn1;r.ASN1Object;var n=r.DERInteger,a=r.DERSet,i=r.DERSequence;r.DERTaggedObject;var u=r.cms,f=u.EncapsulatedContentInfo,v=u.SignerInfo,c=u.ContentInfo,g=u.CertificateSet,x=u.RevocationInfoChoices,o=r.x509,l=o.AlgorithmIdentifier;s.asn1.cms.SignedData.superclass.constructor.call(this),this.params=null,this.checkAndFixParam=function(){var h=this.params;this._setDigestAlgs(h),this._setContentTypeByEContent(h),this._setMessageDigestByEContent(h),this._setSignerInfoVersion(h),this._setSignedDataVersion(h)},this._setDigestAlgs=function(h){for(var d={},p=h.sinfos,y=0;y<p.length;y++){var I=p[y];d[I.hashalg]=1}h.hashalgs=Object.keys(d).sort()},this._setContentTypeByEContent=function(h){for(var d=h.econtent.type,p=h.sinfos,y=0;y<p.length;y++){var I=p[y],K=this._getAttrParamByName(I,"contentType");K.type=d}},this._setMessageDigestByEContent=function(h){var d=h.econtent;h.econtent.type;var p=d.content.hex;p==null&&d.type=="data"&&d.content.str!=null&&(p=bt(d.content.str));for(var y=h.sinfos,I=0;I<y.length;I++){var K=y[I],L=K.hashalg,W=this._getAttrParamByName(K,"messageDigest"),m=s.crypto.Util.hashHex(p,L);W.hex=m}},this._getAttrParamByName=function(h,d){for(var p=h.sattrs.array,y=0;y<p.length;y++)if(p[y].attr==d)return p[y]},this._setSignerInfoVersion=function(h){for(var d=h.sinfos,p=0;p<d.length;p++){var y=d[p],I=1;y.id.type=="skid"&&(I=3),y.version=I}},this._setSignedDataVersion=function(h){var d=this._getSignedDataVersion(h);h.version=d},this._getSignedDataVersion=function(h){if(h.revinfos!=null)for(var d=h.revinfos,p=0;p<d.length;p++){var y=d[p];if(y.ocsp!=null)return 5}for(var I=h.sinfos,p=0;p<I.length;p++){var K=h.sinfos[p];if(K.version==3)return 3}return h.econtent.type!="data"?3:1},this.tohex=function(){var h=this.params;this.getEncodedHexPrepare!=null&&this.getEncodedHexPrepare(),h.fixed!=!0&&this.checkAndFixParam();var d=[];d.push(new n({int:h.version}));for(var p=[],y=0;y<h.hashalgs.length;y++){var I=h.hashalgs[y];p.push(new l({name:I}))}d.push(new a({array:p})),d.push(new f(h.econtent)),h.certs!=null&&d.push(new g(h.certs)),h.revinfos!=null&&d.push(new x(h.revinfos));for(var K=[],y=0;y<h.sinfos.length;y++){var L=h.sinfos[y];K.push(new v(L))}d.push(new a({array:K}));var W=new i({array:d});return W.tohex()},this.getEncodedHex=function(){return this.tohex()},this.getContentInfo=function(){var h=new c({type:"signed-data",obj:this});return h},this.getContentInfoEncodedHex=function(){return this.getContentInfo().tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.cms.SignedData,s.asn1.ASN1Object),s.asn1.cms.CertificateSet=function(e){s.asn1.cms.CertificateSet.superclass.constructor.call(this);var t=Error,r=s.asn1,n=r.DERTaggedObject,a=r.DERSet,i=r.ASN1Object;this.params=null,this.tohex=function(){var u=this.params,f=[],v;if(u instanceof Array)v=u;else if(u.array!=null)v=u.array;else throw new t("cert array not specified");for(var c=0;c<v.length;c++){var g=v[c],x=ze(g),o=new i;o.hTLV=x,f.push(o)}var l={array:f};u.sortflag==!1&&(l.sortflag=!1);var h=new a(l),d=new n({tag:"a0",explicit:!1,obj:h});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.cms.CertificateSet,s.asn1.ASN1Object),s.asn1.cms.RevocationInfoChoices=function(e){s.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this),this.params=null,this.tohex=function(){var t=this.params;if(!t instanceof Array)throw new Error("params is not array");for(var r=[],n=0;n<t.length;n++)r.push(new s.asn1.cms.RevocationInfoChoice(t[n]));var a=s.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:r}}});return a.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.cms.RevocationInfoChoices,s.asn1.ASN1Object),s.asn1.cms.RevocationInfoChoice=function(e){s.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this),this.params=null,this.tohex=function(){var t=this.params;if(t.crl!=null&&typeof t.crl=="string"){var r=t.crl;return t.crl.indexOf("-----BEGIN")!=-1&&(r=ze(t.crl)),r}else if(t.ocsp!=null){var n=s.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new s.asn1.cms.OtherRevocationFormat(t)}});return n.tohex()}else throw new Error("property crl or ocsp undefined")},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.cms.RevocationInfoChoice,s.asn1.ASN1Object),s.asn1.cms.OtherRevocationFormat=function(e){s.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this);var t=Error,r=s,n=r.asn1,a=n.ASN1Util.newObject,i=r.lang.String.isHex;this.params=null,this.tohex=function(){var u=this.params;if(u.ocsp==null)throw new t("property ocsp not specified");if(!i(u.ocsp)||!ve.isASN1HEX(u.ocsp))throw new t("ocsp value not ASN.1 hex string");var f=a({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:u.ocsp}}]});return f.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.cms.OtherRevocationFormat,s.asn1.ASN1Object),s.asn1.cms.CMSUtil=new function(){},s.asn1.cms.CMSUtil.newSignedData=function(e){return new s.asn1.cms.SignedData(e)},s.asn1.cms.CMSUtil.verifySignedData=function(e){var t=s,r=t.asn1,n=r.cms;n.SignerInfo,n.SignedData,n.SigningTime,n.SigningCertificate,n.SigningCertificateV2;var a=r.cades;a.SignaturePolicyIdentifier;var i=t.lang.String.isHex,u=ve,f=u.getVbyList,v=u.getTLVbyList,c=u.getIdxbyList,g=u.getChildIdx,x=u.getTLV,o=u.oidname,l=t.crypto.Util.hashHex;e.cms===void 0&&i(e.cms);var h=e.cms,d=function(E,S){for(var P,U=3;U<6;U++)if(P=c(E,0,[1,0,U]),P!==void 0){var X=E.substr(P,2);X==="a0"&&(S.certsIdx=P),X==="a1"&&(S.revinfosIdx=P),X==="31"&&(S.signerinfosIdx=P)}},p=function(E,S){var P=S.signerinfosIdx;if(P!==void 0){var U=g(E,P);S.signerInfoIdxList=U;for(var X=0;X<U.length;X++){var fe=U[X],G={idx:fe};y(E,G),S.signerInfos.push(G)}}},y=function(E,S){var P=S.idx;S.signerid_issuer1=v(E,P,[1,0],"30"),S.signerid_serial1=f(E,P,[1,1],"02"),S.hashalg=o(f(E,P,[2,0],"06"));var U=c(E,P,[3],"a0");S.idxSignedAttrs=U,I(E,S,U);var X=g(E,P),fe=X.length;if(fe<6)throw"malformed SignerInfo";S.sigalg=o(f(E,P,[fe-2,0],"06")),S.sigval=f(E,P,[fe-1],"04")},I=function(E,S,P){var U=g(E,P);S.signedAttrIdxList=U;for(var X=0;X<U.length;X++){var fe=U[X],G=f(E,fe,[0],"06"),ee;G==="2a864886f70d010905"?(ee=He(f(E,fe,[1,0])),S.saSigningTime=ee):G==="2a864886f70d010904"&&(ee=f(E,fe,[1,0],"04"),S.saMessageDigest=ee)}},K=function(E,S){if(f(E,0,[0],"06")!=="2a864886f70d010702")return S;S.cmsType="signedData",S.econtent=f(E,0,[1,0,2,1,0]),d(E,S),S.signerInfos=[],p(E,S)},L=function(E,S){for(var P=S.parse.signerInfos,U=P.length,X=!0,fe=0;fe<U;fe++){var G=P[fe];m(E,S,G),G.isValid||(X=!1)}S.isValid=X},W=function(E,S,P,U){var X=S.parse.certsIdx,fe;if(S.certs===void 0){fe=[],S.certkeys=[];for(var G=g(E,X),ee=0;ee<G.length;ee++){var he=x(E,G[ee]),le=new be;le.readCertHex(he),fe[ee]=le,S.certkeys[ee]=le.getPublicKey()}S.certs=fe}else fe=S.certs;S.cccc=fe.length,S.cccci=G.length;for(var ee=0;ee<fe.length;ee++){var nt=le.getIssuerHex(),Le=le.getSerialNumberHex();P.signerid_issuer1===nt&&P.signerid_serial1===Le&&(P.certkey_idx=ee)}},m=function(E,S,P,U){P.verifyDetail={};var X=P.verifyDetail,fe=S.parse.econtent,G=P.hashalg,ee=P.saMessageDigest;X.validMessageDigest=!1,l(fe,G)===ee&&(X.validMessageDigest=!0),W(E,S,P),X.validSignatureValue=!1;var he=P.sigalg,le="31"+x(E,P.idxSignedAttrs).substr(2);P.signedattrshex=le;var nt=S.certs[P.certkey_idx].getPublicKey(),Le=new s.crypto.Signature({alg:he});Le.init(nt),Le.updateHex(le);var je=Le.verify(P.sigval);X.validSignatureValue_isValid=je,je===!0&&(X.validSignatureValue=!0),P.isValid=!1,X.validMessageDigest&&X.validSignatureValue&&(P.isValid=!0)},w={isValid:!1,parse:{}};return K(h,w.parse),L(h,w),w},s.asn1.cms.CMSParser=function(){var e=Error,t=be,r=new t,n=ve,a=n.getV,i=n.getTLV;n.getIdxbyList;var u=n.getTLVbyList,f=n.getTLVbyListEx,v=n.getVbyList,c=n.getVbyListEx,g=n.getChildIdx;this.getCMSSignedData=function(x){var o=u(x,0,[1,0]),l=this.getSignedData(o);return l},this.getSignedData=function(x){var o=g(x,0),l={},h=a(x,o[0]),d=parseInt(h,16);l.version=d;var p=i(x,o[1]);l.hashalgs=this.getHashAlgArray(p);var y=i(x,o[2]);l.econtent=this.getEContent(y);var I=f(x,0,["[0]"]);I!=null&&(l.certs=this.getCertificateSet(I)),f(x,0,["[1]"]);var K=f(x,0,[3]);return l.sinfos=this.getSignerInfos(K),l},this.getHashAlgArray=function(x){for(var o=g(x,0),l=new t,h=[],d=0;d<o.length;d++){var p=i(x,o[d]),y=l.getAlgorithmIdentifierName(p);h.push(y)}return h},this.getEContent=function(x){var o={},l=v(x,0,[0]),h=v(x,0,[1,0]);return o.type=s.asn1.x509.OID.oid2name(ve.hextooidstr(l)),o.content={hex:h},o},this.getSignerInfos=function(x){for(var o=[],l=g(x,0),h=0;h<l.length;h++){var d=i(x,l[h]),p=this.getSignerInfo(d);o.push(p)}return o},this.getSignerInfo=function(x){var o={},l=g(x,0),h=n.getInt(x,l[0],-1);h!=-1&&(o.version=h);var d=i(x,l[1]),p=this.getIssuerAndSerialNumber(d);o.id=p;var y=i(x,l[2]),I=r.getAlgorithmIdentifierName(y);o.hashalg=I;var K=f(x,0,["[0]"]);if(K!=null){var L=this.getAttributeList(K);o.sattrs=L}var W=f(x,0,[3]),m=r.getAlgorithmIdentifierName(W);o.sigalg=m;var w=c(x,0,[4]);o.sighex=w;var E=f(x,0,["[1]"]);if(E!=null){var S=this.getAttributeList(E);o.uattrs=S}return o},this.getSignerIdentifier=function(x){if(x.substr(0,2)=="30")return this.getIssuerAndSerialNumber(x);throw new Error("SKID of signerIdentifier not supported")},this.getIssuerAndSerialNumber=function(x){var o={type:"isssn"},l=g(x,0),h=i(x,l[0]);o.issuer=r.getX500Name(h);var d=a(x,l[1]);return o.serial={hex:d},o},this.getAttributeList=function(x){for(var o=[],l=g(x,0),h=0;h<l.length;h++){var d=i(x,l[h]),p=this.getAttribute(d);o.push(p)}return{array:o}},this.getAttribute=function(x){var o={},l=g(x,0),h=n.getOID(x,l[0]),d=s.asn1.x509.OID.oid2name(h);o.attr=d;var p=i(x,l[1]),y=g(p,0);if(y.length==1)o.valhex=i(p,y[0]);else{for(var I=[],K=0;K<y.length;K++)I.push(i(p,y[K]));o.valhex=I}return d=="contentType"?this.setContentType(o):d=="messageDigest"?this.setMessageDigest(o):d=="signingTime"?this.setSigningTime(o):d=="signingCertificate"?this.setSigningCertificate(o):d=="signingCertificateV2"?this.setSigningCertificateV2(o):d=="signaturePolicyIdentifier"&&this.setSignaturePolicyIdentifier(o),o},this.setContentType=function(x){var o=n.getOIDName(x.valhex,0,null);o!=null&&(x.type=o,delete x.valhex)},this.setSigningTime=function(x){var o=a(x.valhex,0),l=He(o);x.str=l,delete x.valhex},this.setMessageDigest=function(x){var o=a(x.valhex,0);x.hex=o,delete x.valhex},this.setSigningCertificate=function(x){var o=g(x.valhex,0);if(o.length>0){for(var l=i(x.valhex,o[0]),h=g(l,0),d=[],p=0;p<h.length;p++){var y=i(l,h[p]),I=this.getESSCertID(y);d.push(I)}x.array=d}if(o.length>1){var K=i(x.valhex,o[1]);x.polhex=K}delete x.valhex},this.setSignaturePolicyIdentifier=function(x){var o=g(x.valhex,0);if(o.length>0){var l=n.getOID(x.valhex,o[0]);x.oid=l}if(o.length>1){var h=new t,d=g(x.valhex,o[1]),p=i(x.valhex,d[0]),y=h.getAlgorithmIdentifierName(p);x.alg=y;var I=a(x.valhex,d[1]);x.hash=I}delete x.valhex},this.setSigningCertificateV2=function(x){var o=g(x.valhex,0);if(o.length>0){for(var l=i(x.valhex,o[0]),h=g(l,0),d=[],p=0;p<h.length;p++){var y=i(l,h[p]),I=this.getESSCertIDv2(y);d.push(I)}x.array=d}if(o.length>1){var K=i(x.valhex,o[1]);x.polhex=K}delete x.valhex},this.getESSCertID=function(x){var o={},l=g(x,0);if(l.length>0){var h=a(x,l[0]);o.hash=h}if(l.length>1){var d=i(x,l[1]),p=this.getIssuerSerial(d);p.serial!=null&&(o.serial=p.serial),p.issuer!=null&&(o.issuer=p.issuer)}return o},this.getESSCertIDv2=function(x){var o={},l=g(x,0);if(l.length<1||3<l.length)throw new e("wrong number of elements");var h=0;if(x.substr(l[0],2)=="30"){var d=i(x,l[0]);o.alg=r.getAlgorithmIdentifierName(d),h++}else o.alg="sha256";var p=a(x,l[h]);if(o.hash=p,l.length>h+1){var y=i(x,l[h+1]),I=this.getIssuerSerial(y);o.issuer=I.issuer,o.serial=I.serial}return o},this.getIssuerSerial=function(x){var o={},l=g(x,0),h=i(x,l[0]),d=r.getGeneralNames(h),p=d[0].dn;o.issuer=p;var y=a(x,l[1]);return o.serial={hex:y},o},this.getCertificateSet=function(x){for(var o=g(x,0),l=[],h=0;h<o.length;h++){var d=i(x,o[h]);if(d.substr(0,2)=="30"){var p=rt(d,"CERTIFICATE");l.push(p)}}return{array:l,sortflag:!1}}},(typeof s>"u"||!s)&&(s={}),(typeof s.asn1>"u"||!s.asn1)&&(s.asn1={}),(typeof s.asn1.tsp>"u"||!s.asn1.tsp)&&(s.asn1.tsp={}),s.asn1.tsp.TimeStampToken=function(e){var t=s,r=t.asn1,n=r.tsp;n.TimeStampToken.superclass.constructor.call(this),this.params=null,this.getEncodedHexPrepare=function(){var a=new n.TSTInfo(this.params.econtent.content);this.params.econtent.content.hex=a.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.tsp.TimeStampToken,s.asn1.cms.SignedData),s.asn1.tsp.TSTInfo=function(e){var t=s,r=t.asn1,n=r.DERSequence,a=r.DERInteger,i=r.DERBoolean,u=r.DERGeneralizedTime,f=r.DERObjectIdentifier,v=r.DERTaggedObject,c=r.tsp,g=c.MessageImprint,x=c.Accuracy;r.x509.X500Name;var o=r.x509.GeneralName;if(c.TSTInfo.superclass.constructor.call(this),this.dVersion=new a({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerial=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.tohex=function(){var l=[this.dVersion];if(this.dPolicy==null)throw new Error("policy shall be specified.");if(l.push(this.dPolicy),this.dMessageImprint==null)throw new Error("messageImprint shall be specified.");if(l.push(this.dMessageImprint),this.dSerial==null)throw new Error("serialNumber shall be specified.");if(l.push(this.dSerial),this.dGenTime==null)throw new Error("genTime shall be specified.");l.push(this.dGenTime),this.dAccuracy!=null&&l.push(this.dAccuracy),this.dOrdering!=null&&l.push(this.dOrdering),this.dNonce!=null&&l.push(this.dNonce),this.dTsa!=null&&l.push(this.dTsa);var h=new n({array:l});return this.hTLV=h.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0){if(typeof e.policy=="string"){if(!e.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new f({oid:e.policy})}e.messageImprint!==void 0&&(this.dMessageImprint=new g(e.messageImprint)),e.serial!==void 0&&(this.dSerial=new a(e.serial)),e.genTime!==void 0&&(this.dGenTime=new u(e.genTime)),e.accuracy!==void 0&&(this.dAccuracy=new x(e.accuracy)),e.ordering!==void 0&&e.ordering==!0&&(this.dOrdering=new i),e.nonce!==void 0&&(this.dNonce=new a(e.nonce)),e.tsa!==void 0&&(this.dTsa=new v({tag:"a0",explicit:!0,obj:new o({dn:e.tsa})}))}},ue(s.asn1.tsp.TSTInfo,s.asn1.ASN1Object),s.asn1.tsp.Accuracy=function(e){var t=s,r=t.asn1,n=r.ASN1Util.newObject;r.tsp.Accuracy.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,i=[];return a.seconds!=null&&typeof a.seconds=="number"&&i.push({int:a.seconds}),a.millis!=null&&typeof a.millis=="number"&&i.push({tag:{tagi:"80",obj:{int:a.millis}}}),a.micros!=null&&typeof a.micros=="number"&&i.push({tag:{tagi:"81",obj:{int:a.micros}}}),n({seq:i}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.tsp.Accuracy,s.asn1.ASN1Object),s.asn1.tsp.MessageImprint=function(e){var t=s,r=t.asn1,n=r.DERSequence,a=r.DEROctetString,i=r.x509,u=i.AlgorithmIdentifier;r.tsp.MessageImprint.superclass.constructor.call(this),this.params=null,this.tohex=function(){var f=this.params,v=new u({name:f.alg}),c=new a({hex:f.hash}),g=new n({array:[v,c]});return g.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)},ue(s.asn1.tsp.MessageImprint,s.asn1.ASN1Object),s.asn1.tsp.TimeStampReq=function(e){var t=s,r=t.asn1,n=r.DERSequence,a=r.DERInteger,i=r.DERBoolean;r.ASN1Object;var u=r.DERObjectIdentifier,f=r.tsp,v=f.MessageImprint;f.TimeStampReq.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params,g=[];g.push(new a({int:1})),c.messageImprint instanceof s.asn1.ASN1Object?g.push(c.messageImprint):g.push(new v(c.messageImprint)),c.policy!=null&&g.push(new u(c.policy)),c.nonce!=null&&g.push(new a(c.nonce)),c.certreq==!0&&g.push(new i);var x=new n({array:g});return x.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.tsp.TimeStampReq,s.asn1.ASN1Object),s.asn1.tsp.TimeStampResp=function(e){var t=s,r=t.asn1,n=r.DERSequence;r.ASN1Object;var a=r.tsp,i=a.PKIStatusInfo;a.TimeStampResp.superclass.constructor.call(this),this.params=null,this.tohex=function(){var u=this.params,f=[];if(u.econtent!=null||u.tst!=null)if(u.statusinfo!=null?f.push(new i(u.statusinfo)):f.push(new i("granted")),u.econtent!=null)f.push(new a.TimeStampToken(u).getContentInfo());else if(u.tst instanceof r.ASN1Object)f.push(u.tst);else throw new Error("improper member tst value");else if(u.statusinfo!=null)f.push(new i(u.statusinfo));else throw new Error("parameter for token nor statusinfo not specified");var v=new n({array:f});return v.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.tsp.TimeStampResp,s.asn1.ASN1Object),s.asn1.tsp.PKIStatusInfo=function(e){var t=Error,r=s,n=r.asn1,a=n.DERSequence,i=n.tsp,u=i.PKIStatus,f=i.PKIFreeText,v=i.PKIFailureInfo;i.PKIStatusInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params,g=[];if(typeof c=="string")g.push(new u(c));else{if(c.status==null)throw new t("property 'status' unspecified");g.push(new u(c.status)),c.statusstr!=null&&g.push(new f(c.statusstr)),c.failinfo!=null&&g.push(new v(c.failinfo))}var x=new a({array:g});return x.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.tsp.PKIStatusInfo,s.asn1.ASN1Object),s.asn1.tsp.PKIStatus=function(e){var t=Error,r=s,n=r.asn1,a=n.DERInteger,i=n.tsp;i.PKIStatus.superclass.constructor.call(this);var u={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};this.params=null,this.tohex=function(){var f=this.params,v;if(typeof f=="string")try{v=u[f]}catch{throw new t("undefined name: "+f)}else if(typeof f=="number")v=f;else throw new t("unsupported params");return new a({int:v}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.tsp.PKIStatus,s.asn1.ASN1Object),s.asn1.tsp.PKIFreeText=function(e){var t=Error,r=s,n=r.asn1,a=n.DERSequence,i=n.DERUTF8String,u=n.tsp;u.PKIFreeText.superclass.constructor.call(this),this.params=null,this.tohex=function(){var f=this.params;if(!(f instanceof Array))throw new t("wrong params: not array");for(var v=[],c=0;c<f.length;c++)v.push(new i({str:f[c]}));var g=new a({array:v});return g.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.tsp.PKIFreeText,s.asn1.ASN1Object),s.asn1.tsp.PKIFailureInfo=function(e){var t=Error,r=s,n=r.asn1,a=n.DERBitString,i=n.tsp,u=i.PKIFailureInfo,f={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};u.superclass.constructor.call(this),this.params=null,this.getBinValue=function(){var v=this.params,c=0;if(typeof v=="number"&&0<=v&&v<=25){c|=1<<v;for(var g=c.toString(2),x="",o=g.length-1;o>=0;o--)x+=g[o];return x}else{if(typeof v=="string"&&f[v]!=null)return Dr([v],f);if(typeof v=="object"&&v.length!=null)return Dr(v,f);throw new t("wrong params")}},this.tohex=function(){this.params;var v=this.getBinValue();return new a({bin:v}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.tsp.PKIFailureInfo,s.asn1.ASN1Object),s.asn1.tsp.AbstractTSAAdapter=function(e){this.getTSTHex=function(t,r){throw"not implemented yet"}},s.asn1.tsp.SimpleTSAAdapter=function(e){var t=s,r=t.asn1,n=r.tsp,a=t.crypto.Util.hashHex;n.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(i,u){var f=a(i,u);this.params.econtent.content.messageImprint={alg:u,hash:f},this.params.econtent.content.serial={int:this.serial++};var v=Math.floor(Math.random()*1e9);this.params.econtent.content.nonce={int:v};var c=new n.TimeStampToken(this.params);return c.getContentInfoEncodedHex()},e!==void 0&&(this.params=e)},ue(s.asn1.tsp.SimpleTSAAdapter,s.asn1.tsp.AbstractTSAAdapter),s.asn1.tsp.FixedTSAAdapter=function(e){var t=s,r=t.asn1,n=r.tsp,a=t.crypto.Util.hashHex;n.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(i,u){var f=a(i,u);this.params.econtent.content.messageImprint={alg:u,hash:f};var v=new n.TimeStampToken(this.params);return v.getContentInfoEncodedHex()},e!==void 0&&(this.params=e)},ue(s.asn1.tsp.FixedTSAAdapter,s.asn1.tsp.AbstractTSAAdapter),s.asn1.tsp.TSPUtil=new function(){},s.asn1.tsp.TSPUtil.newTimeStampToken=function(e){return new s.asn1.tsp.TimeStampToken(e)},s.asn1.tsp.TSPUtil.parseTimeStampReq=function(e){var t=new s.asn1.tsp.TSPParser;return t.getTimeStampReq(e)},s.asn1.tsp.TSPUtil.parseMessageImprint=function(e){var t=new s.asn1.tsp.TSPParser;return t.getMessageImprint(e)},s.asn1.tsp.TSPParser=function(){var e=be,t=new e,r=ve,n=r.getV,a=r.getTLV,i=r.getIdxbyList;r.getTLVbyListEx;var u=r.getChildIdx,f=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"],v={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};this.getResponse=function(c){var g=u(c,0);if(g.length==1)return this.getPKIStatusInfo(a(c,g[0]));if(g.length>1){var x=this.getPKIStatusInfo(a(c,g[0])),o=a(c,g[1]),l=this.getToken(o);return l.statusinfo=x,l}},this.getToken=function(c){var g=new s.asn1.cms.CMSParser,x=g.getCMSSignedData(c);return this.setTSTInfo(x),x},this.setTSTInfo=function(c){var g=c.econtent;if(g.type=="tstinfo"){var x=g.content.hex,o=this.getTSTInfo(x);g.content=o}},this.getTSTInfo=function(c){var g={},x=u(c,0),o=n(c,x[1]);g.policy=Ar(o);var l=a(c,x[2]);g.messageImprint=this.getMessageImprint(l);var h=n(c,x[3]);g.serial={hex:h};var d=n(c,x[4]);g.genTime={str:He(d)};var p=0;if(x.length>5&&c.substr(x[5],2)=="30"){var y=a(c,x[5]);g.accuracy=this.getAccuracy(y),p++}if(x.length>5+p&&c.substr(x[5+p],2)=="01"){var I=n(c,x[5+p]);I=="ff"&&(g.ordering=!0),p++}if(x.length>5+p&&c.substr(x[5+p],2)=="02"){var K=n(c,x[5+p]);g.nonce={hex:K},p++}if(x.length>5+p&&c.substr(x[5+p],2)=="a0"){var L=a(c,x[5+p]);L="30"+L.substr(2),pGeneralNames=t.getGeneralNames(L);var W=pGeneralNames[0].dn;g.tsa=W,p++}if(x.length>5+p&&c.substr(x[5+p],2)=="a1"){var m=a(c,x[5+p]);m="30"+m.substr(2);var w=t.getExtParamArray(m);g.ext=w,p++}return g},this.getAccuracy=function(c){for(var g={},x=u(c,0),o=0;o<x.length;o++){var l=c.substr(x[o],2),h=n(c,x[o]),d=parseInt(h,16);l=="02"?g.seconds=d:l=="80"?g.millis=d:l=="81"&&(g.micros=d)}return g},this.getMessageImprint=function(c){if(c.substr(0,2)!="30")throw new Error("head of messageImprint hex shall be x30");var g={};u(c,0);var x=i(c,0,[0,0]),o=n(c,x),l=r.hextooidstr(o),h=s.asn1.x509.OID.oid2name(l);if(h=="")throw new Error("hashAlg name undefined: "+l);var d=h,p=i(c,0,[1]);return g.alg=d,g.hash=n(c,p),g},this.getPKIStatusInfo=function(c){var g={},x=u(c,0),o=0;try{var l=n(c,x[0]),h=parseInt(l,16);g.status=f[h]}catch{}if(x.length>1&&c.substr(x[1],2)=="30"){var d=a(c,x[1]);g.statusstr=this.getPKIFreeText(d),o++}if(x.length>o&&c.substr(x[1+o],2)=="03"){var p=a(c,x[1+o]);g.failinfo=this.getPKIFailureInfo(p)}return g},this.getPKIFreeText=function(c){for(var g=[],x=u(c,0),o=0;o<x.length;o++)g.push(r.getString(c,x[o]));return g},this.getPKIFailureInfo=function(c){var g=r.getInt(c,0);return v[g]!=null?v[g]:g},this.getTimeStampReq=function(c){var g={};g.certreq=!1;var x=u(c,0);if(x.length<2)throw new Error("TimeStampReq must have at least 2 items");var o=a(c,x[1]);g.messageImprint=s.asn1.tsp.TSPUtil.parseMessageImprint(o);for(var l=2;l<x.length;l++){var h=x[l],d=c.substr(h,2);if(d=="06"){var p=n(c,h);g.policy=r.hextooidstr(p)}d=="02"&&(g.nonce=n(c,h)),d=="01"&&(g.certreq=!0)}return g}},(typeof s>"u"||!s)&&(s={}),(typeof s.asn1>"u"||!s.asn1)&&(s.asn1={}),(typeof s.asn1.cades>"u"||!s.asn1.cades)&&(s.asn1.cades={}),s.asn1.cades.SignaturePolicyIdentifier=function(e){var t=s,r=t.asn1,n=r.cades,a=n.SignaturePolicyId;n.SignaturePolicyIdentifier.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.15",this.params=null,this.getValueArray=function(){return[new a(this.params)]},this.setByParam=function(i){this.params=i},e!=null&&this.setByParam(e)},ue(s.asn1.cades.SignaturePolicyIdentifier,s.asn1.cms.Attribute),s.asn1.cades.SignaturePolicyId=function(e){var t=s,r=t.asn1,n=r.DERSequence,a=r.DERObjectIdentifier,i=r.x509;i.AlgorithmIdentifier;var u=r.cades,f=u.SignaturePolicyId,v=u.OtherHashAlgAndValue;f.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params,g=[];g.push(new a(c.oid)),g.push(new v(c));var x=new n({array:g});return x.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(c){this.params=c},e!=null&&this.setByParam(e)},ue(s.asn1.cades.SignaturePolicyId,s.asn1.ASN1Object),s.asn1.cades.OtherHashAlgAndValue=function(e){var t=Error,r=s,n=r.asn1,a=n.DERSequence,i=n.DEROctetString,u=n.x509,f=u.AlgorithmIdentifier,v=n.cades,c=v.OtherHashAlgAndValue;c.superclass.constructor.call(this),this.params=null,this.tohex=function(){var g=this.params;if(g.alg==null)throw new t("property 'alg' not specified");if(g.hash==null&&g.cert==null)throw new t("property 'hash' nor 'cert' not specified");var x=null;if(g.hash!=null)x=g.hash;else if(g.cert!=null){if(typeof g.cert!="string")throw new t("cert not string");var o=g.cert;g.cert.indexOf("-----BEGIN")!=-1&&(o=ze(g.cert)),x=s.crypto.Util.hashHex(o,g.alg)}var l=[];l.push(new f({name:g.alg})),l.push(new i({hex:x}));var h=new a({array:l});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.cades.OtherHashAlgAndValue,s.asn1.ASN1Object),s.asn1.cades.OtherHashValue=function(e){s.asn1.cades.OtherHashValue.superclass.constructor.call(this);var t=Error,r=s;r.lang.String.isHex;var n=r.asn1,a=n.DEROctetString;r.crypto.Util.hashHex,this.params=null,this.tohex=function(){var i=this.params;if(i.hash==null&&i.cert==null)throw new t("hash or cert not specified");var u=null;if(i.hash!=null)u=i.hash;else if(i.cert!=null){if(typeof i.cert!="string")throw new t("cert not string");var f=i.cert;i.cert.indexOf("-----BEGIN")!=-1&&(f=ze(i.cert)),u=s.crypto.Util.hashHex(f,"sha1")}return new a({hex:u}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.cades.OtherHashValue,s.asn1.ASN1Object),s.asn1.cades.SignatureTimeStamp=function(e){var t=Error,r=s,n=r.lang.String.isHex,a=r.asn1,i=a.ASN1Object;a.x509;var u=a.cades;u.SignatureTimeStamp.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.14",this.params=null,this.getValueArray=function(){var f=this.params;if(f.tst!=null)if(n(f.tst)){var v=new i;return v.hTLV=f.tst,[v]}else{if(f.tst instanceof i)return[f.tst];throw new t("params.tst has wrong value")}else if(f.res!=null){var c=f.res;if(c instanceof i&&(c=c.tohex()),typeof c!="string"||!n(c))throw new t("params.res has wrong value");ve.getTLVbyList(c,0,[1]);var v=new i;return v.hTLV=f.tst,[v]}},e!=null&&this.setByParam(e)},ue(s.asn1.cades.SignatureTimeStamp,s.asn1.cms.Attribute),s.asn1.cades.CompleteCertificateRefs=function(e){var t=Error,r=s,n=r.asn1,a=n.DERSequence,i=n.cades,u=i.OtherCertID,f=r.lang.String.isHex;i.CompleteCertificateRefs.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.21",this.params=null,this.getValueArray=function(){for(var v=this.params,c=[],g=0;g<v.array.length;g++){var x=v.array[g];if(typeof x=="string")if(x.indexOf("-----BEGIN")!=-1)x={cert:x};else if(f(x))x={hash:x};else throw new t("unsupported value: "+x);v.alg!=null&&x.alg==null&&(x.alg=v.alg),v.hasis!=null&&x.hasis==null&&(x.hasis=v.hasis);var o=new u(x);c.push(o)}var l=new a({array:c});return[l]},e!=null&&this.setByParam(e)},ue(s.asn1.cades.CompleteCertificateRefs,s.asn1.cms.Attribute),s.asn1.cades.OtherCertID=function(e){var t=s,r=t.asn1,n=r.DERSequence,a=r.cms,i=a.IssuerSerial,u=r.cades,f=u.OtherHashValue,v=u.OtherHashAlgAndValue;u.OtherCertID.superclass.constructor.call(this),this.params=e,this.tohex=function(){var c=this.params;typeof c=="string"&&(c.indexOf("-----BEGIN")!=-1?c={cert:c}:_isHex(c)&&(c={hash:c}));var g=[],x=null;if(c.alg!=null?x=new v(c):x=new f(c),g.push(x),c.cert!=null&&c.hasis==!0||c.issuer!=null&&c.serial!=null){var o=new i(c);g.push(o)}var l=new n({array:g});return l.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.cades.OtherCertID,s.asn1.ASN1Object),s.asn1.cades.OtherHash=function(e){var t=s,r=t.asn1;r.cms;var n=r.cades,a=n.OtherHashAlgAndValue,i=n.OtherHashValue;t.crypto.Util.hashHex;var u=t.lang.String.isHex;n.OtherHash.superclass.constructor.call(this),this.params=null,this.tohex=function(){var f=this.params;typeof f=="string"&&(f.indexOf("-----BEGIN")!=-1?f={cert:f}:u(f)&&(f={hash:f}));var v=null;return f.alg!=null?v=new a(f):v=new i(f),v.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)},ue(s.asn1.cades.OtherHash,s.asn1.ASN1Object),s.asn1.cades.CAdESUtil=new function(){},s.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(e){var t=new s.asn1.cms.CMSParser,r=t.getCMSSignedData(e);return r},s.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(e,t,r){var n=ve,a=n.getChildIdx,i=n.getTLV,u=n.getV,f=s,v=f.asn1,c=v.ASN1Object,g=v.cms,x=g.AttributeList,o=g.SignerInfo,l={},h=a(e,t);if(h.length!=6)throw"not supported items for SignerInfo (!=6)";var d=h.shift();l.version=i(e,d);var p=h.shift();l.si=i(e,p);var y=h.shift();l.digalg=i(e,y);var I=h.shift();l.sattrs=i(e,I);var K=h.shift();l.sigalg=i(e,K);var L=h.shift();l.sig=i(e,L),l.sigval=u(e,L);var W=null;return l.obj=new o,W=new c,W.hTLV=l.version,l.obj.dCMSVersion=W,W=new c,W.hTLV=l.si,l.obj.dSignerIdentifier=W,W=new c,W.hTLV=l.digalg,l.obj.dDigestAlgorithm=W,W=new c,W.hTLV=l.sattrs,l.obj.dSignedAttrs=W,W=new c,W.hTLV=l.sigalg,l.obj.dSigAlg=W,W=new c,W.hTLV=l.sig,l.obj.dSig=W,l.obj.dUnsignedAttrs=new x,l},(typeof s.asn1.csr>"u"||!s.asn1.csr)&&(s.asn1.csr={}),s.asn1.csr.CertificationRequest=function(e){var t=s,r=t.asn1,n=r.DERBitString,a=r.DERSequence,i=r.csr;r.x509;var u=i.CertificationRequestInfo;i.CertificationRequest.superclass.constructor.call(this),this.setByParam=function(f){this.params=f},this.sign=function(){var f=new u(this.params).tohex(),v=new s.crypto.Signature({alg:this.params.sigalg});v.init(this.params.sbjprvkey),v.updateHex(f);var c=v.sign();this.params.sighex=c},this.getPEM=function(){return rt(this.tohex(),"CERTIFICATE REQUEST")},this.tohex=function(){var f=this.params,v=new s.asn1.csr.CertificationRequestInfo(this.params),c=new s.asn1.x509.AlgorithmIdentifier({name:f.sigalg});if(f.sighex==null&&f.sbjprvkey!=null&&this.sign(),f.sighex==null)throw new Error("sighex or sbjprvkey parameter not defined");var g=new n({hex:"00"+f.sighex}),x=new a({array:[v,c,g]});return x.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)},ue(s.asn1.csr.CertificationRequest,s.asn1.ASN1Object),s.asn1.csr.CertificationRequestInfo=function(e){var t=s,r=t.asn1;r.DERBitString;var n=r.DERSequence,a=r.DERInteger,i=r.DERUTF8String,u=r.DERTaggedObject,f=r.ASN1Util.newObject,v=r.csr,c=r.x509,g=c.X500Name,x=c.Extensions,o=c.SubjectPublicKeyInfo;v.AttributeList,v.CertificationRequestInfo.superclass.constructor.call(this),this.params=null,this.setByParam=function(h){h!=null&&(this.params=h)},this.tohex=function(){var h=this.params,d=[];if(d.push(new a({int:0})),d.push(new g(h.subject)),d.push(new o(Ae.getKey(h.sbjpubkey))),h.attrs!=null){var p=l(h.attrs),y=f({tag:{tage:"a0",obj:p}});d.push(y)}else if(h.extreq!=null){var I=new x(h.extreq),y=f({tag:{tage:"a0",obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[I]}]}}});d.push(y)}else d.push(new u({tag:"a0",explicit:!1,obj:new i({str:""})}));var K=new n({array:d});return K.tohex()},this.getEncodedHex=function(){return this.tohex()};function l(h){for(var d=Error,p=s.asn1.x509.Extensions,y=[],I=0;I<h.length;I++){var K=h[I],L=K.attr;if(L=="extensionRequest"){var W=new p(K.ext),m={seq:[{oid:"1.2.840.113549.1.9.14"},{set:[W]}]};y.push(m)}else if(L=="unstructuredName"){var m={seq:[{oid:"1.2.840.113549.1.9.2"},{set:K.names}]};y.push(m)}else if(L=="challengePassword"){var m={seq:[{oid:"1.2.840.113549.1.9.7"},{set:[{utf8str:K.password}]}]};y.push(m)}else throw new d("unknown CSR attribute")}return{set:y}}e!=null&&this.setByParam(e)},ue(s.asn1.csr.CertificationRequestInfo,s.asn1.ASN1Object),s.asn1.csr.AttributeList=function(e){},ue(s.asn1.csr.AttributeList,s.asn1.ASN1Object),s.asn1.csr.CSRUtil=new function(){},s.asn1.csr.CSRUtil.newCSRPEM=function(e){var t=s.asn1.csr,r=new t.CertificationRequest(e),n=r.getPEM();return n},s.asn1.csr.CSRUtil.getParam=function(e,t){var r=ve,n=r.getV,a=r.getIdxbyList,i=r.getTLVbyList,u=r.getTLVbyListEx,f=r.getVbyListEx,v=function(I){var K=a(I,0,[0,3,0,0],"06");return n(I,K)!="2a864886f70d01090e"?null:i(I,0,[0,3,0,1,0],"30")},c={};if(e.indexOf("-----BEGIN CERTIFICATE REQUEST")==-1)throw new Error("argument is not PEM file");var g=ze(e,"CERTIFICATE REQUEST");t&&(c.tbs=i(g,0,[0]));try{var x=u(g,0,[0,1]);if(x=="3000")c.subject={};else{var d=new be;c.subject=d.getX500Name(x)}}catch{}var o=u(g,0,[0,2]),l=Ae.getKey(o,null,"pkcs8pub");c.sbjpubkey=Ae.getPEM(l,"PKCS8PUB");var h=v(g),d=new be;h!=null&&(c.extreq=d.getExtParamArray(h));try{var p=u(g,0,[1],"30"),d=new be;c.sigalg=d.getAlgorithmIdentifierName(p)}catch{}try{var y=f(g,0,[2]);c.sighex=y}catch{}return c},s.asn1.csr.CSRUtil.verifySignature=function(e){try{var t=null;if(typeof e=="string"&&e.indexOf("-----BEGIN CERTIFICATE REQUEST")!=-1?t=s.asn1.csr.CSRUtil.getParam(e,!0):typeof e=="object"&&e.sbjpubkey!=null&&e.sigalg!=null&&e.sighex!=null&&e.tbs!=null&&(t=e),t==null)return!1;var r=new s.crypto.Signature({alg:t.sigalg});return r.init(t.sbjpubkey),r.updateHex(t.tbs),r.verify(t.sighex)}catch(n){return alert(n),!1}},(typeof s>"u"||!s)&&(s={}),(typeof s.asn1>"u"||!s.asn1)&&(s.asn1={}),(typeof s.asn1.ocsp>"u"||!s.asn1.ocsp)&&(s.asn1.ocsp={}),s.asn1.ocsp.DEFAULT_HASH="sha1",s.asn1.ocsp.OCSPResponse=function(e){s.asn1.ocsp.OCSPResponse.superclass.constructor.call(this),s.asn1.DEREnumerated;var t=s.asn1.ASN1Util.newObject,r=s.asn1.ocsp.ResponseBytes,n=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];this.params=null,this._getStatusCode=function(){var a=this.params.resstatus;return typeof a=="number"?a:typeof a!="string"?-1:n.indexOf(a)},this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params,i=this._getStatusCode();if(i==-1)throw new Error("responseStatus not supported: "+a.resstatus);if(i!=0)return t({seq:[{enum:{int:i}}]}).tohex();var u=new r(a);return t({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:!0,obj:u}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)},ue(s.asn1.ocsp.OCSPResponse,s.asn1.ASN1Object),s.asn1.ocsp.ResponseBytes=function(e){s.asn1.ocsp.ResponseBytes.superclass.constructor.call(this);var t=s.asn1,r=t.DERSequence,n=t.DERObjectIdentifier,a=t.DEROctetString,i=t.ocsp.BasicOCSPResponse;this.params=null,this.setByParam=function(u){this.params=u},this.tohex=function(){var u=this.params;if(u.restype!="ocspBasic")throw new Error("not supported responseType: "+u.restype);var f=new i(u),v=[];v.push(new n({name:"ocspBasic"})),v.push(new a({hex:f.tohex()}));var c=new r({array:v});return c.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)},ue(s.asn1.ocsp.ResponseBytes,s.asn1.ASN1Object),s.asn1.ocsp.BasicOCSPResponse=function(e){s.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this);var t=Error,r=s.asn1,n=r.ASN1Object,a=r.DERSequence;r.DERGeneralizedTime;var i=r.DERTaggedObject,u=r.DERBitString;r.x509.Extensions;var f=r.x509.AlgorithmIdentifier,v=r.ocsp;v.ResponderID,_SingleResponseList=v.SingleResponseList,_ResponseData=v.ResponseData,this.params=null,this.setByParam=function(c){this.params=c},this.sign=function(){var c=this.params,g=c.tbsresp.tohex(),x=new s.crypto.Signature({alg:c.sigalg});x.init(c.reskey),x.updateHex(g),c.sighex=x.sign()},this.tohex=function(){var c=this.params;c.tbsresp==null&&(c.tbsresp=new _ResponseData(c)),c.sighex==null&&c.reskey!=null&&this.sign();var g=[];if(g.push(c.tbsresp),g.push(new f({name:c.sigalg})),g.push(new u({hex:"00"+c.sighex})),c.certs!=null&&c.certs.length!=null){for(var x=[],o=0;o<c.certs.length;o++){var l=c.certs[o],h=null;if(ve.isASN1HEX(l))h=l;else if(l.match(/-----BEGIN/))h=ze(l);else throw new t("certs["+o+"] not hex or PEM");x.push(new n({tlv:h}))}var d=new a({array:x});g.push(new i({tag:"a0",explicit:!0,obj:d}))}var p=new a({array:g});return p.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)},ue(s.asn1.ocsp.BasicOCSPResponse,s.asn1.ASN1Object),s.asn1.ocsp.ResponseData=function(e){s.asn1.ocsp.ResponseData.superclass.constructor.call(this);var t=s.asn1,r=t.DERSequence,n=t.DERGeneralizedTime,a=t.DERTaggedObject,i=t.x509.Extensions,u=t.ocsp,f=u.ResponderID;_SingleResponseList=u.SingleResponseList,this.params=null,this.tohex=function(){var v=this.params;v.respid!=null,v.prodat!=null,v.array!=null;var c=[];if(c.push(new f(v.respid)),c.push(new n(v.prodat)),c.push(new _SingleResponseList(v.array)),v.ext!=null){var g=new i(v.ext);c.push(new a({tag:"a1",explicit:!0,obj:g}))}var x=new r({array:c});return x.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(v){this.params=v},e!==void 0&&this.setByParam(e)},ue(s.asn1.ocsp.ResponseData,s.asn1.ASN1Object),s.asn1.ocsp.ResponderID=function(e){s.asn1.ocsp.ResponderID.superclass.constructor.call(this);var t=s,r=t.asn1,n=r.ASN1Util.newObject,a=r.x509.X500Name,i=t.lang.String.isHex,u=Error;this.params=null,this.tohex=function(){var f=this.params;if(f.key!=null){var v=null;if(typeof f.key=="string"){if(i(f.key)&&(v=f.key),f.key.match(/-----BEGIN CERTIFICATE/)){var c=new be(f.key),g=c.getExtSubjectKeyIdentifier();g!=null&&(v=g.kid.hex)}}else if(f.key instanceof be){var g=f.key.getExtSubjectKeyIdentifier();g!=null&&(v=g.kid.hex)}if(v==null)throw new u("wrong key member value");var x=n({tag:{tag:"a2",explicit:!0,obj:{octstr:{hex:v}}}});return x.tohex()}else if(f.name!=null){var o=null;if(typeof f.name=="string"&&f.name.match(/-----BEGIN CERTIFICATE/)){var c=new be(f.name);o=c.getSubject()}else f.name instanceof be?o=f.name.getSubject():typeof f.name=="object"&&(f.name.array!=null||f.name.str!=null)&&(o=f.name);if(o==null)throw new u("wrong name member value");var x=n({tag:{tag:"a1",explicit:!0,obj:new a(o)}});return x.tohex()}throw new u("key or name not specified")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(f){this.params=f},e!==void 0&&this.setByParam(e)},ue(s.asn1.ocsp.ResponderID,s.asn1.ASN1Object),s.asn1.ocsp.SingleResponseList=function(e){s.asn1.ocsp.SingleResponseList.superclass.constructor.call(this);var t=s.asn1,r=t.DERSequence,n=t.ocsp.SingleResponse;this.params=null,this.tohex=function(){var a=this.params;if(typeof a!="object"||a.length==null)throw new Error("params not specified properly");for(var i=[],u=0;u<a.length;u++)i.push(new n(a[u]));var f=new r({array:i});return f.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},e!==void 0&&this.setByParam(e)},ue(s.asn1.ocsp.SingleResponseList,s.asn1.ASN1Object),s.asn1.ocsp.SingleResponse=function(e){var t=Error,r=s,n=r.asn1,a=n.DERSequence,i=n.DERGeneralizedTime,u=n.DERTaggedObject,f=n.ocsp,v=f.CertID,c=f.CertStatus,g=n.x509,x=g.Extensions;f.SingleResponse.superclass.constructor.call(this),this.params=null,this.tohex=function(){var o=this.params,l=[];if(o.certid==null)throw new t("certid unspecified");if(o.status==null)throw new t("status unspecified");if(o.thisupdate==null)throw new t("thisupdate unspecified");if(l.push(new v(o.certid)),l.push(new c(o.status)),l.push(new i(o.thisupdate)),o.nextupdate!=null){var h=new i(o.nextupdate);l.push(new u({tag:"a0",explicit:!0,obj:h}))}if(o.ext!=null){var d=new x(o.ext);l.push(new u({tag:"a1",explicit:!0,obj:d}))}var p=new a({array:l});return p.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(o){this.params=o},e!==void 0&&this.setByParam(e)},ue(s.asn1.ocsp.SingleResponse,s.asn1.ASN1Object),s.asn1.ocsp.CertID=function(e){var t=s,r=t.asn1,n=r.DEROctetString,a=r.DERInteger,i=r.DERSequence,u=r.x509,f=u.AlgorithmIdentifier,v=r.ocsp;v.DEFAULT_HASH;var c=t.crypto,g=c.Util.hashHex,x=be,o=ve,l=o.getVbyList;v.CertID.superclass.constructor.call(this),this.DEFAULT_HASH="sha1",this.params=null,this.setByValue=function(h,d,p,y){y==null&&(y=this.DEFAULT_HASH),this.params={alg:y,issname:h,isskey:d,sbjsn:p}},this.setByCert=function(h,d,p){p==null&&(p=this.DEFAULT_HASH),this.params={alg:p,issuerCert:h,subjectCert:d}},this.getParamByCerts=function(h,d,p){p==null&&(p=this.DEFAULT_HASH);var y=new x(h),I=new x(d),K=g(y.getSubjectHex(),p),L=y.getPublicKeyHex(),W=g(l(L,0,[1],"03",!0),p),m=I.getSerialNumberHex(),w={alg:p,issname:K,isskey:W,sbjsn:m};return w},this.tohex=function(){if(typeof this.params!="object")throw new Error("params not set");var h=this.params,d,p,y,I;if(h.alg==null?I=this.DEFAULT_HASH:I=h.alg,h.issuerCert!=null&&h.subjectCert!=null){var K=this.getParamByCerts(h.issuerCert,h.subjectCert,I);d=K.issname,p=K.isskey,y=K.sbjsn}else if(h.issname!=null&&h.isskey!=null&&h.sbjsn!=null)d=h.issname,p=h.isskey,y=h.sbjsn;else throw new Error("required param members not defined");var L=new f({name:I}),W=new n({hex:d}),m=new n({hex:p}),w=new a({hex:y}),E=new i({array:[L,W,m,w]});return this.hTLV=E.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)},ue(s.asn1.ocsp.CertID,s.asn1.ASN1Object),s.asn1.ocsp.CertStatus=function(e){s.asn1.ocsp.CertStatus.superclass.constructor.call(this),this.params=null,this.tohex=function(){var t=this.params;if(t.status=="good")return"8000";if(t.status=="unknown")return"8200";if(t.status=="revoked"){var r=[{gentime:{str:t.time}}];t.reason!=null&&r.push({tag:{tag:"a0",explicit:!0,obj:{enum:{int:t.reason}}}});var n={tag:"a1",explicit:!1,obj:{seq:r}};return s.asn1.ASN1Util.newObject({tag:n}).tohex()}throw new Error("bad status")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(t){this.params=t},e!==void 0&&this.setByParam(e)},ue(s.asn1.ocsp.CertStatus,s.asn1.ASN1Object),s.asn1.ocsp.Request=function(e){var t=s,r=t.asn1,n=r.DERSequence,a=r.ocsp;if(a.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.tohex=function(){var u=[];if(this.dReqCert===null)throw"reqCert not set";u.push(this.dReqCert);var f=new n({array:u});return this.hTLV=f.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},typeof e<"u"){var i=new a.CertID(e);this.dReqCert=i}},ue(s.asn1.ocsp.Request,s.asn1.ASN1Object),s.asn1.ocsp.TBSRequest=function(e){var t=s,r=t.asn1,n=r.DERSequence,a=r.ocsp;a.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(i){for(var u=[],f=0;f<i.length;f++){var v=new a.Request(i[0]);u.push(v)}this.dRequestList=u},this.tohex=function(){var i=[];if(this.version!==0)throw"not supported version: "+this.version;if(this.dRequestorName!==null)throw"requestorName not supported";var u=new n({array:this.dRequestList});if(i.push(u),this.dRequestExt!==null)throw"requestExtensions not supported";var f=new n({array:i});return this.hTLV=f.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&e.reqList!==void 0&&this.setRequestListByParam(e.reqList)},ue(s.asn1.ocsp.TBSRequest,s.asn1.ASN1Object),s.asn1.ocsp.OCSPRequest=function(e){var t=s,r=t.asn1,n=r.DERSequence,a=r.ocsp;if(a.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.tohex=function(){var u=[];if(this.dTbsRequest!==null)u.push(this.dTbsRequest);else throw"tbsRequest not set";if(this.dOptionalSignature!==null)throw"optionalSignature not supported";var f=new n({array:u});return this.hTLV=f.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&e.reqList!==void 0){var i=new a.TBSRequest(e);this.dTbsRequest=i}},ue(s.asn1.ocsp.OCSPRequest,s.asn1.ASN1Object),s.asn1.ocsp.OCSPUtil={},s.asn1.ocsp.OCSPUtil.getRequestHex=function(e,t,r){var n=s,a=n.asn1,i=a.ocsp;r===void 0&&(r=i.DEFAULT_HASH);var u={alg:r,issuerCert:e,subjectCert:t},f=new i.OCSPRequest({reqList:[u]});return f.tohex()},s.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(e){var t=ve,r=t.getVbyList,n=t.getVbyListEx,a=t.getIdxbyList;t.getIdxbyListEx;var i=t.getV,u={};try{var f=n(e,0,[0],"0a");u.responseStatus=parseInt(f,16)}catch{}if(u.responseStatus!==0)return u;try{var v=a(e,0,[1,0,1,0,0,2,0,1]);e.substr(v,2)==="80"?u.certStatus="good":e.substr(v,2)==="a1"?(u.certStatus="revoked",u.revocationTime=He(r(e,v,[0]))):e.substr(v,2)==="82"&&(u.certStatus="unknown")}catch{}try{var c=a(e,0,[1,0,1,0,0,2,0,2]);u.thisUpdate=He(i(e,c))}catch{}try{var g=a(e,0,[1,0,1,0,0,2,0,3]);e.substr(g,2)==="a0"&&(u.nextUpdate=He(r(e,g,[0])))}catch{}return u},s.asn1.ocsp.OCSPParser=function(){var e=Error,t=be,r=new t,n=ve,a=n.getV,i=n.getTLV,u=n.getIdxbyList,f=n.getVbyList,v=n.getTLVbyList,c=n.getVbyListEx,g=n.getTLVbyListEx,x=n.getChildIdx;this.getOCSPRequest=function(o){var l=x(o,0);if(l.length!=1&&l.length!=2)throw new e("wrong number elements: "+l.length);var h=this.getTBSRequest(i(o,l[0]));return h},this.getTBSRequest=function(o){var l={},h=g(o,0,[0],"30");l.array=this.getRequestList(h);var d=g(o,0,["[2]",0],"30");return d!=null&&(l.ext=r.getExtParamArray(d)),l},this.getRequestList=function(o){for(var l=[],h=x(o,0),d=0;d<h.length;d++){var o=i(o,h[d]);l.push(this.getRequest(o))}return l},this.getRequest=function(o){var l=x(o,0);if(l.length!=1&&l.length!=2)throw new e("wrong number elements: "+l.length);var h=this.getCertID(i(o,l[0]));if(l.length==2){var d=u(o,0,[1,0]);h.ext=r.getExtParamArray(i(o,d))}return h},this.getCertID=function(o){var l=x(o,0);if(l.length!=4)throw new e("wrong number elements: "+l.length);var h=new t,d={};return d.alg=h.getAlgorithmIdentifierName(i(o,l[0])),d.issname=a(o,l[1]),d.isskey=a(o,l[2]),d.sbjsn=a(o,l[3]),d},this.getOCSPResponse=function(o){var l=x(o,0),h,d=a(o,l[0]),p=parseInt(d);if(l.length==1)return{resstatus:p};var y=v(o,0,[1,0]);return h=this.getResponseBytes(y),h.resstatus=p,h},this.getResponseBytes=function(o){var l=x(o,0),h,d=v(o,0,[1,0]);h=this.getBasicOCSPResponse(d);var p=a(o,l[0]);return h.restype=s.asn1.x509.OID.oid2name(Ar(p)),h},this.getBasicOCSPResponse=function(o){var l=x(o,0),h;h=this.getResponseData(i(o,l[0]));var d=new be;h.alg=d.getAlgorithmIdentifierName(i(o,l[1]));var p=a(o,l[2]);h.sighex=p.substr(2);var y=c(o,0,["[0]"]);if(y!=null){for(var I=x(y,0),K=[],L=0;L<I.length;L++){var W=i(y,I[L]);K.push(W)}h.certs=K}return h},this.getResponseData=function(o){var l=x(o,0),h=l.length,d={},p=0;o.substr(l[0],2)=="a0"&&p++,d.respid=this.getResponderID(i(o,l[p++]));var y=a(o,l[p++]);if(d.prodat=He(y),d.array=this.getSingleResponseList(i(o,l[p++])),o.substr(l[h-1],2)=="a1"){var I=v(o,l[h-1],[0]),K=new be;d.ext=K.getExtParamArray(I)}return d},this.getResponderID=function(o){var l={};if(o.substr(0,2)=="a2"){var h=f(o,0,[0]);l.key=h}if(o.substr(0,2)=="a1"){var d=v(o,0,[0]),p=new be;l.name=p.getX500Name(d)}return l},this.getSingleResponseList=function(o){for(var l=x(o,0),h=[],d=0;d<l.length;d++){var p=this.getSingleResponse(i(o,l[d]));h.push(p)}return h},this.getSingleResponse=function(o){var l=x(o,0),h={},d=this.getCertID(i(o,l[0]));h.certid=d;var p=this.getCertStatus(i(o,l[1]));if(h.status=p,o.substr(l[2],2)=="18"){var y=a(o,l[2]);h.thisupdate=He(y)}for(var I=3;I<l.length;I++){if(o.substr(l[I],2)=="a0"){var K=f(o,l[I],[0],"18");h.nextupdate=He(K)}if(o.substr(l[I],2)=="a1"){var L=new be,W=v(o,0,[I,0]);h.ext=L.getExtParamArray(W)}}return h},this.getCertStatus=function(o){var l={};if(o=="8000")return{status:"good"};if(o=="8200")return{status:"unknown"};if(o.substr(0,2)=="a1"){l.status="revoked";var h=f(o,0,[0]),d=He(h);l.time=d}return l}};var s;(typeof s>"u"||!s)&&(s={}),(typeof s.lang>"u"||!s.lang)&&(s.lang={}),s.lang.String=function(){};function Jn(e){for(var t=new Array,r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}function Qn(e){for(var t="",r=0;r<e.length;r++)t=t+String.fromCharCode(e[r]);return t}function yr(e){for(var t="",r=0;r<e.length;r++){var n=e[r].toString(16);n.length==1&&(n="0"+n),t=t+n}return t}function ft(e){return yr(Jn(e))}function ya(e){return N(ft(e))}function ma(e){return zt(N(ft(e)))}function Sa(e){return Qn(F(Jt(e)))}function zt(e){return e=e.replace(/\=/g,""),e=e.replace(/\+/g,"-"),e=e.replace(/\//g,"_"),e}function Jt(e){return e.length%4==2?e=e+"==":e.length%4==3&&(e=e+"="),e=e.replace(/-/g,"+"),e=e.replace(/_/g,"/"),e}function Ye(e){return e.length%2==1&&(e="0"+e),zt(N(e))}function ke(e){return k(Jt(e))}var Qt,gt;typeof _n=="function"?(Qt=function(e){return zt(_n.from(e,"utf8").toString("base64"))},gt=function(e){return _n.from(Jt(e),"base64").toString("utf8")}):(Qt=function(e){return Ye(br(Fr(e)))},gt=function(e){return decodeURIComponent(wr(ke(e)))});function ba(e){return N(br(Fr(e)))}function wa(e){return decodeURIComponent(wr(k(e)))}function mr(e){return br(Fr(e)).toLowerCase()}function He(e){try{return decodeURIComponent(wr(e))}catch{return null}}function Ea(e){return He(Fa(e))}function Fa(e){for(var t=e.match(/.{1,2}/g),r=[],n=0;n<t.length;n++){var a=parseInt(t[n],16);161<=a&&a<=191?(r.push("c2"),r.push(t[n])):192<=a&&a<=255?(r.push("c3"),r.push((a-64).toString(16))):r.push(t[n])}return r.join("")}function ht(e){for(var t="",r=0;r<e.length-1;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t}function bt(e){for(var t="",r=0;r<e.length;r++)t+=("0"+e.charCodeAt(r).toString(16)).slice(-2);return t}function An(e){return N(e)}function Aa(e){return Sr(An(e),64)}function Sr(e,t){return e=e.replace(new RegExp("(.{"+t+"})","g"),`$1\r
`),e=e.replace(/\s+$/,""),e}function ei(e){var t=e.replace(/[^0-9A-Za-z\/+=]*/g,""),r=k(t);return r}function Ca(e,t){return"-----BEGIN "+t+`-----\r
`+Sr(e,64)+`\r
-----END `+t+`-----\r
`}function rt(e,t){return"-----BEGIN "+t+`-----\r
`+Sr(An(e),64)+`\r
-----END `+t+`-----\r
`}function ze(e,t){if(e.indexOf("-----BEGIN ")==-1)throw new Error("can't find PEM header");return t!==void 0?(e=e.replace(new RegExp("^[^]*-----BEGIN "+t+"-----"),""),e=e.replace(new RegExp("-----END "+t+"-----[^]*$"),"")):(e=e.replace(/^[^]*-----BEGIN [^-]+-----/,""),e=e.replace(/-----END [^-]+-----[^]*$/,"")),ei(e)}function Da(e){return e.indexOf("-----BEGIN ")==-1||e.indexOf("-----END ")==-1?null:(e=e.replace(/^[\s\S]*?-----BEGIN [^-]+-----/m,""),e=e.replace(/-----END [\s\S]+$/m,""),e=e.replace(/\s+/g,""),e.match(/^[0-9a-zA-Z+/=]+$/)?e:null)}function Ba(e){if(e.length%2!=0)throw"input is not even length";if(e.match(/^[0-9A-Fa-f]+$/)==null)throw"input is not hexadecimal";for(var t=new ArrayBuffer(e.length/2),r=new DataView(t),n=0;n<e.length/2;n++)r.setUint8(n,parseInt(e.substr(n*2,2),16));return t}function Pa(e){for(var t="",r=new DataView(e),n=0;n<e.byteLength;n++)t+=("00"+r.getUint8(n).toString(16)).slice(-2);return t}function Cn(e){var t,r,n,a,i,u,f,v,c,g;if(e=ri(e),g=e.match(/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/),g)return t=parseInt(g[1]),r=parseInt(g[2])-1,n=parseInt(g[3]),a=parseInt(g[4]),i=parseInt(g[5]),u=parseInt(g[6]),f=0,v=g[7],v!==""&&(c=(v.substr(1)+"00").substr(0,3),f=parseInt(c)),Date.UTC(t,r,n,a,i,u,f);throw new Error("unsupported zulu format: "+e)}function Ia(e){var t=new Date(e),r=("0000"+t.getUTCFullYear()).slice(-4),n=("00"+(t.getUTCMonth()+1)).slice(-2),a=("00"+t.getUTCDate()).slice(-2),i=("00"+t.getUTCHours()).slice(-2),u=("00"+t.getUTCMinutes()).slice(-2),f=("00"+t.getUTCSeconds()).slice(-2),v=("000"+t.getUTCMilliseconds()).slice(-3);return v=v.replace(/0+$/,""),v=v!=""?"."+v:v,r+n+a+i+u+f+v+"Z"}function ti(e){return Math.round(Cn(e)/1e3)}function Ra(e){return new Date(Cn(e))}function Ta(e,t,r){var n,a=e.getUTCFullYear();if(t){if(a<1950||2049<a)throw"not proper year for UTCTime: "+a;n=(""+a).slice(-2)}else n=("000"+a).slice(-4);if(n+=("0"+(e.getUTCMonth()+1)).slice(-2),n+=("0"+e.getUTCDate()).slice(-2),n+=("0"+e.getUTCHours()).slice(-2),n+=("0"+e.getUTCMinutes()).slice(-2),n+=("0"+e.getUTCSeconds()).slice(-2),r){var i=e.getUTCMilliseconds();i!==0&&(i=("00"+i).slice(-3),i=i.replace(/0+$/g,""),n+="."+i)}return n+="Z",n}function ri(e){return e.match(/^[0-9]{12}Z$/)||e.match(/^[0-9]{12}[.][0-9]*Z$/)?e.match(/^[0-4]/)?"20"+e:"19"+e:e}function br(e){return e.replace(/%/g,"")}function wr(e){return e.replace(/(..)/g,"%$1")}function Dn(e){var t="malformed IPv6 address";if(!e.match(/^[0-9A-Fa-f:]+$/))throw t;e=e.toLowerCase();var r=e.split(":").length-1;if(r<2)throw t;var n=":".repeat(7-r+2);e=e.replace("::",n);var a=e.split(":");if(a.length!=8)throw t;for(var i=0;i<8;i++)a[i]=("0000"+a[i]).slice(-4);return a.join("")}function Bn(e){if(!e.match(/^[0-9A-Fa-f]{32}$/))throw new Error("malformed IPv6 address: "+e);e=e.toLowerCase();var t=e.match(/.{1,4}/g);t=t.map(function(a){return a.replace(/^0+/,"")}),t=t.map(function(a){return a==""?"0":a}),e=":"+t.join(":")+":";var r=e.match(/:(0:){2,}/g);if(r==null)return e.slice(1,-1);var n=r.sort().slice(-1)[0];return e=e.replace(n.substr(0,n.length-1),":"),e.substr(0,2)!="::"&&(e=e.substr(1)),e.substr(-2,2)!="::"&&(e=e.substr(0,e.length-1)),e}function Er(e){var t=new Error("malformed hex value");if(!e.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw t;if(e.length==8){var r;try{return r=parseInt(e.substr(0,2),16)+"."+parseInt(e.substr(2,2),16)+"."+parseInt(e.substr(4,2),16)+"."+parseInt(e.substr(6,2),16),r}catch{throw t}}else if(e.length==16)try{return Er(e.substr(0,8))+"/"+ni(e.substr(8))}catch{throw t}else{if(e.length==32)return Bn(e);if(e.length==64){try{return Bn(e.substr(0,32))+"/"+ni(e.substr(32))}catch{throw t}return}else return e}}function ni(e){var t=new Error("malformed mask"),r;try{r=new b(e,16).toString(2)}catch{throw t}if(!r.match(/^1*0*$/))throw t;return r.replace(/0+$/,"").length}function Pn(e){var t=new Error("malformed IP address");if(e=e.toLowerCase(e),!e.match(/^[0-9a-f.:/]+$/))throw t;if(e.match(/^[0-9.]+$/)){var r=e.split(".");if(r.length!==4)throw t;var n="";try{for(var a=0;a<4;a++){var i=parseInt(r[a]);n+=("0"+i.toString(16)).slice(-2)}return n}catch{throw t}}else if(e.match(/^[0-9.]+\/[0-9]+$/)){var u=e.split("/");return Pn(u[0])+ii(parseInt(u[1]),32)}else{if(e.match(/^[0-9a-f:]+$/)&&e.indexOf(":")!==-1)return Dn(e);if(e.match(/^[0-9a-f:]+\/[0-9]+$/)&&e.indexOf(":")!==-1){var u=e.split("/");return Dn(u[0])+ii(parseInt(u[1]),128)}else throw t}}function ii(e,t){if(t==32&&e==0)return"00000000";if(t==128&&e==0)return"00000000000000000000000000000000";var r=Array(e+1).join("1")+Array(t-e+1).join("0");return new b(r,2).toString(16)}function In(e){function t(a){var i=parseInt(a.substr(0,2),16),u=parseInt(a.substr(2),16);if(i==0&u<128)return String.fromCharCode(u);if(i<8){var f=192|(i&7)<<3|(u&192)>>6,v=128|u&63;return He(f.toString(16)+v.toString(16))}var f=224|(i&240)>>4,v=128|(i&15)<<2|(u&192)>>6,c=128|u&63;return He(f.toString(16)+v.toString(16)+c.toString(16))}var r=e.match(/.{4}/g),n=r.map(t);return n.join("")}function Fr(e){for(var t=encodeURIComponent(e),r="",n=0;n<t.length;n++)t[n]=="%"?(r=r+t.substr(n,3),n=n+2):r=r+"%"+ft(t[n]);return r}function Ha(e){return e=e.replace(/\r\n/mg,`
`),e}function Na(e){return e=e.replace(/\r\n/mg,`
`),e=e.replace(/\n/mg,`\r
`),e}s.lang.String.isInteger=function(e){return e.match(/^[0-9]+$/)?!0:!!e.match(/^-[0-9]+$/)},s.lang.String.isHex=function(e){return si(e)};function si(e){return!!(e.length%2==0&&(e.match(/^[0-9a-f]+$/)||e.match(/^[0-9A-F]+$/)))}s.lang.String.isBase64=function(e){return e=e.replace(/\s+/g,""),!!(e.match(/^[0-9A-Za-z+\/]+={0,3}$/)&&e.length%4==0)},s.lang.String.isBase64URL=function(e){return e.match(/[+/=]/)?!1:(e=Jt(e),s.lang.String.isBase64(e))};function Rn(e){return!!e.match(/^[0-9A-Za-z-_.]+$/)}s.lang.String.isIntegerArray=function(e){return e=e.replace(/\s+/g,""),!!e.match(/^\[[0-9,]+\]$/)},s.lang.String.isPrintable=function(e){return e.match(/^[0-9A-Za-z '()+,-./:=?]*$/)!==null},s.lang.String.isIA5=function(e){return e.match(/^[\x20-\x21\x23-\x7f]*$/)!==null},s.lang.String.isMail=function(e){return e.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)!==null};function Tn(e){return e.length%2==1?"0"+e:e.substr(0,1)>"7"?"00"+e:e}function _a(e){e=e.replace(/^\s*\[\s*/,""),e=e.replace(/\s*\]\s*$/,""),e=e.replace(/\s*/g,"");try{var t=e.split(/,/).map(function(r,n,a){var i=parseInt(r);if(i<0||255<i)throw"integer not in range 0-255";var u=("00"+i.toString(16)).slice(-2);return u}).join("");return t}catch(r){throw"malformed integer array string: "+r}}var Oa=function(e,t){var r=e.length;e.length>t.length&&(r=t.length);for(var n=0;n<r;n++)if(e.charCodeAt(n)!=t.charCodeAt(n))return n;return e.length!=t.length?r:-1};function ai(e){var t=function(f){var v=f.toString(16);return v.length==1&&(v="0"+v),v},r=function(f){var v="",c=parseInt(f,10),g=c.toString(2),x=7-g.length%7;x==7&&(x=0);for(var o="",l=0;l<x;l++)o+="0";g=o+g;for(var l=0;l<g.length-1;l+=7){var h=g.substr(l,7);l!=g.length-7&&(h="1"+h),v+=t(parseInt(h,2))}return v};try{if(!e.match(/^[0-9.]+$/))return null;var n="",a=e.split("."),i=parseInt(a[0],10)*40+parseInt(a[1],10);n+=t(i),a.splice(0,2);for(var u=0;u<a.length;u++)n+=r(a[u]);return n}catch{return null}}function Ar(e){if(!si(e))return null;try{var t=[],r=e.substr(0,2),n=parseInt(r,16);t[0]=new String(Math.floor(n/40)),t[1]=new String(n%40);for(var a=e.substr(2),i=[],u=0;u<a.length/2;u++)i.push(parseInt(a.substr(u*2,2),16));for(var f=[],v="",u=0;u<i.length;u++)i[u]&128?v=v+Cr((i[u]&127).toString(2),7):(v=v+Cr((i[u]&127).toString(2),7),f.push(new String(parseInt(v,2))),v="");var c=t.join(".");return f.length>0&&(c=c+"."+f.join(".")),c}catch{return null}}function oi(e){var t=new b(String(e),10);return er(t)}function er(e){var t=e.toString(16);if(t.substr(0,1)!="-")return t.length%2==1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t),t;var r=t.substr(1),n=r.length;n%2==1?n+=1:t.match(/^[0-7]/)||(n+=2);for(var a="",i=0;i<n;i++)a+="f";var u=new b(a,16),f=u.xor(e).add(b.ONE);return t=f.toString(16).replace(/^-/,""),t}var Cr=function(e,t,r){return r==null&&(r="0"),e.length>=t?e:new Array(t-e.length+1).join(r)+e};function ui(e){if(e.length%2!=0||(e=e.toLowerCase(),e.match(/^[0-9a-f]+$/)==null))return-1;try{var t=e.substr(0,2);if(t=="00")return parseInt(e.substr(2),16);var r=parseInt(t,16);if(r>7)return-1;var n=e.substr(2),a=parseInt(n,16).toString(2);a=="0"&&(a="00000000"),a=a.slice(0,0-r);var i=parseInt(a,2);return i==NaN?-1:i}catch{return-1}}function fi(e){if(typeof e!="number"||e<0)return null;var t=Number(e).toString(2),r=8-t.length%8;r==8&&(r=0),t=t+Cr("",r,"0");var n=parseInt(t,2).toString(16);n.length%2==1&&(n="0"+n);var a="0"+r;return a+n}function hi(e){if(typeof e!="string"||e.length%2!=0||!e.match(/^[0-9a-f]+$/))return null;try{var t=parseInt(e.substr(0,2),16);if(t<0||7<t)return null;for(var r=e.substr(2),n="",a=0;a<r.length;a+=2){var i=r.substr(a,2),u=parseInt(i,16).toString(2);u=("0000000"+u).slice(-8),n+=u}return n.substr(0,n.length-t)}catch{return null}}function ja(e){if(typeof e!="string"||e.match(/^[01]+$/)==null)return null;try{var t=parseInt(e,2);return fi(t)}catch{return null}}function Dr(e,t){for(var r=0,n=0;n<e.length;n++)r|=1<<t[e[n]];for(var a=r.toString(2),i="",n=a.length-1;n>=0;n--)i+=a[n];return i}function Oe(e,n,r){if(typeof e=="object"){for(var n=String(n).split("."),a=0;a<n.length&&e;a++){var i=n[a];i.match(/^[0-9]+$/)&&(i=parseInt(i)),e=e[i]}return e||e===!1?e:r}}function ue(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.superclass=t.prototype,t.prototype.constructor==Object.prototype.constructor&&(t.prototype.constructor=t)}(typeof s>"u"||!s)&&(s={}),(typeof s.crypto>"u"||!s.crypto)&&(s.crypto={}),s.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:O.algo.MD5,sha1:O.algo.SHA1,sha224:O.algo.SHA224,sha256:O.algo.SHA256,sha384:O.algo.SHA384,sha512:O.algo.SHA512,ripemd160:O.algo.RIPEMD160},this.getDigestInfoHex=function(e,t){if(typeof this.DIGESTINFOHEAD[t]>"u")throw"alg not supported in Util.DIGESTINFOHEAD: "+t;return this.DIGESTINFOHEAD[t]+e},this.getPaddedDigestInfoHex=function(e,t,r){var n=this.getDigestInfoHex(e,t),a=r/4;if(n.length+22>a)throw"key is too short for SigAlg: keylen="+r+","+t;for(var i="0001",u="00"+n,f="",v=a-i.length-u.length,c=0;c<v;c+=2)f+="ff";var g=i+f+u;return g},this.hashString=function(e,t){var r=new s.crypto.MessageDigest({alg:t});return r.digestString(e)},this.hashHex=function(e,t){var r=new s.crypto.MessageDigest({alg:t});return r.digestHex(e)},this.sha1=function(e){return this.hashString(e,"sha1")},this.sha256=function(e){return this.hashString(e,"sha256")},this.sha256Hex=function(e){return this.hashHex(e,"sha256")},this.sha512=function(e){return this.hashString(e,"sha512")},this.sha512Hex=function(e){return this.hashHex(e,"sha512")},this.isKey=function(e){return e instanceof we||e instanceof s.crypto.DSA||e instanceof s.crypto.ECDSA}},s.crypto.Util.md5=function(e){var t=new s.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return t.digestString(e)},s.crypto.Util.ripemd160=function(e){var t=new s.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return t.digestString(e)},s.crypto.Util.SECURERANDOMGEN=new Ut,s.crypto.Util.getRandomHexOfNbytes=function(e){var t=new Array(e);return s.crypto.Util.SECURERANDOMGEN.nextBytes(t),yr(t)},s.crypto.Util.getRandomBigIntegerOfNbytes=function(e){return new b(s.crypto.Util.getRandomHexOfNbytes(e),16)},s.crypto.Util.getRandomHexOfNbits=function(e){var t=e%8,r=(e-t)/8,n=new Array(r+1);return s.crypto.Util.SECURERANDOMGEN.nextBytes(n),n[0]=(255<<t&255^255)&n[0],yr(n)},s.crypto.Util.getRandomBigIntegerOfNbits=function(e){return new b(s.crypto.Util.getRandomHexOfNbits(e),16)},s.crypto.Util.getRandomBigIntegerZeroToMax=function(e){for(var t=e.bitLength();;){var r=s.crypto.Util.getRandomBigIntegerOfNbits(t);if(e.compareTo(r)>=0)return r}},s.crypto.Util.getRandomBigIntegerMinToMax=function(e,t){var r=e.compareTo(t);if(r>0)throw"biMin is greater than biMax";if(r==0)return e;var n=t.subtract(e),a=s.crypto.Util.getRandomBigIntegerZeroToMax(n);return a.add(e)},s.crypto.MessageDigest=function(e){this.setAlgAndProvider=function(t,r){if(t=s.crypto.MessageDigest.getCanonicalAlgName(t),t!==null&&r===void 0&&(r=s.crypto.Util.DEFAULTPROVIDER[t]),":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(t)!=-1&&r=="cryptojs"){try{this.md=s.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[t].create()}catch(n){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+n}this.updateString=function(n){this.md.update(n)},this.updateHex=function(n){var a=O.enc.Hex.parse(n);this.md.update(a)},this.digest=function(){var n=this.md.finalize();return n.toString(O.enc.Hex)},this.digestString=function(n){return this.updateString(n),this.digest()},this.digestHex=function(n){return this.updateHex(n),this.digest()}}if(":sha256:".indexOf(t)!=-1&&r=="sjcl"){try{this.md=new sjcl.hash.sha256}catch(n){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+n}this.updateString=function(n){this.md.update(n)},this.updateHex=function(n){var a=sjcl.codec.hex.toBits(n);this.md.update(a)},this.digest=function(){var n=this.md.finalize();return sjcl.codec.hex.fromBits(n)},this.digestString=function(n){return this.updateString(n),this.digest()},this.digestHex=function(n){return this.updateHex(n),this.digest()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},e!==void 0&&e.alg!==void 0&&(this.algName=e.alg,e.prov===void 0&&(this.provName=s.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},s.crypto.MessageDigest.getCanonicalAlgName=function(e){return typeof e=="string"&&(e=e.toLowerCase(),e=e.replace(/-/,"")),e},s.crypto.MessageDigest.getHashLength=function(e){var t=s.crypto.MessageDigest,r=t.getCanonicalAlgName(e);if(t.HASHLENGTH[r]===void 0)throw"not supported algorithm: "+e;return t.HASHLENGTH[r]},s.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},s.crypto.Mac=function(e){this.setAlgAndProvider=function(t,r){if(t=t.toLowerCase(),t==null&&(t="hmacsha1"),t=t.toLowerCase(),t.substr(0,4)!="hmac")throw"setAlgAndProvider unsupported HMAC alg: "+t;r===void 0&&(r=s.crypto.Util.DEFAULTPROVIDER[t]),this.algProv=t+"/"+r;var n=t.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(n)!=-1&&r=="cryptojs"){try{var a=s.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[n];this.mac=O.algo.HMAC.create(a,this.pass)}catch(i){throw"setAlgAndProvider hash alg set fail hashAlg="+n+"/"+i}this.updateString=function(i){this.mac.update(i)},this.updateHex=function(i){var u=O.enc.Hex.parse(i);this.mac.update(u)},this.doFinal=function(){var i=this.mac.finalize();return i.toString(O.enc.Hex)},this.doFinalString=function(i){return this.updateString(i),this.doFinal()},this.doFinalHex=function(i){return this.updateHex(i),this.doFinal()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(t){if(typeof t=="string"){var r=t;(t.length%2==1||!t.match(/^[0-9A-Fa-f]+$/))&&(r=bt(t)),this.pass=O.enc.Hex.parse(r);return}if(typeof t!="object")throw"KJUR.crypto.Mac unsupported password type: "+t;var r=null;if(t.hex!==void 0){if(t.hex.length%2!=0||!t.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+t.hex;r=t.hex}if(t.utf8!==void 0&&(r=mr(t.utf8)),t.rstr!==void 0&&(r=bt(t.rstr)),t.b64!==void 0&&(r=k(t.b64)),t.b64u!==void 0&&(r=ke(t.b64u)),r==null)throw"KJUR.crypto.Mac unsupported password type: "+t;this.pass=O.enc.Hex.parse(r)},e!==void 0&&(e.pass!==void 0&&this.setPassword(e.pass),e.alg!==void 0&&(this.algName=e.alg,e.prov===void 0&&(this.provName=s.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},s.crypto.Signature=function(e){var t=null;if(this._setAlgNames=function(){var r=this.algName.match(/^(.+)with(.+)$/);r&&(this.mdAlgName=r[1].toLowerCase(),this.pubkeyAlgName=r[2].toLowerCase(),this.pubkeyAlgName=="rsaandmgf1"&&this.mdAlgName=="sha"&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(r,n){for(var a="",i=n/4-r.length,u=0;u<i;u++)a=a+"0";return a+r},this.setAlgAndProvider=function(r,n){if(this._setAlgNames(),n!="cryptojs/jsrsa")throw new Error("provider not supported: "+n);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new s.crypto.MessageDigest({alg:this.mdAlgName})}catch(a){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+a)}this.init=function(a,i){var u=null;try{i===void 0?u=Ae.getKey(a):u=Ae.getKey(a,i)}catch(f){throw"init failed:"+f}if(u.isPrivate===!0)this.prvKey=u,this.state="SIGN";else if(u.isPublic===!0)this.pubKey=u,this.state="VERIFY";else throw"init failed.:"+u},this.updateString=function(a){this.md.updateString(a)},this.updateHex=function(a){this.md.updateHex(a)},this.sign=function(){if(this.sHashHex=this.md.digest(),this.prvKey===void 0&&this.ecprvhex!==void 0&&this.eccurvename!==void 0&&s.crypto.ECDSA!==void 0&&(this.prvKey=new s.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof we&&this.pubkeyAlgName==="rsaandmgf1")this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof we&&this.pubkeyAlgName==="rsa")this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof s.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else if(this.prvKey instanceof s.crypto.DSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;return this.hSign},this.signString=function(a){return this.updateString(a),this.sign()},this.signHex=function(a){return this.updateHex(a),this.sign()},this.verify=function(a){if(this.sHashHex=this.md.digest(),this.pubKey===void 0&&this.ecpubhex!==void 0&&this.eccurvename!==void 0&&s.crypto.ECDSA!==void 0&&(this.pubKey=new s.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof we&&this.pubkeyAlgName==="rsaandmgf1")return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,a,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof we&&this.pubkeyAlgName==="rsa")return this.pubKey.verifyWithMessageHash(this.sHashHex,a);if(s.crypto.ECDSA!==void 0&&this.pubKey instanceof s.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,a);if(s.crypto.DSA!==void 0&&this.pubKey instanceof s.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,a);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(r,n){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(r){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(r){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(r){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(r){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(r){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=e,e!==void 0&&(e.alg!==void 0&&(this.algName=e.alg,e.prov===void 0?this.provName=s.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=e.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),e.psssaltlen!==void 0&&(this.pssSaltLen=e.psssaltlen),e.prvkeypem!==void 0)){if(e.prvkeypas!==void 0)throw"both prvkeypem and prvkeypas parameters not supported";try{var t=Ae.getKey(e.prvkeypem);this.init(t)}catch(r){throw"fatal error to load pem private key: "+r}}},s.crypto.Cipher=function(e){},s.crypto.Cipher.encrypt=function(e,t,r,n){if(Oe(n,"enclag")!=null&&(r=n.encalg),typeof r=="string"&&r.substr(-4)=="-CBC"){var a=t,i=e;Oe(n,"key")!=null&&(a=n.key),Oe(n,"enc")!=null&&(hEnc=n.enc);var u=O.enc.Hex.parse(a),f=O.enc.Hex.parse(i),v=O.enc.Hex.parse(n.iv),c;if(r=="des-EDE3-CBC")c=O.TripleDES.encrypt(f,u,{iv:v});else if(r=="aes128-CBC"||r=="aes256-CBC")c=O.AES.encrypt(f,u,{iv:v});else throw new Error("unsupported algorithm: "+r);return c+""}else throw new Error("Cipher.encrypt: unsupported key or algorithm")},s.crypto.Cipher.decrypt=function(e,t,r,n){if(Oe(n,"enclag")!=null&&(r=n.encalg),typeof r=="string"&&r.substr(-4)=="-CBC"){var a=t,i=e;Oe(n,"key")!=null&&(a=n.key),Oe(n,"enc")!=null&&(i=n.enc);var u=O.enc.Hex.parse(a),f=O.enc.Hex.parse(i),v=O.enc.Hex.parse(n.iv),c;if(r=="des-EDE3-CBC")c=O.TripleDES.decrypt({ciphertext:f},u,{iv:v});else if(r=="aes128-CBC"||r=="aes256-CBC")c=O.AES.decrypt({ciphertext:f},u,{iv:v});else throw new Error("unsupported algorithm: "+r);return O.enc.Hex.stringify(c)}else throw new Error("Cipher.decrypt: unsupported key or algorithm")},s.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040022":"secp384r1","2b81040023":"secp521r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},(typeof s>"u"||!s)&&(s={}),(typeof s.crypto>"u"||!s.crypto)&&(s.crypto={}),s.crypto.ECDSA=function(e){var t="secp256r1",r=Error,n=b,a=Ie,i=s.crypto.ECDSA,u=s.crypto.ECParameterDB,f=i.getName,v=ve,c=v.getVbyListEx,g=v.isASN1HEX,x=new Ut;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(o){return new n(o.bitLength(),x).mod(o.subtract(n.ONE)).add(n.ONE)},this.setNamedCurve=function(o){this.ecparams=u.getByName(o),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=o},this.setPrivateKeyHex=function(o){this.isPrivate=!0,this.prvKeyHex=o},this.setPublicKeyHex=function(o){this.isPublic=!0,this.pubKeyHex=o},this.getPublicKeyXYHex=function(){var o=this.pubKeyHex;if(o.substr(0,2)!=="04")throw"this method supports uncompressed format(04) only";var l=this.ecparams.keycharlen;if(o.length!==2+l*2)throw"malformed public key hex length";var h={};return h.x=o.substr(2,l),h.y=o.substr(2+l),h},this.getShortNISTPCurveName=function(){var o=this.curveName;return o==="secp256r1"||o==="NIST P-256"||o==="P-256"||o==="prime256v1"?"P-256":o==="secp384r1"||o==="NIST P-384"||o==="P-384"?"P-384":o==="secp521r1"||o==="NIST P-521"||o==="P-521"?"P-521":null},this.generateKeyPairHex=function(){var o=this.ecparams.n,l=this.getBigRandom(o),h=this.ecparams.keycharlen,d=("0000000000"+l.toString(16)).slice(-h);this.setPrivateKeyHex(d);var p=this.generatePublicKeyHex();return{ecprvhex:d,ecpubhex:p}},this.generatePublicKeyHex=function(){var o=new n(this.prvKeyHex,16),l=this.ecparams.G.multiply(o),h=l.getX().toBigInteger(),d=l.getY().toBigInteger(),p=this.ecparams.keycharlen,y=("0000000000"+h.toString(16)).slice(-p),I=("0000000000"+d.toString(16)).slice(-p),K="04"+y+I;return this.setPublicKeyHex(K),K},this.signWithMessageHash=function(o){return this.signHex(o,this.prvKeyHex)},this.signHex=function(o,l){var h=new n(l,16),d=this.ecparams.n,p=new n(o.substring(0,this.ecparams.keycharlen),16);do var y=this.getBigRandom(d),I=this.ecparams.G,K=I.multiply(y),L=K.getX().toBigInteger().mod(d);while(L.compareTo(n.ZERO)<=0);var W=y.modInverse(d).multiply(p.add(h.multiply(L))).mod(d);return i.biRSSigToASN1Sig(L,W)},this.sign=function(o,l){var h=l,d=this.ecparams.n,p=n.fromByteArrayUnsigned(o);do var y=this.getBigRandom(d),I=this.ecparams.G,K=I.multiply(y),L=K.getX().toBigInteger().mod(d);while(L.compareTo(b.ZERO)<=0);var W=y.modInverse(d).multiply(p.add(h.multiply(L))).mod(d);return this.serializeSig(L,W)},this.verifyWithMessageHash=function(o,l){return this.verifyHex(o,l,this.pubKeyHex)},this.verifyHex=function(o,l,h){try{var d,p,y=i.parseSigHex(l);d=y.r,p=y.s;var I=a.decodeFromHex(this.ecparams.curve,h),K=new n(o.substring(0,this.ecparams.keycharlen),16);return this.verifyRaw(K,d,p,I)}catch{return!1}},this.verify=function(o,l,h){var d,p;if(Bitcoin.Util.isArray(l)){var y=this.parseSig(l);d=y.r,p=y.s}else if(typeof l=="object"&&l.r&&l.s)d=l.r,p=l.s;else throw"Invalid value for signature";var I;if(h instanceof Ie)I=h;else if(Bitcoin.Util.isArray(h))I=a.decodeFrom(this.ecparams.curve,h);else throw"Invalid format for pubkey value, must be byte array or ECPointFp";var K=n.fromByteArrayUnsigned(o);return this.verifyRaw(K,d,p,I)},this.verifyRaw=function(o,l,h,d){var p=this.ecparams.n,y=this.ecparams.G;if(l.compareTo(n.ONE)<0||l.compareTo(p)>=0||h.compareTo(n.ONE)<0||h.compareTo(p)>=0)return!1;var I=h.modInverse(p),K=o.multiply(I).mod(p),L=l.multiply(I).mod(p),W=y.multiply(K).add(d.multiply(L)),m=W.getX().toBigInteger().mod(p);return m.equals(l)},this.serializeSig=function(o,l){var h=o.toByteArraySigned(),d=l.toByteArraySigned(),p=[];return p.push(2),p.push(h.length),p=p.concat(h),p.push(2),p.push(d.length),p=p.concat(d),p.unshift(p.length),p.unshift(48),p},this.parseSig=function(o){var l;if(o[0]!=48)throw new Error("Signature not a valid DERSequence");if(l=2,o[l]!=2)throw new Error("First element in signature must be a DERInteger");var h=o.slice(l+2,l+2+o[l+1]);if(l+=2+o[l+1],o[l]!=2)throw new Error("Second element in signature must be a DERInteger");var d=o.slice(l+2,l+2+o[l+1]);l+=2+o[l+1];var p=n.fromByteArrayUnsigned(h),y=n.fromByteArrayUnsigned(d);return{r:p,s:y}},this.parseSigCompact=function(o){if(o.length!==65)throw"Signature has the wrong length";var l=o[0]-27;if(l<0||l>7)throw"Invalid signature type";var h=this.ecparams.n,d=n.fromByteArrayUnsigned(o.slice(1,33)).mod(h),p=n.fromByteArrayUnsigned(o.slice(33,65)).mod(h);return{r:d,s:p,i:l}},this.readPKCS5PrvKeyHex=function(o){if(g(o)===!1)throw new Error("not ASN.1 hex string");var l,h,d;try{l=c(o,0,["[0]",0],"06"),h=c(o,0,[1],"04");try{d=c(o,0,["[1]",0],"03")}catch{}}catch{throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=f(l),this.curveName===void 0)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(d),this.setPrivateKeyHex(h),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(o){if(g(o)===!1)throw new r("not ASN.1 hex string");var l,h,d,p;try{l=c(o,0,[1,0],"06"),h=c(o,0,[1,1],"06"),d=c(o,0,[2,0,1],"04");try{p=c(o,0,[2,0,"[1]",0],"03")}catch{}}catch{throw new r("malformed PKCS#8 plain ECC private key")}if(this.curveName=f(h),this.curveName===void 0)throw new r("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(p),this.setPrivateKeyHex(d),this.isPublic=!1},this.readPKCS8PubKeyHex=function(o){if(g(o)===!1)throw new r("not ASN.1 hex string");var l,h,d;try{l=c(o,0,[0,0],"06"),h=c(o,0,[0,1],"06"),d=c(o,0,[1],"03")}catch{throw new r("malformed PKCS#8 ECC public key")}if(this.curveName=f(h),this.curveName===null)throw new r("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(d)},this.readCertPubKeyHex=function(o,l){if(g(o)===!1)throw new r("not ASN.1 hex string");var h,d;try{h=c(o,0,[0,5,0,1],"06"),d=c(o,0,[0,5,1],"03")}catch{throw new r("malformed X.509 certificate ECC public key")}if(this.curveName=f(h),this.curveName===null)throw new r("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(d)},e!==void 0&&e.curve!==void 0&&(this.curveName=e.curve),this.curveName===void 0&&(this.curveName=t),this.setNamedCurve(this.curveName),e!==void 0&&(e.prv!==void 0&&this.setPrivateKeyHex(e.prv),e.pub!==void 0&&this.setPublicKeyHex(e.pub))},s.crypto.ECDSA.parseSigHex=function(e){var t=s.crypto.ECDSA.parseSigHexInHexRS(e),r=new b(t.r,16),n=new b(t.s,16);return{r,s:n}},s.crypto.ECDSA.parseSigHexInHexRS=function(e){var t=ve,r=t.getChildIdx,n=t.getV;if(t.checkStrictDER(e,0),e.substr(0,2)!="30")throw new Error("signature is not a ASN.1 sequence");var a=r(e,0);if(a.length!=2)throw new Error("signature shall have two elements");var i=a[0],u=a[1];if(e.substr(i,2)!="02")throw new Error("1st item not ASN.1 integer");if(e.substr(u,2)!="02")throw new Error("2nd item not ASN.1 integer");var f=n(e,i),v=n(e,u);return{r:f,s:v}},s.crypto.ECDSA.asn1SigToConcatSig=function(e){var t=s.crypto.ECDSA.parseSigHexInHexRS(e),r=t.r,n=t.s;if(r.length>=130&&r.length<=134){if(r.length%2!=0)throw Error("unknown ECDSA sig r length error");if(n.length%2!=0)throw Error("unknown ECDSA sig s length error");r.substr(0,2)=="00"&&(r=r.substr(2)),n.substr(0,2)=="00"&&(n=n.substr(2));var a=Math.max(r.length,n.length);return r=("000000"+r).slice(-a),n=("000000"+n).slice(-a),r+n}if(r.substr(0,2)=="00"&&r.length%32==2&&(r=r.substr(2)),n.substr(0,2)=="00"&&n.length%32==2&&(n=n.substr(2)),r.length%32==30&&(r="00"+r),n.length%32==30&&(n="00"+n),r.length%32!=0)throw Error("unknown ECDSA sig r length error");if(n.length%32!=0)throw Error("unknown ECDSA sig s length error");return r+n},s.crypto.ECDSA.concatSigToASN1Sig=function(e){if(e.length%4!=0)throw Error("unknown ECDSA concatinated r-s sig length error");var t=e.substr(0,e.length/2),r=e.substr(e.length/2);return s.crypto.ECDSA.hexRSSigToASN1Sig(t,r)},s.crypto.ECDSA.hexRSSigToASN1Sig=function(e,t){var r=new b(e,16),n=new b(t,16);return s.crypto.ECDSA.biRSSigToASN1Sig(r,n)},s.crypto.ECDSA.biRSSigToASN1Sig=function(e,t){var r=s.asn1,n=new r.DERInteger({bigint:e}),a=new r.DERInteger({bigint:t}),i=new r.DERSequence({array:[n,a]});return i.tohex()},s.crypto.ECDSA.getName=function(e){return e==="2b8104001f"?"secp192k1":e==="2a8648ce3d030107"?"secp256r1":e==="2b8104000a"?"secp256k1":e==="2b81040021"?"secp224r1":e==="2b81040022"?"secp384r1":e==="2b81040023"?"secp521r1":"|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(e)!==-1?"secp256r1":"|secp256k1|".indexOf(e)!==-1?"secp256k1":"|secp224r1|NIST P-224|P-224|".indexOf(e)!==-1?"secp224r1":"|secp384r1|NIST P-384|P-384|".indexOf(e)!==-1?"secp384r1":"|secp521r1|NIST P-521|P-521|".indexOf(e)!==-1?"secp521r1":null},(typeof s>"u"||!s)&&(s={}),(typeof s.crypto>"u"||!s.crypto)&&(s.crypto={}),s.crypto.ECParameterDB=new function(){var e={},t={};function r(n){return new b(n,16)}this.getByName=function(n){var a=n;if(typeof t[a]<"u"&&(a=t[n]),typeof e[a]<"u")return e[a];throw"unregistered EC curve name: "+a},this.regist=function(n,a,i,u,f,v,c,g,x,o,l,h){e[n]={};var d=r(i),p=r(u),y=r(f),I=r(v),K=r(c),L=new Ft(d,p,y),W=L.decodePointHex("04"+g+x);e[n].name=n,e[n].keylen=a,e[n].keycharlen=Math.ceil(a/8)*2,e[n].curve=L,e[n].G=W,e[n].n=I,e[n].h=K,e[n].oid=l,e[n].info=h;for(var m=0;m<o.length;m++)t[o[m]]=n}},s.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),s.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),s.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),s.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),s.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),s.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),s.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),s.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),s.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),s.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","00C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),(typeof s>"u"||!s)&&(s={}),(typeof s.crypto>"u"||!s.crypto)&&(s.crypto={}),s.crypto.DSA=function(){var e=ve;e.getVbyList;var t=e.getVbyListEx,r=e.isASN1HEX,n=b,a=b.ONE,i=function(u,f,v,c){if(u==null||f==null||v==null||c==null)throw new Error("invalid DSA public key");if(a.compareTo(f)>=0||f.compareTo(u)>=0)throw new Error("invalid DSA public key");if(a.compareTo(v)>=0||v.compareTo(u)>=0)throw new Error("invalid DSA public key");if(a.compareTo(c)>=0||c.compareTo(u)>=0)throw new Error("invalid DSA public key");if(v.modPow(f,u).compareTo(a)!=0)throw new Error("invalid DSA public key")};this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(u,f,v,c,g){this.isPrivate=!0,this.p=u,this.q=f,this.g=v,this.y=c,this.x=g},this.setPrivateHex=function(u,f,v,c,g){var x,o,l,h,d;x=new b(u,16),o=new b(f,16),l=new b(v,16),typeof c=="string"&&c.length>1?h=new b(c,16):h=null,d=new b(g,16),this.setPrivate(x,o,l,h,d)},this.setPublic=function(u,f,v,c){i(u,f,v,c),this.isPublic=!0,this.p=u,this.q=f,this.g=v,this.y=c,this.x=null},this.setPublicHex=function(u,f,v,c){var g,x,o,l;g=new b(u,16),x=new b(f,16),o=new b(v,16),l=new b(c,16),this.setPublic(g,x,o,l)},this.signWithMessageHash=function(u){var f=this.p,v=this.q,c=this.g;this.y;var g=this.x,x=u.substr(0,v.bitLength()/4),o=new b(x,16),l,h,d;do l=s.crypto.Util.getRandomBigIntegerMinToMax(b.ONE.add(b.ONE),v.subtract(b.ONE)),h=c.modPow(l,f).mod(v),d=l.modInverse(v).multiply(o.add(g.multiply(h))).mod(v);while(h.compareTo(b.ZERO)==0||d.compareTo(b.ZERO)==0);var p=s.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:h}},{int:{bigint:d}}]});return p},this.verifyWithMessageHash=function(u,f){var v=this.p,c=this.q,g=this.g,x=this.y,o=this.parseASN1Signature(f),l=o[0],h=o[1],d=u.substr(0,c.bitLength()/4),p=new b(d,16);if(b.ZERO.compareTo(l)>0||l.compareTo(c)>0||b.ZERO.compareTo(h)>=0||h.compareTo(c)>0)throw"invalid DSA signature";var y=h.modInverse(c),I=p.multiply(y).mod(c),K=l.multiply(y).mod(c),L=g.modPow(I,v).multiply(x.modPow(K,v)).mod(v).mod(c);return L.compareTo(l)==0},this.parseASN1Signature=function(u){try{var f=new n(t(u,0,[0],"02"),16),v=new n(t(u,0,[1],"02"),16);return[f,v]}catch{throw new Error("malformed ASN.1 DSA signature")}},this.readPKCS5PrvKeyHex=function(u){var f,v,c,g,x;if(r(u)===!1)throw new Error("not ASN.1 hex string");try{f=t(u,0,[1],"02"),v=t(u,0,[2],"02"),c=t(u,0,[3],"02"),g=t(u,0,[4],"02"),x=t(u,0,[5],"02")}catch{throw new Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(f,v,c,g,x)},this.readPKCS8PrvKeyHex=function(u){var f,v,c,g;if(r(u)===!1)throw new Error("not ASN.1 hex string");try{f=t(u,0,[1,1,0],"02"),v=t(u,0,[1,1,1],"02"),c=t(u,0,[1,1,2],"02"),g=t(u,0,[2,0],"02")}catch{throw new Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(f,v,c,null,g)},this.readPKCS8PubKeyHex=function(u){var f,v,c,g;if(r(u)===!1)throw new Error("not ASN.1 hex string");try{f=t(u,0,[0,1,0],"02"),v=t(u,0,[0,1,1],"02"),c=t(u,0,[0,1,2],"02"),g=t(u,0,[1,0],"02")}catch{throw new Error("malformed PKCS#8 DSA public key")}this.setPublicHex(f,v,c,g)},this.readCertPubKeyHex=function(u,f){var v,c,g,x;if(r(u)===!1)throw new Error("not ASN.1 hex string");try{v=t(u,0,[0,5,0,1,0],"02"),c=t(u,0,[0,5,0,1,1],"02"),g=t(u,0,[0,5,0,1,2],"02"),x=t(u,0,[0,5,1,0],"02")}catch{throw new Error("malformed X.509 certificate DSA public key")}this.setPublicHex(v,c,g,x)}};var Ae=(function(){var e=function(h,d,p){return n(O.AES,h,d,p)},t=function(h,d,p){return n(O.TripleDES,h,d,p)},r=function(h,d,p){return n(O.DES,h,d,p)},n=function(h,d,p,y){var I=O.enc.Hex.parse(d),K=O.enc.Hex.parse(p),L=O.enc.Hex.parse(y),W={};W.key=K,W.iv=L,W.ciphertext=I;var m=h.decrypt(W,K,{iv:L});return O.enc.Hex.stringify(m)},a=function(h,d,p){return f(O.AES,h,d,p)},i=function(h,d,p){return f(O.TripleDES,h,d,p)},u=function(h,d,p){return f(O.DES,h,d,p)},f=function(h,d,p,y){var I=O.enc.Hex.parse(d),K=O.enc.Hex.parse(p),L=O.enc.Hex.parse(y),W=h.encrypt(I,K,{iv:L}),m=O.enc.Hex.parse(W.toString()),w=O.enc.Base64.stringify(m);return w},v={"AES-256-CBC":{proc:e,eproc:a,keylen:32,ivlen:16},"AES-192-CBC":{proc:e,eproc:a,keylen:24,ivlen:16},"AES-128-CBC":{proc:e,eproc:a,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:t,eproc:i,keylen:24,ivlen:8},"DES-CBC":{proc:r,eproc:u,keylen:8,ivlen:8}},c=function(h){var d=O.lib.WordArray.random(h),p=O.enc.Hex.stringify(d);return p},g=function(h){var d={},p=h.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));p&&(d.cipher=p[1],d.ivsalt=p[2]);var y=h.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));y&&(d.type=y[1]);var I=-1,K=0;h.indexOf(`\r
\r
`)!=-1&&(I=h.indexOf(`\r
\r
`),K=2),h.indexOf(`

`)!=-1&&(I=h.indexOf(`

`),K=1);var L=h.indexOf("-----END");if(I!=-1&&L!=-1){var W=h.substring(I+K*2,L-K);W=W.replace(/\s+/g,""),d.data=W}return d},x=function(h,d,p){for(var y=p.substring(0,16),I=O.enc.Hex.parse(y),K=O.enc.Utf8.parse(d),L=v[h].keylen+v[h].ivlen,W="",m=null;;){var w=O.algo.MD5.create();if(m!=null&&w.update(m),w.update(K),w.update(I),m=w.finalize(),W=W+O.enc.Hex.stringify(m),W.length>=L*2)break}var E={};return E.keyhex=W.substr(0,v[h].keylen*2),E.ivhex=W.substr(v[h].keylen*2,v[h].ivlen*2),E},o=function(h,d,p,y){var I=O.enc.Base64.parse(h),K=O.enc.Hex.stringify(I),L=v[d].proc,W=L(K,p,y);return W},l=function(h,d,p,y){var I=v[d].eproc,K=I(h,p,y);return K};return{version:"1.0.0",parsePKCS5PEM:function(h){return g(h)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(h,d,p){return x(h,d,p)},decryptKeyB64:function(h,d,p,y){return o(h,d,p,y)},getDecryptedKeyHex:function(h,d){var p=g(h),y=p.cipher,I=p.ivsalt,K=p.data,L=x(y,d,I),W=L.keyhex,m=o(K,y,W,I);return m},getEncryptedPKCS5PEMFromPrvKeyHex:function(h,d,p,y,I){var S="";if((typeof y>"u"||y==null)&&(y="AES-256-CBC"),typeof v[y]>"u")throw new Error("KEYUTIL unsupported algorithm: "+y);if(typeof I>"u"||I==null){var K=v[y].ivlen,L=c(K);I=L.toUpperCase()}var W=x(y,p,I),m=W.keyhex,w=l(d,y,m,I),E=w.replace(/(.{64})/g,`$1\r
`),S="-----BEGIN "+h+` PRIVATE KEY-----\r
`;return S+=`Proc-Type: 4,ENCRYPTED\r
`,S+="DEK-Info: "+y+","+I+`\r
`,S+=`\r
`,S+=E,S+=`\r
-----END `+h+` PRIVATE KEY-----\r
`,S},getEncryptedPKCS8PEM:function(h,d,p){var y=this.getEncryptedPKCS8Hex(h,d,p);return rt(y,"ENCRYPTED PRIVATE KEY")},getEncryptedPKCS8Hex:function(h,d,p){var y;p==null||p==null?y={}:y=JSON.parse(JSON.stringify(p)),y.plain=h,this.initPBES2Param(y),this.encryptPBES2Param(y,d);var I=this.generatePBES2ASN1Param(y);return s.asn1.ASN1Util.newObject(I).tohex()},initPBES2Param:function(h){if(Oe(h,"encalg")==null&&(h.encalg="aes256-CBC"),Oe(h,"iter")==null&&(h.iter=2048),Oe(h,"prf")==null&&(h.prf="hmacWithSHA256"),Oe(h,"salt")==null&&(h.salt=O.enc.Hex.stringify(O.lib.WordArray.random(8))),Oe(h,"enciv")==null){var d;h.encalg=="des-EDE3-CBC"&&(d=8),h.encalg=="aes128-CBC"&&(d=16),h.encalg=="aes256-CBC"&&(d=16),h.enciv=O.enc.Hex.stringify(O.lib.WordArray.random(d))}},encryptPBES2Param:function(h,d){var p=Ae.getDKFromPBES2Param(h,d);try{var y=s.crypto.Cipher.encrypt(h.plain,p,h.encalg,{iv:h.enciv})}catch{throw new Error("encrypt error: "+h.plain+" "+p+" "+h.encalg+" "+h.enciv)}h.enc=y},generatePBES2ASN1Param:function(h){var d={seq:[{seq:[{oid:"pkcs5PBES2"},{seq:[{seq:[{oid:"pkcs5PBKDF2"},{seq:[{octstr:{hex:h.salt}},{int:{hex:oi(h.iter)}}]}]},{seq:[{oid:h.encalg},{octstr:{hex:h.enciv}}]}]}]},{octstr:{hex:h.enc}}]};return h.prf!="hmacWithSHA1"&&d.seq[0].seq[1].seq[0].seq[1].seq.push({seq:[{oid:h.prf},{null:""}]}),d},parseHexOfEncryptedPKCS8:function(h){var d=ve,p=d.getChildIdx,y=d.getV,I={},K=p(h,0);if(K.length!=2)throw new Error("malformed format: SEQUENCE(0).items != 2: "+K.length);I.ciphertext=y(h,K[1]);var L=p(h,K[0]);if(L.length!=2)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+L.length);if(y(h,L[0])!="2a864886f70d01050d")throw new Error("this only supports pkcs5PBES2");var W=p(h,L[1]);if(L.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+W.length);var m=p(h,W[1]);if(m.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+m.length);if(y(h,m[0])!="2a864886f70d0307")throw"this only supports TripleDES";I.encryptionSchemeAlg="TripleDES",I.encryptionSchemeIV=y(h,m[1]);var w=p(h,W[0]);if(w.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+w.length);if(y(h,w[0])!="2a864886f70d01050c")throw new Error("this only supports pkcs5PBKDF2");var E=p(h,w[1]);if(E.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+E.length);I.pbkdf2Salt=y(h,E[0]);var S=y(h,E[1]);try{I.pbkdf2Iter=parseInt(S,16)}catch{throw new Error("malformed format pbkdf2Iter: "+S)}return I},getPBKDF2KeyHexFromParam:function(h,d){var p=O.enc.Hex.parse(h.pbkdf2Salt),y=h.pbkdf2Iter,I=O.PBKDF2(d,p,{keySize:192/32,iterations:y}),K=O.enc.Hex.stringify(I);return K},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(h,d){var p=ze(h,"ENCRYPTED PRIVATE KEY"),y=this.parseHexOfEncryptedPKCS8(p),I=Ae.getPBKDF2KeyHexFromParam(y,d),K={};K.ciphertext=O.enc.Hex.parse(y.ciphertext);var L=O.enc.Hex.parse(I),W=O.enc.Hex.parse(y.encryptionSchemeIV),m=O.TripleDES.decrypt(K,L,{iv:W}),w=O.enc.Hex.stringify(m);return w},parsePBES2:function(h){var d=ve.parse(h);if(Oe(d,"seq.0.seq.0.oid")!="pkcs5PBES2"||Oe(d,"seq.0.seq.1.seq.0.seq.0.oid")!="pkcs5PBKDF2")throw new Error("not pkcs5PBES2 and pkcs5PBKDF2 used");var p=Oe(d,"seq.0.seq.1.seq.0.seq.1.seq");if(p==null)throw new Error("PBKDF2 parameter not found");var y=Oe(p,"0.octstr.hex"),I=Oe(p,"1.int.hex"),K=Oe(p,"2.seq.0.oid","hmacWithSHA1"),L=-1;try{L=parseInt(I,16)}catch{throw new Error("iter not proper value")}var W=Oe(d,"seq.0.seq.1.seq.1.seq.0.oid"),m=Oe(d,"seq.0.seq.1.seq.1.seq.1.octstr.hex"),w=Oe(d,"seq.1.octstr.hex");if(W==null||m==null||w==null)throw new Error("encalg, enciv or enc is undefined");var E={salt:y,iter:L,prf:K,encalg:W,enciv:m,enc:w};return E},getDKFromPBES2Param:function(h,d){var p={hmacWithSHA1:O.algo.SHA1,hmacWithSHA224:O.algo.SHA224,hmacWithSHA256:O.algo.SHA256,hmacWithSHA384:O.algo.SHA384,hmacWithSHA512:O.algo.SHA512},y={"des-EDE3-CBC":192/32,"aes128-CBC":128/32,"aes256-CBC":256/32},I=p[h.prf];if(I==null)throw new Error("unsupported prf");var K=y[h.encalg];if(K==null)throw new Error("unsupported encalg");var L=O.enc.Hex.parse(h.salt),W=h.iter;try{var m=O.PBKDF2(d,L,{keySize:K,iterations:W,hasher:I});return O.enc.Hex.stringify(m)}catch(w){throw new Error("PBKDF2 error: "+w+" "+JSON.stringify(h)+" "+d)}},getPlainHexFromEncryptedPKCS8PEM:function(h,d){if(h.indexOf("BEGIN ENCRYPTED PRIVATE KEY")==-1)throw new Error("not Encrypted PKCS#8 PEM string");var p=ze(h),y;try{y=Ae.parsePBES2(p)}catch(K){throw new Error("malformed PBES2 format: "+K.message)}var I=Ae.getDKFromPBES2Param(y,d);return s.crypto.Cipher.decrypt(y.enc,I,y.encalg,{iv:y.enciv})},getKeyFromEncryptedPKCS8PEM:function(h,d){var p=this.getPlainHexFromEncryptedPKCS8PEM(h,d),y=this.getKeyFromPlainPrivatePKCS8Hex(p);return y},parsePlainPrivatePKCS8Hex:function(h){var d=ve,p=d.getChildIdx,y=d.getV,I={};if(I.algparam=null,h.substr(0,2)!="30")throw new Error("malformed plain PKCS8 private key(code:001)");var K=p(h,0);if(K.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if(h.substr(K[1],2)!="30")throw new Error("malformed PKCS8 private key(code:003)");var L=p(h,K[1]);if(L.length!=2)throw new Error("malformed PKCS8 private key(code:004)");if(h.substr(L[0],2)!="06")throw new Error("malformed PKCS8 private key(code:005)");if(I.algoid=y(h,L[0]),h.substr(L[1],2)=="06"&&(I.algparam=y(h,L[1])),h.substr(K[2],2)!="04")throw new Error("malformed PKCS8 private key(code:006)");return I.keyidx=d.getVidx(h,K[2]),I},getKeyFromPlainPrivatePKCS8PEM:function(h){var d=ze(h,"PRIVATE KEY"),p=this.getKeyFromPlainPrivatePKCS8Hex(d);return p},getKeyFromPlainPrivatePKCS8Hex:function(h){var d=this.parsePlainPrivatePKCS8Hex(h),p;if(d.algoid=="2a864886f70d010101")p=new we;else if(d.algoid=="2a8648ce380401")p=new s.crypto.DSA;else if(d.algoid=="2a8648ce3d0201")p=new s.crypto.ECDSA;else throw new Error("unsupported private key algorithm");return p.readPKCS8PrvKeyHex(h),p},_getKeyFromPublicPKCS8Hex:function(h){var d,p=ve.getVbyList(h,0,[0,0],"06");if(p==="2a864886f70d010101")d=new we;else if(p==="2a8648ce380401")d=new s.crypto.DSA;else if(p==="2a8648ce3d0201")d=new s.crypto.ECDSA;else throw new Error("unsupported PKCS#8 public key hex");return d.readPKCS8PubKeyHex(h),d},parsePublicRawRSAKeyHex:function(h){var d=ve,p=d.getChildIdx,y=d.getV,I={};if(h.substr(0,2)!="30")throw new Error("malformed RSA key(code:001)");var K=p(h,0);if(K.length!=2)throw new Error("malformed RSA key(code:002)");if(h.substr(K[0],2)!="02")throw new Error("malformed RSA key(code:003)");if(I.n=y(h,K[0]),h.substr(K[1],2)!="02")throw new Error("malformed RSA key(code:004)");return I.e=y(h,K[1]),I},parsePublicPKCS8Hex:function(h){var d=ve,p=d.getChildIdx,y=d.getV,I={};I.algparam=null;var K=p(h,0);if(K.length!=2)throw new Error("outer DERSequence shall have 2 elements: "+K.length);var L=K[0];if(h.substr(L,2)!="30")throw new Error("malformed PKCS8 public key(code:001)");var W=p(h,L);if(W.length!=2)throw new Error("malformed PKCS8 public key(code:002)");if(h.substr(W[0],2)!="06")throw new Error("malformed PKCS8 public key(code:003)");if(I.algoid=y(h,W[0]),h.substr(W[1],2)=="06"?I.algparam=y(h,W[1]):h.substr(W[1],2)=="30"&&(I.algparam={},I.algparam.p=d.getVbyList(h,W[1],[0],"02"),I.algparam.q=d.getVbyList(h,W[1],[1],"02"),I.algparam.g=d.getVbyList(h,W[1],[2],"02")),h.substr(K[1],2)!="03")throw new Error("malformed PKCS8 public key(code:004)");return I.key=y(h,K[1]).substr(2),I}}})();Ae.getKey=function(e,t,r){var n=ve,a=n.getChildIdx;n.getV;var i=n.getVbyList,u=s.crypto,f=u.ECDSA,v=u.DSA,c=we,g=ze,x=Ae;if(typeof c<"u"&&e instanceof c||typeof f<"u"&&e instanceof f||typeof v<"u"&&e instanceof v)return e;if(e.curve!==void 0&&e.xy!==void 0&&e.d===void 0)return new f({pub:e.xy,curve:e.curve});if(e.curve!==void 0&&e.d!==void 0)return new f({prv:e.d,curve:e.curve});if(e.kty===void 0&&e.n!==void 0&&e.e!==void 0&&e.d===void 0){var o=new c;return o.setPublic(e.n,e.e),o}if(e.kty===void 0&&e.n!==void 0&&e.e!==void 0&&e.d!==void 0&&e.p!==void 0&&e.q!==void 0&&e.dp!==void 0&&e.dq!==void 0&&e.co!==void 0&&e.qi===void 0){var o=new c;return o.setPrivateEx(e.n,e.e,e.d,e.p,e.q,e.dp,e.dq,e.co),o}if(e.kty===void 0&&e.n!==void 0&&e.e!==void 0&&e.d!==void 0&&e.p===void 0){var o=new c;return o.setPrivate(e.n,e.e,e.d),o}if(e.p!==void 0&&e.q!==void 0&&e.g!==void 0&&e.y!==void 0&&e.x===void 0){var o=new v;return o.setPublic(e.p,e.q,e.g,e.y),o}if(e.p!==void 0&&e.q!==void 0&&e.g!==void 0&&e.y!==void 0&&e.x!==void 0){var o=new v;return o.setPrivate(e.p,e.q,e.g,e.y,e.x),o}if(e.kty==="RSA"&&e.n!==void 0&&e.e!==void 0&&e.d===void 0){var o=new c;return o.setPublic(ke(e.n),ke(e.e)),o}if(e.kty==="RSA"&&e.n!==void 0&&e.e!==void 0&&e.d!==void 0&&e.p!==void 0&&e.q!==void 0&&e.dp!==void 0&&e.dq!==void 0&&e.qi!==void 0){var o=new c;return o.setPrivateEx(ke(e.n),ke(e.e),ke(e.d),ke(e.p),ke(e.q),ke(e.dp),ke(e.dq),ke(e.qi)),o}if(e.kty==="RSA"&&e.n!==void 0&&e.e!==void 0&&e.d!==void 0){var o=new c;return o.setPrivate(ke(e.n),ke(e.e),ke(e.d)),o}if(e.kty==="EC"&&e.crv!==void 0&&e.x!==void 0&&e.y!==void 0&&e.d===void 0){var l=new f({curve:e.crv}),h=l.ecparams.keycharlen,d=("0000000000"+ke(e.x)).slice(-h),p=("0000000000"+ke(e.y)).slice(-h),y="04"+d+p;return l.setPublicKeyHex(y),l}if(e.kty==="EC"&&e.crv!==void 0&&e.x!==void 0&&e.y!==void 0&&e.d!==void 0){var l=new f({curve:e.crv}),h=l.ecparams.keycharlen,d=("0000000000"+ke(e.x)).slice(-h),p=("0000000000"+ke(e.y)).slice(-h),y="04"+d+p,I=("0000000000"+ke(e.d)).slice(-h);return l.setPublicKeyHex(y),l.setPrivateKeyHex(I),l}if(r==="pkcs5prv"){var K=e,n=ve,L,o;if(L=a(K,0),L.length===9)o=new c,o.readPKCS5PrvKeyHex(K);else if(L.length===6)o=new v,o.readPKCS5PrvKeyHex(K);else if(L.length>2&&K.substr(L[1],2)==="04")o=new f,o.readPKCS5PrvKeyHex(K);else throw new Error("unsupported PKCS#1/5 hexadecimal key");return o}if(r==="pkcs8prv"){var o=x.getKeyFromPlainPrivatePKCS8Hex(e);return o}if(r==="pkcs8pub")return x._getKeyFromPublicPKCS8Hex(e);if(r==="x509pub")return be.getPublicKeyFromCertHex(e);if(e.indexOf("-END CERTIFICATE-",0)!=-1||e.indexOf("-END X509 CERTIFICATE-",0)!=-1||e.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return be.getPublicKeyFromCertPEM(e);if(e.indexOf("-END PUBLIC KEY-")!=-1){var W=ze(e,"PUBLIC KEY");return x._getKeyFromPublicPKCS8Hex(W)}if(e.indexOf("-END RSA PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")==-1){var m=g(e,"RSA PRIVATE KEY");return x.getKey(m,null,"pkcs5prv")}if(e.indexOf("-END DSA PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")==-1){var w=g(e,"DSA PRIVATE KEY"),E=i(w,0,[1],"02"),S=i(w,0,[2],"02"),P=i(w,0,[3],"02"),U=i(w,0,[4],"02"),X=i(w,0,[5],"02"),o=new v;return o.setPrivate(new b(E,16),new b(S,16),new b(P,16),new b(U,16),new b(X,16)),o}if(e.indexOf("-END EC PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")==-1){var m=g(e,"EC PRIVATE KEY");return x.getKey(m,null,"pkcs5prv")}if(e.indexOf("-END PRIVATE KEY-")!=-1)return x.getKeyFromPlainPrivatePKCS8PEM(e);if(e.indexOf("-END RSA PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")!=-1){var fe=x.getDecryptedKeyHex(e,t),G=new we;return G.readPKCS5PrvKeyHex(fe),G}if(e.indexOf("-END EC PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")!=-1){var w=x.getDecryptedKeyHex(e,t),o=i(w,0,[1],"04"),ee=i(w,0,[2,0],"06"),he=i(w,0,[3,0],"03").substr(2),le="";if(s.crypto.OID.oidhex2name[ee]!==void 0)le=s.crypto.OID.oidhex2name[ee];else throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+ee);var l=new f({curve:le});return l.setPublicKeyHex(he),l.setPrivateKeyHex(o),l.isPublic=!1,l}if(e.indexOf("-END DSA PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")!=-1){var w=x.getDecryptedKeyHex(e,t),E=i(w,0,[1],"02"),S=i(w,0,[2],"02"),P=i(w,0,[3],"02"),U=i(w,0,[4],"02"),X=i(w,0,[5],"02"),o=new v;return o.setPrivate(new b(E,16),new b(S,16),new b(P,16),new b(U,16),new b(X,16)),o}if(e.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return x.getKeyFromEncryptedPKCS8PEM(e,t);throw new Error("not supported argument")},Ae.generateKeypair=function(e,t){if(e=="RSA"){var r=t,n=new we;n.generate(r,"10001"),n.isPrivate=!0,n.isPublic=!0;var a=new we,i=n.n.toString(16),u=n.e.toString(16);a.setPublic(i,u),a.isPrivate=!1,a.isPublic=!0;var f={};return f.prvKeyObj=n,f.pubKeyObj=a,f}else if(e=="EC"){var v=t,c=new s.crypto.ECDSA({curve:v}),g=c.generateKeyPairHex(),n=new s.crypto.ECDSA({curve:v});n.setPublicKeyHex(g.ecpubhex),n.setPrivateKeyHex(g.ecprvhex),n.isPrivate=!0,n.isPublic=!1;var a=new s.crypto.ECDSA({curve:v});a.setPublicKeyHex(g.ecpubhex),a.isPrivate=!1,a.isPublic=!0;var f={};return f.prvKeyObj=n,f.pubKeyObj=a,f}else throw new Error("unknown algorithm: "+e)},Ae.getPEM=function(e,t,r,n,a,i){var u=s,f=u.asn1,v=f.DERObjectIdentifier,c=f.DERInteger,g=f.ASN1Util.newObject,x=f.x509,o=x.SubjectPublicKeyInfo,l=u.crypto,h=l.DSA,d=l.ECDSA,p=we;function y(ee){var he=g({seq:[{int:0},{int:{bigint:ee.n}},{int:ee.e},{int:{bigint:ee.d}},{int:{bigint:ee.p}},{int:{bigint:ee.q}},{int:{bigint:ee.dmp1}},{int:{bigint:ee.dmq1}},{int:{bigint:ee.coeff}}]});return he}function I(ee){var he=g({seq:[{int:1},{octstr:{hex:ee.prvKeyHex}},{tag:["a0",!0,{oid:{name:ee.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+ee.pubKeyHex}}]}]});return he}function K(ee){var he=g({seq:[{int:0},{int:{bigint:ee.p}},{int:{bigint:ee.q}},{int:{bigint:ee.g}},{int:{bigint:ee.y}},{int:{bigint:ee.x}}]});return he}if((p!==void 0&&e instanceof p||h!==void 0&&e instanceof h||d!==void 0&&e instanceof d)&&e.isPublic==!0&&(t===void 0||t=="PKCS8PUB")){var L=new o(e),W=L.tohex();return rt(W,"PUBLIC KEY")}if(t=="PKCS1PRV"&&p!==void 0&&e instanceof p&&(r===void 0||r==null)&&e.isPrivate==!0){var L=y(e),W=L.tohex();return rt(W,"RSA PRIVATE KEY")}if(t=="PKCS1PRV"&&d!==void 0&&e instanceof d&&(r===void 0||r==null)&&e.isPrivate==!0){var m=new v({name:e.curveName}),w=m.tohex(),E=I(e),S=E.tohex(),P="";return P+=rt(w,"EC PARAMETERS"),P+=rt(S,"EC PRIVATE KEY"),P}if(t=="PKCS1PRV"&&h!==void 0&&e instanceof h&&(r===void 0||r==null)&&e.isPrivate==!0){var L=K(e),W=L.tohex();return rt(W,"DSA PRIVATE KEY")}if(t=="PKCS5PRV"&&p!==void 0&&e instanceof p&&r!==void 0&&r!=null&&e.isPrivate==!0){var L=y(e),W=L.tohex();return n===void 0&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",W,r,n,i)}if(t=="PKCS5PRV"&&d!==void 0&&e instanceof d&&r!==void 0&&r!=null&&e.isPrivate==!0){var L=I(e),W=L.tohex();return n===void 0&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",W,r,n,i)}if(t=="PKCS5PRV"&&h!==void 0&&e instanceof h&&r!==void 0&&r!=null&&e.isPrivate==!0){var L=K(e),W=L.tohex();return n===void 0&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",W,r,n,i)}var U=function(ee,he){if(typeof he=="string")return Ae.getEncryptedPKCS8PEM(ee,he);if(typeof he=="object"&&Oe(he,"passcode")!=null){var le=JSON.parse(JSON.stringify(he)),nt=le.passcode;return delete le.passcode,Ae.getEncryptedPKCS8PEM(ee,nt,le)}};if(t=="PKCS8PRV"&&p!=null&&e instanceof p&&e.isPrivate==!0){var X=y(e),fe=X.tohex(),L=g({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:fe}}]}),W=L.tohex();return r===void 0||r==null?rt(W,"PRIVATE KEY"):U(W,r)}if(t=="PKCS8PRV"&&d!==void 0&&e instanceof d&&e.isPrivate==!0){var G={seq:[{int:1},{octstr:{hex:e.prvKeyHex}}]};typeof e.pubKeyHex=="string"&&G.seq.push({tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]});var X=new g(G),fe=X.tohex(),L=g({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:e.curveName}}]},{octstr:{hex:fe}}]}),W=L.tohex();return r===void 0||r==null?rt(W,"PRIVATE KEY"):U(W,r)}if(t=="PKCS8PRV"&&h!==void 0&&e instanceof h&&e.isPrivate==!0){var X=new c({bigint:e.x}),fe=X.tohex(),L=g({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}}]}]},{octstr:{hex:fe}}]}),W=L.tohex();return r===void 0||r==null?rt(W,"PRIVATE KEY"):U(W,r)}throw new Error("unsupported object nor format")},Ae.getKeyFromCSRPEM=function(e){var t=ze(e,"CERTIFICATE REQUEST"),r=Ae.getKeyFromCSRHex(t);return r},Ae.getKeyFromCSRHex=function(e){var t=Ae.parseCSRHex(e),r=Ae.getKey(t.p8pubkeyhex,null,"pkcs8pub");return r},Ae.parseCSRHex=function(e){var t=ve,r=t.getChildIdx,n=t.getTLV,a={},i=e;if(i.substr(0,2)!="30")throw new Error("malformed CSR(code:001)");var u=r(i,0);if(u.length<1)throw new Error("malformed CSR(code:002)");if(i.substr(u[0],2)!="30")throw new Error("malformed CSR(code:003)");var f=r(i,u[0]);if(f.length<3)throw new Error("malformed CSR(code:004)");return a.p8pubkeyhex=n(i,f[2]),a},Ae.getKeyID=function(e){var t=Ae,r=ve;typeof e=="string"&&e.indexOf("BEGIN ")!=-1&&(e=t.getKey(e));var n=ze(t.getPEM(e)),a=r.getIdxbyList(n,0,[1]),i=r.getV(n,a).substring(2);return s.crypto.Util.hashHex(i,"sha1")},Ae.getJWK=function(e,t,r,n,a){var i,u={},f,v=s.crypto.Util.hashHex;if(typeof e=="string")i=Ae.getKey(e),e.indexOf("CERTIFICATE")!=-1&&(f=ze(e));else if(typeof e=="object")e instanceof be?(i=e.getPublicKey(),f=e.hex):i=e;else throw new Error("unsupported keyinfo type");if(i instanceof we&&i.isPrivate)u.kty="RSA",u.n=Ye(i.n.toString(16)),u.e=Ye(i.e.toString(16)),u.d=Ye(i.d.toString(16)),u.p=Ye(i.p.toString(16)),u.q=Ye(i.q.toString(16)),u.dp=Ye(i.dmp1.toString(16)),u.dq=Ye(i.dmq1.toString(16)),u.qi=Ye(i.coeff.toString(16));else if(i instanceof we&&i.isPublic)u.kty="RSA",u.n=Ye(i.n.toString(16)),u.e=Ye(i.e.toString(16));else if(i instanceof s.crypto.ECDSA&&i.isPrivate){var c=i.getShortNISTPCurveName();if(c!=="P-256"&&c!=="P-384"&&c!=="P-521")throw new Error("unsupported curve name for JWT: "+c);var g=i.getPublicKeyXYHex();u.kty="EC",u.crv=c,u.x=Ye(g.x),u.y=Ye(g.y),u.d=Ye(i.prvKeyHex)}else if(i instanceof s.crypto.ECDSA&&i.isPublic){var c=i.getShortNISTPCurveName();if(c!=="P-256"&&c!=="P-384"&&c!=="P-521")throw new Error("unsupported curve name for JWT: "+c);var g=i.getPublicKeyXYHex();u.kty="EC",u.crv=c,u.x=Ye(g.x),u.y=Ye(g.y)}if(u.kty==null)throw new Error("unsupported keyinfo");return!i.isPrivate&&t!=!0&&(u.kid=s.jws.JWS.getJWKthumbprint(u)),f!=null&&r!=!0&&(u.x5c=[N(f)]),f!=null&&n!=!0&&(u.x5t=zt(N(v(f,"sha1")))),f!=null&&a!=!0&&(u["x5t#S256"]=zt(N(v(f,"sha256")))),u},Ae.getJWKFromKey=function(e){return Ae.getJWK(e,!0,!0,!0,!0)},we.getPosArrayOfChildrenFromHex=function(e){return ve.getChildIdx(e,0)},we.getHexValueArrayOfChildrenFromHex=function(e){var t=ve,r=t.getV,o=we.getPosArrayOfChildrenFromHex(e),n=r(e,o[0]),a=r(e,o[1]),i=r(e,o[2]),u=r(e,o[3]),f=r(e,o[4]),v=r(e,o[5]),c=r(e,o[6]),g=r(e,o[7]),x=r(e,o[8]),o=new Array;return o.push(n,a,i,u,f,v,c,g,x),o},we.prototype.readPrivateKeyFromPEMString=function(e){var t=ze(e),r=we.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8])},we.prototype.readPKCS5PrvKeyHex=function(e){var t=we.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},we.prototype.readPKCS8PrvKeyHex=function(e){var t,r,n,a,i,u,f,v,c=ve,g=c.getVbyListEx;if(c.isASN1HEX(e)===!1)throw new Error("not ASN.1 hex string");try{t=g(e,0,[2,0,1],"02"),r=g(e,0,[2,0,2],"02"),n=g(e,0,[2,0,3],"02"),a=g(e,0,[2,0,4],"02"),i=g(e,0,[2,0,5],"02"),u=g(e,0,[2,0,6],"02"),f=g(e,0,[2,0,7],"02"),v=g(e,0,[2,0,8],"02")}catch{throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(t,r,n,a,i,u,f,v)},we.prototype.readPKCS5PubKeyHex=function(e){var t=ve,r=t.getV;if(t.isASN1HEX(e)===!1)throw new Error("keyHex is not ASN.1 hex string");var n=t.getChildIdx(e,0);if(n.length!==2||e.substr(n[0],2)!=="02"||e.substr(n[1],2)!=="02")throw new Error("wrong hex for PKCS#5 public key");var a=r(e,n[0]),i=r(e,n[1]);this.setPublic(a,i)},we.prototype.readPKCS8PubKeyHex=function(e){var t=ve;if(t.isASN1HEX(e)===!1)throw new Error("not ASN.1 hex string");if(t.getTLVbyListEx(e,0,[0,0])!=="06092a864886f70d010101")throw new Error("not PKCS8 RSA public key");var r=t.getTLVbyListEx(e,0,[1,0]);this.readPKCS5PubKeyHex(r)},we.prototype.readCertPubKeyHex=function(e,t){var r,n;r=new be,r.readCertHex(e),n=r.getPublicKeyHex(),this.readPKCS8PubKeyHex(n)};function ci(e,t){for(var r="",n=t/4-e.length,a=0;a<n;a++)r=r+"0";return r+e}we.prototype.sign=function(e,t){var r=function(a){return s.crypto.Util.hashString(a,t)},n=r(e);return this.signWithMessageHash(n,t)},we.prototype.signWithMessageHash=function(e,t){var r=s.crypto.Util.getPaddedDigestInfoHex(e,t,this.n.bitLength()),n=ut(r,16),a=this.doPrivate(n),i=a.toString(16);return ci(i,this.n.bitLength())};function li(e,t,r){for(var n="",a=0;n.length<t;)n+=ht(r(bt(e+String.fromCharCode.apply(String,[(a&4278190080)>>24,(a&16711680)>>16,(a&65280)>>8,a&255])))),a+=1;return n}we.prototype.signPSS=function(e,t,r){var n=function(i){return s.crypto.Util.hashHex(i,t)},a=n(bt(e));return r===void 0&&(r=-1),this.signWithMessageHashPSS(a,t,r)},we.prototype.signWithMessageHashPSS=function(e,t,r){var n=ht(e),a=n.length,i=this.n.bitLength()-1,u=Math.ceil(i/8),f,v=function(p){return s.crypto.Util.hashHex(p,t)};if(r===-1||r===void 0)r=a;else if(r===-2)r=u-a-2;else if(r<-2)throw new Error("invalid salt length");if(u<a+r+2)throw new Error("data too long");var c="";r>0&&(c=new Array(r),new Ut().nextBytes(c),c=String.fromCharCode.apply(String,c));var g=ht(v(bt("\0\0\0\0\0\0\0\0"+n+c))),x=[];for(f=0;f<u-r-a-2;f+=1)x[f]=0;var o=String.fromCharCode.apply(String,x)+""+c,l=li(g,o.length,v),h=[];for(f=0;f<o.length;f+=1)h[f]=o.charCodeAt(f)^l.charCodeAt(f);var d=65280>>8*u-i&255;for(h[0]&=~d,f=0;f<a;f++)h.push(g.charCodeAt(f));return h.push(188),ci(this.doPrivate(new b(h)).toString(16),this.n.bitLength())};function di(e){for(var t in s.crypto.Util.DIGESTINFOHEAD){var r=s.crypto.Util.DIGESTINFOHEAD[t],n=r.length;if(e.substring(0,n)==r){var a=[t,e.substring(n)];return a}}return[]}we.prototype.verify=function(e,t){if(t=t.toLowerCase(),t.match(/^[0-9a-f]+$/)==null)return!1;var r=ut(t,16),n=this.n.bitLength();if(r.bitLength()>n)return!1;var a=this.doPublic(r),i=a.toString(16);if(i.length+3!=n/4)return!1;var u=i.replace(/^1f+00/,""),f=di(u);if(f.length==0)return!1;var v=f[0],c=f[1],g=function(o){return s.crypto.Util.hashString(o,v)},x=g(e);return c==x},we.prototype.verifyWithMessageHash=function(e,t){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var r=ut(t,16);if(r.bitLength()>this.n.bitLength())return 0;var n=this.doPublic(r),a=n.toString(16).replace(/^1f+00/,""),i=di(a);if(i.length==0)return!1;i[0];var u=i[1];return u==e},we.prototype.verifyPSS=function(e,t,r,n){var a=function(u){return s.crypto.Util.hashHex(u,r)},i=a(bt(e));return n===void 0&&(n=-1),this.verifyWithMessageHashPSS(i,t,r,n)},we.prototype.verifyWithMessageHashPSS=function(e,t,r,n){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var a=new b(t,16),i=function(I){return s.crypto.Util.hashHex(I,r)},u=ht(e),f=u.length,v=this.n.bitLength()-1,c=Math.ceil(v/8),g;if(n===-1||n===void 0)n=f;else if(n===-2)n=c-f-2;else if(n<-2)throw new Error("invalid salt length");if(c<f+n+2)throw new Error("data too long");var x=this.doPublic(a).toByteArray();for(g=0;g<x.length;g+=1)x[g]&=255;for(;x.length<c;)x.unshift(0);if(x[c-1]!==188)throw new Error("encoded message does not end in 0xbc");x=String.fromCharCode.apply(String,x);var o=x.substr(0,c-f-1),l=x.substr(o.length,f),h=65280>>8*c-v&255;if((o.charCodeAt(0)&h)!==0)throw new Error("bits beyond keysize not zero");var d=li(l,o.length,i),p=[];for(g=0;g<o.length;g+=1)p[g]=o.charCodeAt(g)^d.charCodeAt(g);p[0]&=~h;var y=c-f-n-2;for(g=0;g<y;g+=1)if(p[g]!==0)throw new Error("leftmost octets not zero");if(p[y]!==1)throw new Error("0x01 marker not found");return l===ht(i(bt("\0\0\0\0\0\0\0\0"+u+String.fromCharCode.apply(String,p.slice(-n)))))},we.SALT_LEN_HLEN=-1,we.SALT_LEN_MAX=-2,we.SALT_LEN_RECOVER=-2;function be(e){var t=ve,r=t.getChildIdx,n=t.getV;t.dump;var a=t.parse,i=t.getTLV,u=t.getVbyList,f=t.getVbyListEx,v=t.getTLVbyList,c=t.getTLVbyListEx,g=t.getIdxbyList,x=t.getIdxbyListEx,o=t.getVidx,l=t.getInt,h=t.oidname,d=t.hextooidstr,p=ze,y,I=Error;try{y=s.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch{}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(this.hex===null||this.version!==0)return this.version;var m=v(this.hex,0,[0,0]);if(m.substr(0,2)=="a0"){var w=v(m,0,[0]),E=l(w,0);if(E<0||2<E)throw new Error("malformed version field");return this.version=E+1,this.version}else return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return f(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var m=c(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(m)},this.getAlgorithmIdentifierName=function(m){for(var w in y)if(m===y[w])return w;return h(f(m,0,[0],"06"))},this.getIssuer=function(m,w){return this.getX500Name(this.getIssuerHex(),m,w)},this.getIssuerHex=function(){return v(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){var m=this.getIssuer();return m.str},this.getSubject=function(m,w){return this.getX500Name(this.getSubjectHex(),m,w)},this.getSubjectHex=function(){return v(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){var m=this.getSubject();return m.str},this.getNotBefore=function(){var m=u(this.hex,0,[0,4+this.foffset,0]);return m=m.replace(/(..)/g,"%$1"),m=decodeURIComponent(m),m},this.getNotAfter=function(){var m=u(this.hex,0,[0,4+this.foffset,1]);return m=m.replace(/(..)/g,"%$1"),m=decodeURIComponent(m),m},this.getPublicKeyHex=function(){return this.getSPKI()},this.getSPKI=function(){return v(this.hex,0,[0,6+this.foffset],"30")},this.getSPKIValue=function(){var m=this.getSPKI();return m==null?null:u(m,0,[1],"03",!0)},this.getPublicKeyIdx=function(){return g(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var m=this.getPublicKeyIdx();return g(this.hex,m,[1,0],"30")},this.getPublicKey=function(){return Ae.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var m=v(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(m)},this.getSignatureValueHex=function(){return u(this.hex,0,[2],"03",!0)},this.verifySignature=function(m){var w=this.getSignatureAlgorithmField(),E=this.getSignatureValueHex(),S=v(this.hex,0,[0],"30"),P=new s.crypto.Signature({alg:w});return P.init(m),P.updateHex(S),P.verify(E)},this.parseExt=function(m){var w,E,S;if(m===void 0){if(S=this.hex,this.version!==3)return-1;w=g(S,0,[0,7,0],"30"),E=r(S,w)}else{S=ze(m);var P=g(S,0,[0,3,0,0],"06");if(n(S,P)!="2a864886f70d01090e"){this.aExtInfo=new Array;return}w=g(S,0,[0,3,0,1,0],"30"),E=r(S,w),this.hex=S}this.aExtInfo=new Array;for(var U=0;U<E.length;U++){var X={};X.critical=!1;var fe=r(S,E[U]),G=0;fe.length===3&&(X.critical=!0,G=1),X.oid=t.hextooidstr(u(S,E[U],[0],"06"));var ee=g(S,E[U],[1+G]);X.vidx=o(S,ee),this.aExtInfo.push(X)}},this.getExtInfo=function(m){var w=this.aExtInfo,E=m;if(m.match(/^[0-9.]+$/)||(E=s.asn1.x509.OID.name2oid(m)),E!==""){for(var S=0;S<w.length;S++)if(w[S].oid===E)return w[S]}},this.getCriticalExtV=function(m,w,E){if(w!=null)return[w,E];var S=this.getExtInfo(m);return S==null?[null,null]:[i(this.hex,S.vidx),S.critical]},this.getExtBasicConstraints=function(m,w){if(m===void 0&&w===void 0){var E=this.getExtInfo("basicConstraints");if(E===void 0)return;m=i(this.hex,E.vidx),w=E.critical}var S={extname:"basicConstraints"};if(w&&(S.critical=!0),m==="3000")return S;if(m==="30030101ff")return S.cA=!0,S;if(m.substr(0,12)==="30060101ff02"){var P=n(m,10),U=parseInt(P,16);return S.cA=!0,S.pathLen=U,S}throw new Error("hExtV parse error: "+m)},this.getExtNameConstraints=function(m,w){var E=this.getCriticalExtV("nameConstraints",m,w);if(m=E[0],w=E[1],m!=null){var S={extname:"nameConstraints"};w&&(S.critical=!0);for(var P=r(m,0),U=0;U<P.length;U++){for(var X=[],fe=r(m,P[U]),G=0;G<fe.length;G++){var ee=i(m,fe[G]),he=this.getGeneralSubtree(ee);X.push(he)}var le=m.substr(P[U],2);le=="a0"?S.permit=X:le=="a1"&&(S.exclude=X)}return S}},this.getGeneralSubtree=function(m){var w=r(m,0),E=w.length;if(E<1||2<E)throw new Error("wrong num elements");for(var S=this.getGeneralName(i(m,w[0])),P=1;P<E;P++){var U=m.substr(w[P],2),X=n(m,w[P]),fe=parseInt(X,16);U=="80"&&(S.min=fe),U=="81"&&(S.max=fe)}return S},this.getExtKeyUsage=function(m,w){var E=this.getCriticalExtV("keyUsage",m,w);if(m=E[0],w=E[1],m!=null){var S={extname:"keyUsage"};return w&&(S.critical=!0),S.names=this.getExtKeyUsageString(m).split(","),S}},this.getExtKeyUsageBin=function(m){if(m===void 0){var w=this.getExtInfo("keyUsage");if(w===void 0)return"";m=i(this.hex,w.vidx)}if(m.length!=8&&m.length!=10)throw new Error("malformed key usage value: "+m);var E="000000000000000"+parseInt(m.substr(6),16).toString(2);return m.length==8&&(E=E.slice(-8)),m.length==10&&(E=E.slice(-16)),E=E.replace(/0+$/,""),E==""&&(E="0"),E},this.getExtKeyUsageString=function(m){for(var w=this.getExtKeyUsageBin(m),E=new Array,S=0;S<w.length;S++)w.substr(S,1)=="1"&&E.push(be.KEYUSAGE_NAME[S]);return E.join(",")},this.getExtSubjectKeyIdentifier=function(m,w){if(m===void 0&&w===void 0){var E=this.getExtInfo("subjectKeyIdentifier");if(E===void 0)return;m=i(this.hex,E.vidx),w=E.critical}var S={extname:"subjectKeyIdentifier"};w&&(S.critical=!0);var P=n(m,0);return S.kid={hex:P},S},this.getExtAuthorityKeyIdentifier=function(m,w){if(m===void 0&&w===void 0){var E=this.getExtInfo("authorityKeyIdentifier");if(E===void 0)return;m=i(this.hex,E.vidx),w=E.critical}var S={extname:"authorityKeyIdentifier"};w&&(S.critical=!0);for(var P=r(m,0),U=0;U<P.length;U++){var X=m.substr(P[U],2);if(X==="80"&&(S.kid={hex:n(m,P[U])}),X==="a1"){var fe=i(m,P[U]),G=this.getGeneralNames(fe);S.issuer=G[0].dn}X==="82"&&(S.sn={hex:n(m,P[U])})}return S},this.getExtExtKeyUsage=function(m,w){if(m===void 0&&w===void 0){var E=this.getExtInfo("extKeyUsage");if(E===void 0)return;m=i(this.hex,E.vidx),w=E.critical}var S={extname:"extKeyUsage",array:[]};w&&(S.critical=!0);for(var P=r(m,0),U=0;U<P.length;U++)S.array.push(h(n(m,P[U])));return S},this.getExtExtKeyUsageName=function(){var m=this.getExtInfo("extKeyUsage");if(m===void 0)return m;var w=new Array,E=i(this.hex,m.vidx);if(E==="")return w;for(var S=r(E,0),P=0;P<S.length;P++)w.push(h(n(E,S[P])));return w},this.getExtSubjectAltName=function(m,w){if(m===void 0&&w===void 0){var E=this.getExtInfo("subjectAltName");if(E===void 0)return;m=i(this.hex,E.vidx),w=E.critical}var S={extname:"subjectAltName",array:[]};return w&&(S.critical=!0),S.array=this.getGeneralNames(m),S},this.getExtIssuerAltName=function(m,w){if(m===void 0&&w===void 0){var E=this.getExtInfo("issuerAltName");if(E===void 0)return;m=i(this.hex,E.vidx),w=E.critical}var S={extname:"issuerAltName",array:[]};return w&&(S.critical=!0),S.array=this.getGeneralNames(m),S},this.getGeneralNames=function(m){for(var w=r(m,0),E=[],S=0;S<w.length;S++){var P=this.getGeneralName(i(m,w[S]));P!==void 0&&E.push(P)}return E},this.getGeneralName=function(m){var w=m.substr(0,2),E=n(m,0),S=ht(E);if(w=="81")return{rfc822:S};if(w=="82")return{dns:S};if(w=="86")return{uri:S};if(w=="87")return{ip:Er(E)};if(w=="a4")return{dn:this.getX500Name(E)};if(w=="a0")return{other:this.getOtherName(m)}},this.getExtSubjectAltName2=function(){var m,w,E,S=this.getExtInfo("subjectAltName");if(S===void 0)return S;for(var P=new Array,U=i(this.hex,S.vidx),X=r(U,0),fe=0;fe<X.length;fe++)E=U.substr(X[fe],2),m=n(U,X[fe]),E==="81"&&(w=He(m),P.push(["MAIL",w])),E==="82"&&(w=He(m),P.push(["DNS",w])),E==="84"&&(w=be.hex2dn(m,0),P.push(["DN",w])),E==="86"&&(w=He(m),P.push(["URI",w])),E==="87"&&(w=Er(m),P.push(["IP",w]));return P},this.getExtCRLDistributionPoints=function(m,w){if(m===void 0&&w===void 0){var E=this.getExtInfo("cRLDistributionPoints");if(E===void 0)return;m=i(this.hex,E.vidx),w=E.critical}var S={extname:"cRLDistributionPoints",array:[]};w&&(S.critical=!0);for(var P=r(m,0),U=0;U<P.length;U++){var X=i(m,P[U]);S.array.push(this.getDistributionPoint(X))}return S},this.getDistributionPoint=function(m){for(var w={},E=r(m,0),S=0;S<E.length;S++){var P=m.substr(E[S],2),U=i(m,E[S]);P=="a0"&&(w.dpname=this.getDistributionPointName(U))}return w},this.getDistributionPointName=function(m){for(var w={},E=r(m,0),S=0;S<E.length;S++){var P=m.substr(E[S],2),U=i(m,E[S]);P=="a0"&&(w.full=this.getGeneralNames(U))}return w},this.getExtCRLDistributionPointsURI=function(){var m=this.getExtCRLDistributionPoints();if(m==null)return m;for(var w=m.array,E=[],S=0;S<w.length;S++)try{w[S].dpname.full[0].uri!=null&&E.push(w[S].dpname.full[0].uri)}catch{}return E},this.getExtAIAInfo=function(){var m=this.getExtInfo("authorityInfoAccess");if(m===void 0)return m;for(var w={ocsp:[],caissuer:[]},E=r(this.hex,m.vidx),S=0;S<E.length;S++){var P=u(this.hex,E[S],[0],"06"),U=u(this.hex,E[S],[1],"86");P==="2b06010505073001"&&w.ocsp.push(He(U)),P==="2b06010505073002"&&w.caissuer.push(He(U))}return w},this.getExtAuthorityInfoAccess=function(m,w){if(m===void 0&&w===void 0){var E=this.getExtInfo("authorityInfoAccess");if(E===void 0)return;m=i(this.hex,E.vidx),w=E.critical}var S={extname:"authorityInfoAccess",array:[]};w&&(S.critical=!0);for(var P=r(m,0),U=0;U<P.length;U++){var X=f(m,P[U],[0],"06"),fe=u(m,P[U],[1],"86"),G=He(fe);if(X=="2b06010505073001")S.array.push({ocsp:G});else if(X=="2b06010505073002")S.array.push({caissuer:G});else throw new Error("unknown method: "+X)}return S},this.getExtCertificatePolicies=function(m,w){if(m===void 0&&w===void 0){var E=this.getExtInfo("certificatePolicies");if(E===void 0)return;m=i(this.hex,E.vidx),w=E.critical}var S={extname:"certificatePolicies",array:[]};w&&(S.critical=!0);for(var P=r(m,0),U=0;U<P.length;U++){var X=i(m,P[U]),fe=this.getPolicyInformation(X);S.array.push(fe)}return S},this.getPolicyInformation=function(m){var w={},E=u(m,0,[0],"06");w.policyoid=h(E);var S=x(m,0,[1],"30");if(S!=-1){w.array=[];for(var P=r(m,S),U=0;U<P.length;U++){var X=i(m,P[U]),fe=this.getPolicyQualifierInfo(X);w.array.push(fe)}}return w},this.getOtherName=function(m){var w={},E=r(m,0),S=u(m,E[0],[],"06"),P=u(m,E[1],[]);return w.oid=h(S),w.value=a(P),w},this.getPolicyQualifierInfo=function(m){var w={},E=u(m,0,[0],"06");if(E==="2b06010505070201"){var S=f(m,0,[1],"16");w.cps=ht(S)}else if(E==="2b06010505070202"){var P=v(m,0,[1],"30");w.unotice=this.getUserNotice(P)}return w},this.getUserNotice=function(m){var w=null;try{w=t.parse(m);var E=this._asn1ToUnotice(w);return E}catch{return}},this._asn1ToUnotice=function(m){try{for(var w={},E=Oe(m,"seq"),S=0;S<E.length;S++){var P=this._asn1ToNoticeRef(E[S]);P!=null&&(w.noticeref=P);var U=this.asn1ToDisplayText(E[S]);U!=null&&(w.exptext=U)}return Object.keys(w).length>0?w:void 0}catch{return}},this._asn1ToNoticeRef=function(m){try{for(var w={},E=Oe(m,"seq"),S=0;S<E.length;S++){var P=this._asn1ToNoticeNum(E[S]);P!=null&&(w.noticenum=P);var U=this.asn1ToDisplayText(E[S]);U!=null&&(w.org=U)}return Object.keys(w).length>0?w:void 0}catch{return}},this._asn1ToNoticeNum=function(m){try{for(var w=Oe(m,"seq"),E=[],S=0;S<w.length;S++){var P=w[S];E.push(parseInt(Oe(P,"int.hex"),16))}return E}catch{return}},this.getDisplayText=function(m){var w={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"},E={};return E.type=w[m.substr(0,2)],E.str=ht(n(m,0)),E},this.asn1ToDisplayText=function(m){if(m.utf8str!=null)return{type:"utf8",str:m.utf8str.str};if(m.ia5str!=null)return{type:"ia5",str:m.ia5str.str};if(m.visstr!=null)return{type:"vis",str:m.visstr.str};if(m.bmpstr!=null)return{type:"bmp",str:m.bmpstr.str};if(m.prnstr!=null)return{type:"prn",str:m.prnstr.str}},this.getExtPolicyMappings=function(m,w){var E=this.getCriticalExtV("policyMappings",m,w);if(m=E[0],w=E[1],m!=null){var S={extname:"policyMappings"};w&&(S.critical=!0);try{for(var P=a(m),U=P.seq,X=[],fe=0;fe<U.length;fe++){var G=U[fe].seq;X.push([G[0].oid,G[1].oid])}S.array=X}catch{throw new I("malformed policyMappings")}return S}},this.getExtPolicyConstraints=function(m,w){var E=this.getCriticalExtV("policyConstraints",m,w);if(m=E[0],w=E[1],m!=null){var S={extname:"policyConstraints"};w&&(S.critical=!0);var P=a(m);try{for(var U=P.seq,X=0;X<U.length;X++){var fe=U[X].tag;fe.explicit==!1&&(fe.tag=="80"&&(S.reqexp=parseInt(fe.hex,16)),fe.tag=="81"&&(S.inhibit=parseInt(fe.hex,16)))}}catch{return new I("malformed policyConstraints value")}return S}},this.getExtInhibitAnyPolicy=function(m,w){var E=this.getCriticalExtV("inhibitAnyPolicy",m,w);if(m=E[0],w=E[1],m!=null){var S={extname:"inhibitAnyPolicy"};w&&(S.critical=!0);var P=l(m,0);return P==-1?new I("wrong value"):(S.skip=P,S)}},this.getExtCRLNumber=function(m,w){var E={extname:"cRLNumber"};if(w&&(E.critical=!0),m.substr(0,2)=="02")return E.num={hex:n(m,0)},E;throw new I("hExtV parse error: "+m)},this.getExtCRLReason=function(m,w){var E={extname:"cRLReason"};if(w&&(E.critical=!0),m.substr(0,2)=="0a")return E.code=parseInt(n(m,0),16),E;throw new Error("hExtV parse error: "+m)},this.getExtOcspNonce=function(m,w){var E={extname:"ocspNonce"};w&&(E.critical=!0);var S=n(m,0);return E.hex=S,E},this.getExtOcspNoCheck=function(m,w){var E={extname:"ocspNoCheck"};return w&&(E.critical=!0),E},this.getExtAdobeTimeStamp=function(m,w){if(m===void 0&&w===void 0){var E=this.getExtInfo("adobeTimeStamp");if(E===void 0)return;m=i(this.hex,E.vidx),w=E.critical}var S={extname:"adobeTimeStamp"};w&&(S.critical=!0);var P=r(m,0);if(P.length>1){var U=i(m,P[1]),X=this.getGeneralName(U);X.uri!=null&&(S.uri=X.uri)}if(P.length>2){var fe=i(m,P[2]);fe=="0101ff"&&(S.reqauth=!0),fe=="010100"&&(S.reqauth=!1)}return S},this.getExtSubjectDirectoryAttributes=function(m,w){if(m===void 0&&w===void 0){var E=this.getExtInfo("subjectDirectoryAttributes");if(E===void 0)return;m=i(this.hex,E.vidx),w=E.critical}var S={extname:"subjectDirectoryAttributes"};w&&(S.critical=!0);try{for(var P=a(m),U=[],X=0;X<P.seq.length;X++){var fe=P.seq[X],G=Oe(fe,"seq.0.oid"),ee=Oe(fe,"seq.1.set");if(G==null||ee==null)throw"error";U.push({attr:G,array:ee})}return S.array=U,S}catch{throw new Error("malformed subjectDirectoryAttributes extension value")}};var K=function(m){var w={};try{var E=m.seq[0].oid,S=s.asn1.x509.OID.name2oid(E);w.type=s.asn1.x509.OID.oid2atype(S);var P=m.seq[1];if(P.utf8str!=null)w.ds="utf8",w.value=P.utf8str.str;else if(P.numstr!=null)w.ds="num",w.value=P.numstr.str;else if(P.telstr!=null)w.ds="tel",w.value=P.telstr.str;else if(P.prnstr!=null)w.ds="prn",w.value=P.prnstr.str;else if(P.ia5str!=null)w.ds="ia5",w.value=P.ia5str.str;else if(P.visstr!=null)w.ds="vis",w.value=P.visstr.str;else if(P.bmpstr!=null)w.ds="bmp",w.value=P.bmpstr.str;else throw"error";return w}catch{throw new Erorr("improper ASN.1 parsed AttrTypeAndValue")}},L=function(m){try{return m.set.map(function(w){return K(w)})}catch(w){throw new Error("improper ASN.1 parsed RDN: "+w)}},W=function(m){try{return m.seq.map(function(w){return L(w)})}catch(w){throw new Error("improper ASN.1 parsed X500Name: "+w)}};this.getX500NameRule=function(m){for(var w=null,E=[],S=0;S<m.length;S++)for(var P=m[S],U=0;U<P.length;U++)E.push(P[U]);for(var S=0;S<E.length;S++){var X=E[S],fe=X.ds,G=X.value,ee=X.type;if(fe!="prn"&&fe!="utf8"&&fe!="ia5")return"mixed";if(fe=="ia5"){if(ee!="CN")return"mixed";if(s.lang.String.isMail(G))continue;return"mixed"}if(ee=="C"){if(fe=="prn")continue;return"mixed"}if(w==null)w=fe;else if(w!==fe)return"mixed"}return w??"prn"},this.getAttrTypeAndValue=function(m){var w=a(m);return K(w)},this.getRDN=function(m){var w=a(m);return L(w)},this.getX500NameArray=function(m){var w=a(m);return W(w)},this.getX500Name=function(m,w,E){var S=this.getX500NameArray(m),P=this.dnarraytostr(S),U={str:P};return U.array=S,E==!0&&(U.hex=m),w==!0&&(U.canon=this.c14nRDNArray(S)),U},this.readCertPEM=function(m){this.readCertHex(p(m))},this.readCertHex=function(m){this.hex=m,this.getVersion();try{g(this.hex,0,[0,7],"a3"),this.parseExt()}catch{}},this.getParam=function(m){var w={};return m==null&&(m={}),w.version=this.getVersion(),w.serial={hex:this.getSerialNumberHex()},w.sigalg=this.getSignatureAlgorithmField(),w.issuer=this.getIssuer(m.dncanon,m.dnhex),w.notbefore=this.getNotBefore(),w.notafter=this.getNotAfter(),w.subject=this.getSubject(m.dncanon,m.dnhex),w.sbjpubkey=rt(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo!=null&&this.aExtInfo.length>0&&(w.ext=this.getExtParamArray()),w.sighex=this.getSignatureValueHex(),m.tbshex==!0&&(w.tbshex=v(this.hex,0,[0])),m.nodnarray==!0&&(delete w.issuer.array,delete w.subject.array),w},this.getExtParamArray=function(m){if(m==null){var w=x(this.hex,0,[0,"[3]"]);w!=-1&&(m=c(this.hex,0,[0,"[3]",0],"30"))}for(var E=[],S=r(m,0),P=0;P<S.length;P++){var U=i(m,S[P]),X=this.getExtParam(U);X!=null&&E.push(X)}return E},this.getExtParam=function(m){var w=r(m,0),E=w.length;if(E!=2&&E!=3)throw new Error("wrong number elements in Extension: "+E+" "+m);var S=d(u(m,0,[0],"06")),P=!1;E==3&&v(m,0,[1])=="0101ff"&&(P=!0);var U=v(m,0,[E-1,0]),X=void 0;if(S=="2.5.29.14"?X=this.getExtSubjectKeyIdentifier(U,P):S=="2.5.29.15"?X=this.getExtKeyUsage(U,P):S=="2.5.29.17"?X=this.getExtSubjectAltName(U,P):S=="2.5.29.18"?X=this.getExtIssuerAltName(U,P):S=="2.5.29.19"?X=this.getExtBasicConstraints(U,P):S=="2.5.29.30"?X=this.getExtNameConstraints(U,P):S=="2.5.29.31"?X=this.getExtCRLDistributionPoints(U,P):S=="2.5.29.32"?X=this.getExtCertificatePolicies(U,P):S=="2.5.29.33"?X=this.getExtPolicyMappings(U,P):S=="2.5.29.35"?X=this.getExtAuthorityKeyIdentifier(U,P):S=="2.5.29.36"?X=this.getExtPolicyConstraints(U,P):S=="2.5.29.37"?X=this.getExtExtKeyUsage(U,P):S=="2.5.29.54"?X=this.getExtInhibitAnyPolicy(U,P):S=="1.3.6.1.5.5.7.1.1"?X=this.getExtAuthorityInfoAccess(U,P):S=="2.5.29.20"?X=this.getExtCRLNumber(U,P):S=="2.5.29.21"?X=this.getExtCRLReason(U,P):S=="2.5.29.9"?X=this.getExtSubjectDirectoryAttributes(U,P):S=="1.3.6.1.5.5.7.48.1.2"?X=this.getExtOcspNonce(U,P):S=="1.3.6.1.5.5.7.48.1.5"?X=this.getExtOcspNoCheck(U,P):S=="1.2.840.113583.1.1.9.1"?X=this.getExtAdobeTimeStamp(U,P):be.EXT_PARSER[S]!=null&&(X=be.EXT_PARSER[S](S,P,U)),X!=null)return X;var fe={extname:S,extn:U};try{fe.extn=a(U)}catch{}return P&&(fe.critical=!0),fe},this.findExt=function(m,w){for(var E=0;E<m.length;E++)if(m[E].extname==w)return m[E];return null},this.updateExtCDPFullURI=function(m,w){var E=this.findExt(m,"cRLDistributionPoints");if(E!=null&&E.array!=null){for(var S=E.array,P=0;P<S.length;P++)if(S[P].dpname!=null&&S[P].dpname.full!=null)for(var U=S[P].dpname.full,X=0;X<U.length;X++){var fe=U[P];fe.uri!=null&&(fe.uri=w)}}},this.updateExtAIAOCSP=function(m,w){var E=this.findExt(m,"authorityInfoAccess");if(E!=null&&E.array!=null)for(var S=E.array,P=0;P<S.length;P++)S[P].ocsp!=null&&(S[P].ocsp=w)},this.updateExtAIACAIssuer=function(m,w){var E=this.findExt(m,"authorityInfoAccess");if(E!=null&&E.array!=null)for(var S=E.array,P=0;P<S.length;P++)S[P].caissuer!=null&&(S[P].caissuer=w)},this.dnarraytostr=function(m){function w(S){return S.map(function(P){return E(P).replace(/\+/,"\\+")}).join("+")}function E(S){return S.type+"="+S.value}return"/"+m.map(function(S){return w(S).replace(/\//,"\\/")}).join("/")},this.setCanonicalizedDN=function(m){var w;if(m.str!=null&&m.array==null){var E=new s.asn1.x509.X500Name({str:m.str}),S=E.tohex();w=this.getX500NameArray(S)}else w=m.array;m.canon==null&&(m.canon=this.c14nRDNArray(w))},this.c14nRDNArray=function(m){for(var w=[],E=0;E<m.length;E++){for(var S=m[E],P=[],U=0;U<S.length;U++){var X=S[U],fe=X.value;fe=fe.replace(/^\s*/,""),fe=fe.replace(/\s*$/,""),fe=fe.replace(/\s+/g," "),fe=fe.toLowerCase(),P.push(X.type.toLowerCase()+"="+fe)}w.push(P.join("+"))}return"/"+w.join("/")},this.getInfo=function(){var m=function(at){for(var De="",Ne="    ",Ke=`
`,Me=at.array,ct=0;ct<Me.length;ct++){var We=Me[ct];if(We.dn!=null&&(De+=Ne+"dn: "+We.dn.str+Ke),We.ip!=null&&(De+=Ne+"ip: "+We.ip+Ke),We.rfc822!=null&&(De+=Ne+"rfc822: "+We.rfc822+Ke),We.dns!=null&&(De+=Ne+"dns: "+We.dns+Ke),We.uri!=null&&(De+=Ne+"uri: "+We.uri+Ke),We.other!=null){var rr=We.other.oid,jt=JSON.stringify(We.other.value).replace(/\"/g,"");De+=Ne+"other: "+rr+"="+jt+Ke}}return De=De.replace(/\n$/,""),De},w=function(at){for(var De="",Ne=at.array,Ke=0;Ke<Ne.length;Ke++){var Me=Ne[Ke];if(De+="    policy oid: "+Me.policyoid+`
`,Me.array!==void 0)for(var ct=0;ct<Me.array.length;ct++){var We=Me.array[ct];We.cps!==void 0&&(De+="    cps: "+We.cps+`
`)}}return De},E=function(at){for(var De="",Ne=at.array,Ke=0;Ke<Ne.length;Ke++){var Me=Ne[Ke];try{Me.dpname.full[0].uri!==void 0&&(De+="    "+Me.dpname.full[0].uri+`
`)}catch{}try{Me.dname.full[0].dn.hex!==void 0&&(De+="    "+be.hex2dn(Me.dpname.full[0].dn.hex)+`
`)}catch{}}return De},S=function(at){for(var De="",Ne=at.array,Ke=0;Ke<Ne.length;Ke++){var Me=Ne[Ke];Me.caissuer!==void 0&&(De+="    caissuer: "+Me.caissuer+`
`),Me.ocsp!==void 0&&(De+="    ocsp: "+Me.ocsp+`
`)}return De},P,U,X;if(P=`Basic Fields
`,P+="  serial number: "+this.getSerialNumberHex()+`
`,P+="  signature algorithm: "+this.getSignatureAlgorithmField()+`
`,P+="  issuer: "+this.getIssuerString()+`
`,P+="  notBefore: "+this.getNotBefore()+`
`,P+="  notAfter: "+this.getNotAfter()+`
`,P+="  subject: "+this.getSubjectString()+`
`,P+=`  subject public key info: 
`,U=this.getPublicKey(),P+="    key algorithm: "+U.type+`
`,U.type==="RSA"&&(P+="    n="+Tn(U.n.toString(16)).substr(0,16)+`...
`,P+="    e="+Tn(U.e.toString(16))+`
`),X=this.aExtInfo,X!=null){P+=`X509v3 Extensions:
`;for(var fe=0;fe<X.length;fe++){var G=X[fe],ee=s.asn1.x509.OID.oid2name(G.oid);ee===""&&(ee=G.oid);var he="";if(G.critical===!0&&(he="CRITICAL"),P+="  "+ee+" "+he+`:
`,ee==="basicConstraints"){var le=this.getExtBasicConstraints();le.cA===void 0?P+=`    {}
`:(P+="    cA=true",le.pathLen!==void 0&&(P+=", pathLen="+le.pathLen),P+=`
`)}else if(ee=="policyMappings"){var nt=this.getExtPolicyMappings().array,Le=nt.map(function(at){var De=at;return De[0]+":"+De[1]}).join(", ");P+="    "+Le+`
`}else if(ee=="policyConstraints"){var je=this.getExtPolicyConstraints();P+="    ",je.reqexp!=null&&(P+=" reqexp="+je.reqexp),je.inhibit!=null&&(P+=" inhibit="+je.inhibit),P+=`
`}else if(ee=="inhibitAnyPolicy"){var je=this.getExtInhibitAnyPolicy();P+="    skip="+je.skip+`
`}else if(ee=="keyUsage")P+="    "+this.getExtKeyUsageString()+`
`;else if(ee=="subjectKeyIdentifier")P+="    "+this.getExtSubjectKeyIdentifier().kid.hex+`
`;else if(ee=="authorityKeyIdentifier"){var Ge=this.getExtAuthorityKeyIdentifier();Ge.kid!==void 0&&(P+="    kid="+Ge.kid.hex+`
`)}else if(ee=="extKeyUsage"){var Je=this.getExtExtKeyUsage().array;P+="    "+Je.join(", ")+`
`}else if(ee=="subjectAltName"){var et=m(this.getExtSubjectAltName());P+=et+`
`}else if(ee=="cRLDistributionPoints"){var Qe=this.getExtCRLDistributionPoints();P+=E(Qe)}else if(ee=="authorityInfoAccess"){var tr=this.getExtAuthorityInfoAccess();P+=S(tr)}else ee=="certificatePolicies"&&(P+=w(this.getExtCertificatePolicies()))}}return P+="signature algorithm: "+this.getSignatureAlgorithmName()+`
`,P+="signature: "+this.getSignatureValueHex().substr(0,16)+`...
`,P},typeof e=="string"&&(e.indexOf("-----BEGIN")!=-1?this.readCertPEM(e):s.lang.String.isHex(e)&&this.readCertHex(e))}be.EXT_PARSER={},be.registExtParser=function(e,t){be.EXT_PARSER[e]=t},be.hex2dn=function(e,t){t===void 0&&(t=0);var r=new be;ve.getTLV(e,t);var n=r.getX500Name(e);return n.str},be.hex2rdn=function(e,t){if(t===void 0&&(t=0),e.substr(t,2)!=="31")throw new Error("malformed RDN");for(var r=new Array,n=ve.getChildIdx(e,t),a=0;a<n.length;a++)r.push(be.hex2attrTypeValue(e,n[a]));return r=r.map(function(i){return i.replace("+","\\+")}),r.join("+")},be.hex2attrTypeValue=function(e,t){var r=ve,n=r.getV;if(t===void 0&&(t=0),e.substr(t,2)!=="30")throw new Error("malformed attribute type and value");var a=r.getChildIdx(e,t);a.length!==2||e.substr(a[0],2);var i=n(e,a[0]),u=s.asn1.ASN1Util.oidHexToInt(i),f=s.asn1.x509.OID.oid2atype(u),v=n(e,a[1]),c=ht(v);return f+"="+c},be.getPublicKeyFromCertHex=function(e){var t=new be;return t.readCertHex(e),t.getPublicKey()},be.getPublicKeyFromCertPEM=function(e){var t=new be;return t.readCertPEM(e),t.getPublicKey()},be.getPublicKeyInfoPropOfCertPEM=function(e){var t=ve,r=t.getVbyList,n={},a,i;return n.algparam=null,a=new be,a.readCertPEM(e),i=a.getPublicKeyHex(),n.keyhex=r(i,0,[1],"03").substr(2),n.algoid=r(i,0,[0,0],"06"),n.algoid==="2a8648ce3d0201"&&(n.algparam=r(i,0,[0,1],"06")),n},be.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];var qa=function(e){var t=s,r=t.lang.String.isHex,n=ve,a=n.getV,i=n.getTLV,u=n.getVbyList,f=n.getTLVbyList,v=n.getTLVbyListEx,c=n.getIdxbyList,g=n.getIdxbyListEx,x=n.getChildIdx,o=new be;this.hex=null,this.posSigAlg=null,this.posRevCert=null,this.parsed=null,this._setPos=function(){var l=c(this.hex,0,[0,0]),h=this.hex.substr(l,2);if(h=="02")this.posSigAlg=1;else if(h=="30")this.posSigAlg=0;else throw new Error("malformed 1st item of TBSCertList: "+h);var d=c(this.hex,0,[0,this.posSigAlg+3]),p=this.hex.substr(d,2);if(p=="17"||p=="18"){var y,I;y=c(this.hex,0,[0,this.posSigAlg+4]),this.posRevCert=null,y!=-1&&(I=this.hex.substr(y,2),I=="30"&&(this.posRevCert=this.posSigAlg+4))}else if(p=="30")this.posRevCert=this.posSigAlg+3;else if(p=="a0")this.posRevCert=null;else throw new Error("malformed nextUpdate or revCert tag: "+p)},this.getVersion=function(){return this.posSigAlg==0?null:parseInt(u(this.hex,0,[0,0],"02"),16)+1},this.getSignatureAlgorithmField=function(){var l=f(this.hex,0,[0,this.posSigAlg],"30");return o.getAlgorithmIdentifierName(l)},this.getIssuer=function(){return o.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return f(this.hex,0,[0,this.posSigAlg+1],"30")},this.getThisUpdate=function(){var l=u(this.hex,0,[0,this.posSigAlg+2]);return result=ht(l)},this.getNextUpdate=function(){var l=c(this.hex,0,[0,this.posSigAlg+3]),h=this.hex.substr(l,2);return h!="17"&&h!="18"?null:ht(a(this.hex,l))},this.getRevCertArray=function(){if(this.posRevCert==null)return null;for(var l=[],h=c(this.hex,0,[0,this.posRevCert]),d=x(this.hex,h),p=0;p<d.length;p++){var y=i(this.hex,d[p]);l.push(this.getRevCert(y))}return l},this.getRevCert=function(l){var h={},d=x(l,0);return h.sn={hex:u(l,0,[0],"02")},h.date=ht(u(l,0,[1])),d.length==3&&(h.ext=o.getExtParamArray(f(l,0,[2]))),h},this.findRevCert=function(l){var h=new be(l),d=h.getSerialNumberHex();return this.findRevCertBySN(d)},this.findRevCertBySN=function(l){if(this.parsed==null&&this.getParam(),this.parsed.revcert==null)return null;for(var h=this.parsed.revcert,d=0;d<h.length;d++)if(l==h[d].sn.hex)return h[d];return null},this.getSignatureValueHex=function(){return u(this.hex,0,[2],"03",!0)},this.verifySignature=function(l){var h=this.getSignatureAlgorithmField(),d=this.getSignatureValueHex(),p=f(this.hex,0,[0],"30"),y=new s.crypto.Signature({alg:h});return y.init(l),y.updateHex(p),y.verify(d)},this.getParam=function(l){var h={},d=this.getVersion();d!=null&&(h.version=d),h.sigalg=this.getSignatureAlgorithmField(),h.issuer=this.getIssuer(),h.thisupdate=this.getThisUpdate();var p=this.getNextUpdate();p!=null&&(h.nextupdate=p);var y=this.getRevCertArray();y!=null&&(h.revcert=y);var I=g(this.hex,0,[0,"[0]"]);if(I!=-1){var K=v(this.hex,0,[0,"[0]",0]);h.ext=o.getExtParamArray(K)}return h.sighex=this.getSignatureValueHex(),this.parsed=h,typeof l=="object"&&(l.tbshex==!0&&(h.tbshex=f(this.hex,0,[0])),l.nodnarray==!0&&delete h.issuer.array),h},typeof e=="string"&&(r(e)?this.hex=e:e.match(/-----BEGIN X509 CRL/)&&(this.hex=ze(e)),this._setPos())};return(typeof s>"u"||!s)&&(s={}),(typeof s.jws>"u"||!s.jws)&&(s.jws={}),s.jws.JWS=function(){var e=s,t=e.jws.JWS,r=t.isSafeJSONString;this.parseJWS=function(n,a){if(!(this.parsedJWS!==void 0&&(a||this.parsedJWS.sigvalH!==void 0))){var i=n.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(i==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var u=i[1],f=i[2],v=i[3],c=u+"."+f;if(this.parsedJWS={},this.parsedJWS.headB64U=u,this.parsedJWS.payloadB64U=f,this.parsedJWS.sigvalB64U=v,this.parsedJWS.si=c,!a){var g=ke(v),x=ut(g,16);this.parsedJWS.sigvalH=g,this.parsedJWS.sigvalBI=x}var o=gt(u),l=gt(f);if(this.parsedJWS.headS=o,this.parsedJWS.payloadS=l,!r(o,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+o}}},s.jws.JWS.sign=function(e,t,r,n,a){var i=s,u=i.jws,f=u.JWS,v=f.readSafeJSONString,c=f.isSafeJSONString,g=i.crypto;g.ECDSA;var x=g.Mac,o=g.Signature,l=JSON,h,d,p;if(typeof t!="string"&&typeof t!="object")throw"spHeader must be JSON string or object: "+t;if(typeof t=="object"&&(d=t,h=l.stringify(d)),typeof t=="string"){if(h=t,!c(h))throw"JWS Head is not safe JSON string: "+h;d=v(h)}if(p=r,typeof r=="object"&&(p=l.stringify(r)),(e==""||e==null)&&d.alg!==void 0&&(e=d.alg),e!=""&&e!=null&&d.alg===void 0&&(d.alg=e,h=l.stringify(d)),e!==d.alg)throw"alg and sHeader.alg doesn't match: "+e+"!="+d.alg;var y=null;if(f.jwsalg2sigalg[e]===void 0)throw"unsupported alg name: "+e;y=f.jwsalg2sigalg[e];var I=Qt(h),K=Qt(p),L=I+"."+K,W="";if(y.substr(0,4)=="Hmac"){if(n===void 0)throw"mac key shall be specified for HS* alg";var m=new x({alg:y,prov:"cryptojs",pass:n});m.updateString(L),W=m.doFinal()}else if(y.indexOf("withECDSA")!=-1){var w=new o({alg:y});w.init(n,a),w.updateString(L);var E=w.sign();W=s.crypto.ECDSA.asn1SigToConcatSig(E)}else if(y!="none"){var w=new o({alg:y});w.init(n,a),w.updateString(L),W=w.sign()}var S=Ye(W);return L+"."+S},s.jws.JWS.verify=function(e,t,r){var n=s,a=n.jws,i=a.JWS,u=i.readSafeJSONString,f=n.crypto,v=f.ECDSA,c=f.Mac,g=f.Signature,x;if(typeof we!==void 0&&(x=we),!Rn(e))return!1;var o=e.split(".");if(o.length!==3)return!1;var l=o[0],h=o[1],d=l+"."+h,p=ke(o[2]),y=u(gt(o[0])),I=null,K=null;if(y.alg===void 0)throw"algorithm not specified in header";if(I=y.alg,K=I.substr(0,2),r!=null&&Object.prototype.toString.call(r)==="[object Array]"&&r.length>0){var L=":"+r.join(":")+":";if(L.indexOf(":"+I+":")==-1)throw"algorithm '"+I+"' not accepted in the list"}if(I!="none"&&t===null)throw"key shall be specified to verify.";if(typeof t=="string"&&t.indexOf("-----BEGIN ")!=-1&&(t=Ae.getKey(t)),(K=="RS"||K=="PS")&&!(t instanceof x))throw"key shall be a RSAKey obj for RS* and PS* algs";if(K=="ES"&&!(t instanceof v))throw"key shall be a ECDSA obj for ES* algs";var W=null;if(i.jwsalg2sigalg[y.alg]===void 0)throw"unsupported alg name: "+I;if(W=i.jwsalg2sigalg[I],W=="none")throw"not supported";if(W.substr(0,4)=="Hmac"){var m=null;if(t===void 0)throw"hexadecimal key shall be specified for HMAC";var w=new c({alg:W,pass:t});return w.updateString(d),m=w.doFinal(),p==m}else if(W.indexOf("withECDSA")!=-1){var E=null;try{E=v.concatSigToASN1Sig(p)}catch{return!1}var S=new g({alg:W});return S.init(t),S.updateString(d),S.verify(E)}else{var S=new g({alg:W});return S.init(t),S.updateString(d),S.verify(p)}},s.jws.JWS.parse=function(e){var t=e.split("."),r={},n,a,i;if(t.length!=2&&t.length!=3)throw"malformed sJWS: wrong number of '.' splitted elements";return n=t[0],a=t[1],t.length==3&&(i=t[2]),r.headerObj=s.jws.JWS.readSafeJSONString(gt(n)),r.payloadObj=s.jws.JWS.readSafeJSONString(gt(a)),r.headerPP=JSON.stringify(r.headerObj,null,"  "),r.payloadObj==null?r.payloadPP=gt(a):r.payloadPP=JSON.stringify(r.payloadObj,null,"  "),i!==void 0&&(r.sigHex=ke(i)),r},s.jws.JWS.verifyJWT=function(e,t,r){var n=s,a=n.jws,i=a.JWS,u=i.readSafeJSONString,f=i.inArray,v=i.includedArray;if(!Rn(e))return!1;var c=e.split(".");if(c.length!=3)return!1;var g=c[0],x=c[1];ke(c[2]);var o=u(gt(g)),l=u(gt(x));if(o.alg===void 0)return!1;if(r.alg===void 0)throw"acceptField.alg shall be specified";if(!f(o.alg,r.alg)||l.iss!==void 0&&typeof r.iss=="object"&&!f(l.iss,r.iss)||l.sub!==void 0&&typeof r.sub=="object"&&!f(l.sub,r.sub))return!1;if(l.aud!==void 0&&typeof r.aud=="object"){if(typeof l.aud=="string"){if(!f(l.aud,r.aud))return!1}else if(typeof l.aud=="object"&&!v(l.aud,r.aud))return!1}var h=a.IntDate.getNow();return r.verifyAt!==void 0&&typeof r.verifyAt=="number"&&(h=r.verifyAt),(r.gracePeriod===void 0||typeof r.gracePeriod!="number")&&(r.gracePeriod=0),!(l.exp!==void 0&&typeof l.exp=="number"&&l.exp+r.gracePeriod<h||l.nbf!==void 0&&typeof l.nbf=="number"&&h<l.nbf-r.gracePeriod||l.iat!==void 0&&typeof l.iat=="number"&&h<l.iat-r.gracePeriod||l.jti!==void 0&&r.jti!==void 0&&l.jti!==r.jti||!i.verify(e,t,r.alg))},s.jws.JWS.includedArray=function(e,t){var r=s.jws.JWS.inArray;if(e===null||typeof e!="object"||typeof e.length!="number")return!1;for(var n=0;n<e.length;n++)if(!r(e[n],t))return!1;return!0},s.jws.JWS.inArray=function(e,t){if(t===null||typeof t!="object"||typeof t.length!="number")return!1;for(var r=0;r<t.length;r++)if(t[r]==e)return!0;return!1},s.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",ES512:"SHA512withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},s.jws.JWS.isSafeJSONString=function(e,t,r){var n=null;try{return n=Zn(e),typeof n!="object"||n.constructor===Array?0:(t&&(t[r]=n),1)}catch{return 0}},s.jws.JWS.readSafeJSONString=function(e){var t=null;try{return t=Zn(e),typeof t!="object"||t.constructor===Array?null:t}catch{return null}},s.jws.JWS.getEncodedSignatureValueFromJWS=function(e){var t=e.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(t==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return t[1]},s.jws.JWS.getJWKthumbprint=function(e){if(e.kty!=="RSA"&&e.kty!=="EC"&&e.kty!=="oct")throw"unsupported algorithm for JWK Thumprint";var t="{";if(e.kty==="RSA"){if(typeof e.n!="string"||typeof e.e!="string")throw"wrong n and e value for RSA key";t+='"e":"'+e.e+'",',t+='"kty":"'+e.kty+'",',t+='"n":"'+e.n+'"}'}else if(e.kty==="EC"){if(typeof e.crv!="string"||typeof e.x!="string"||typeof e.y!="string")throw"wrong crv, x and y value for EC key";t+='"crv":"'+e.crv+'",',t+='"kty":"'+e.kty+'",',t+='"x":"'+e.x+'",',t+='"y":"'+e.y+'"}'}else if(e.kty==="oct"){if(typeof e.k!="string")throw"wrong k value for oct(symmetric) key";t+='"kty":"'+e.kty+'",',t+='"k":"'+e.k+'"}'}var r=bt(t),n=s.crypto.Util.hashHex(r,"sha256"),a=Ye(n);return a},s.jws.IntDate={},s.jws.IntDate.get=function(e){var t=s.jws.IntDate,r=t.getNow,n=t.getZulu;if(e=="now")return r();if(e=="now + 1hour")return r()+3600;if(e=="now + 1day")return r()+3600*24;if(e=="now + 1month")return r()+3600*24*30;if(e=="now + 1year")return r()+3600*24*365;if(e.match(/Z$/))return n(e);if(e.match(/^[0-9]+$/))return parseInt(e);throw"unsupported format: "+e},s.jws.IntDate.getZulu=function(e){return ti(e)},s.jws.IntDate.getNow=function(){var e=~~(new Date/1e3);return e},s.jws.IntDate.intDate2UTCString=function(e){var t=new Date(e*1e3);return t.toUTCString()},s.jws.IntDate.intDate2Zulu=function(e){var t=new Date(e*1e3),r=("0000"+t.getUTCFullYear()).slice(-4),n=("00"+(t.getUTCMonth()+1)).slice(-2),a=("00"+t.getUTCDate()).slice(-2),i=("00"+t.getUTCHours()).slice(-2),u=("00"+t.getUTCMinutes()).slice(-2),f=("00"+t.getUTCSeconds()).slice(-2);return r+n+a+i+u+f+"Z"},(typeof s>"u"||!s)&&(s={}),(typeof s.jws>"u"||!s.jws)&&(s.jws={}),s.jws.JWSJS=function(){var e=s,t=e.jws,r=t.JWS,n=r.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(a){this.init();var i=a.split(".");if(i.length!=3)throw"malformed input JWS";this.aHeader.push(i[0]),this.sPayload=i[1],this.aSignature.push(i[2])},this.addSignature=function(a,i,u,f){if(this.sPayload===void 0||this.sPayload===null)throw"there's no JSON-JS signature to add.";var v=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var c=s.jws.JWS.sign(a,i,this.sPayload,u,f),g=c.split("."),x=g[0],o=g[2];this.aHeader.push(g[0]),this.aSignature.push(g[2])}catch(l){throw this.aHeader.length>v&&this.aHeader.pop(),this.aSignature.length>v&&this.aSignature.pop(),"addSignature failed: "+l}},this.verifyAll=function(a){if(this.aHeader.length!==a.length||this.aSignature.length!==a.length)return!1;for(var i=0;i<a.length;i++){var u=a[i];if(u.length!==2)return!1;var f=this.verifyNth(i,u[0],u[1]);if(f===!1)return!1}return!0},this.verifyNth=function(a,i,u){if(this.aHeader.length<=a||this.aSignature.length<=a)return!1;var f=this.aHeader[a],v=this.aSignature[a],c=f+"."+this.sPayload+"."+v,g=!1;try{g=r.verify(c,i,u)}catch{return!1}return g},this.readJWSJS=function(a){if(typeof a=="string"){var i=n(a);if(i==null)throw"argument is not safe JSON object string";this.aHeader=i.headers,this.sPayload=i.payload,this.aSignature=i.signatures}else try{if(a.headers.length>0)this.aHeader=a.headers;else throw"malformed header";if(typeof a.payload=="string")this.sPayload=a.payload;else throw"malformed signatures";if(a.signatures.length>0)this.aSignature=a.signatures;else throw"malformed signatures"}catch(u){throw"malformed JWS-JS JSON object: "+u}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return this.aHeader.length==0?1:0}},pe.SecureRandom=Ut,pe.rng_seed_time=Fn,pe.BigInteger=b,pe.RSAKey=we,pe.ECDSA=s.crypto.ECDSA,pe.DSA=s.crypto.DSA,pe.Signature=s.crypto.Signature,pe.MessageDigest=s.crypto.MessageDigest,pe.Mac=s.crypto.Mac,pe.KEYUTIL=Ae,pe.ASN1HEX=ve,pe.X509=be,pe.X509CRL=qa,pe.CryptoJS=O,pe.b64tohex=k,pe.b64toBA=F,pe.ECFieldElementFp=Xe,pe.ECPointFp=Ie,pe.ECCurveFp=Ft,pe.stoBA=Jn,pe.BAtos=Qn,pe.BAtohex=yr,pe.stohex=ft,pe.stob64=ya,pe.stob64u=ma,pe.b64utos=Sa,pe.b64tob64u=zt,pe.b64utob64=Jt,pe.hex2b64=N,pe.hextob64u=Ye,pe.b64utohex=ke,pe.utf8tob64u=Qt,pe.b64utoutf8=gt,pe.utf8tob64=ba,pe.b64toutf8=wa,pe.utf8tohex=mr,pe.hextoutf8=He,pe.hextorstr=ht,pe.rstrtohex=bt,pe.hextob64=An,pe.hextob64nl=Aa,pe.b64nltohex=ei,pe.hextopem=rt,pe.pemtohex=ze,pe.hextoArrayBuffer=Ba,pe.ArrayBuffertohex=Pa,pe.zulutomsec=Cn,pe.msectozulu=Ia,pe.zulutosec=ti,pe.zulutodate=Ra,pe.datetozulu=Ta,pe.uricmptohex=br,pe.hextouricmp=wr,pe.ipv6tohex=Dn,pe.hextoipv6=Bn,pe.hextoip=Er,pe.iptohex=Pn,pe.ucs2hextoutf8=In,pe.encodeURIComponentAll=Fr,pe.newline_toUnix=Ha,pe.newline_toDos=Na,pe.hextoposhex=Tn,pe.intarystrtohex=_a,pe.strdiffidx=Oa,pe.oidtohex=ai,pe.hextooid=Ar,pe.strpad=Cr,pe.bitstrtoint=ui,pe.inttobitstr=fi,pe.bitstrtobinstr=hi,pe.binstrtobitstr=ja,pe.isBase64URLDot=Rn,pe.namearraytobinstr=Dr,pe.extendClass=ue,pe.foldnl=Sr,pe.b64topem=Ca,pe.pemtob64=Da,pe.timeogen=ri,pe.aryval=Oe,pe.inttohex=oi,pe.twoscompl=er,pe.KJUR=s,pe.crypto=s.crypto,pe.asn1=s.asn1,pe.jws=s.jws,pe.lang=s.lang,pe.VERSION=Y,pe.VERSION_FULL=T,pe}var so=io();const ho=Un(so);export{uo as C,no as a,ho as j,fo as s};
