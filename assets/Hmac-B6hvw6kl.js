import{u as T,i as z}from"./action-RBCHj6az.js";import{l as H,T as D}from"./tool-BehcEsnj.js";import{C as s,s as I}from"./vendor-crypto-BW6jiUfg.js";import{l as M,ay as k,Q as U,I as v,J as a,A as m,H as d,u,L,V as j,z as R,G as y,ap as J,y as w}from"./vendor-D2QpS8Sq.js";import"./vendor-lodash-BDISS5yc.js";import"./modulepreload-polyfill-B5Qt9EMX.js";import"./vendor-monaco-CZQ85J0D.js";const S=["md5","sha1","sha256","sha512","sm3","ripemd160"],V={md5:(r,t)=>s.HmacMD5(s.enc.Base64.parse(r.toBase64()),s.enc.Base64.parse(t.toBase64())).toString(),sha1:(r,t)=>s.HmacSHA1(s.enc.Base64.parse(r.toBase64()),s.enc.Base64.parse(t.toBase64())).toString(),sha256:(r,t)=>s.HmacSHA256(s.enc.Base64.parse(r.toBase64()),s.enc.Base64.parse(t.toBase64())).toString(),sha512:(r,t)=>s.HmacSHA512(s.enc.Base64.parse(r.toBase64()),s.enc.Base64.parse(t.toBase64())).toString(),sm3:(r,t)=>{const h=(l,n)=>l.length>=n?l:new Array(n-l.length+1).join("0")+l;let e=r.toHexString();const f=[];let _=e.length;_%2!==0&&(e=h(e,_+1)),_=e.length;for(let l=0;l<_;l+=2)f.push(parseInt(e.substr(l,2),16));return I.sm3(f,{key:t.toHexString()})},ripemd160:(r,t)=>s.HmacRIPEMD160(s.enc.Base64.parse(r.toBase64()),s.enc.Base64.parse(t.toBase64())).toString()},A=(r,t,h)=>{if(!Object.keys(V).includes(r))throw new Error(`hmac method 不存在: ${r}`);return V[r](t,h)},K=M({__name:"Hmac",async setup(r){let t,h;const e=T(([t,h]=k(()=>z({input:H(),secret:H("text"),is_uppercase:!1,multiple:!1})),t=await t,h(),t)),f=y(()=>["text"].includes(e.current.input.type)),_=y(()=>{const n={md5:"",sha1:"",sha256:"",sha512:"",sm3:"",ripemd160:""};if(e.current.input.text.isEmpty()||e.current.secret.text.isEmpty())return n;let o=!1;for(const i of S)try{if(e.current.input.text.isError())throw new Error(`input:${e.current.input.text.toString()}`);if(e.current.secret.text.isError())throw new Error(`secret:${e.current.secret.text.toString()}`);const c=l(i,e.current.input.text,e.current.secret.text,f.value&&e.current.multiple);n[i]=e.current.is_uppercase?c.toUpperCase():c.toLowerCase()}catch(c){o=!0,n[i]=$error(c)}return o||e.save(),n}),l=(n,o,i,c)=>c?o.toString().split(`
`).map(B=>A(n,D.fromString(B,o.encoding()),i)).join(`
`):A(n,o,i);return(n,o)=>{const i=d("TextInput"),c=d("HeightResize"),B=d("Bool"),b=d("Tooltip"),x=d("Align"),C=d("Display"),E=d("Textarea"),$=J("row");return U((w(),v("div",null,[a(x,{direction:"vertical"},{default:m(()=>[a(i,{class:"sectool-page-option",modelValue:u(e).current.secret,"onUpdate:modelValue":o[0]||(o[0]=p=>u(e).current.secret=p),"use-input":n.$t("hmac_secret"),allow:["text","hex","base64"]},null,8,["modelValue","use-input"]),a(C,null,{extra:m(()=>[a(x,null,{default:m(()=>[a(B,{size:"small",modelValue:u(e).current.is_uppercase,"onUpdate:modelValue":o[2]||(o[2]=p=>u(e).current.is_uppercase=p),border:"",label:n.$t("hmac_uppercase")},null,8,["modelValue","label"]),a(b,{content:n.$t("hmac_multiple_tooltip")},{default:m(()=>[a(B,{disabled:!f.value,size:"small",modelValue:u(e).current.multiple,"onUpdate:modelValue":o[3]||(o[3]=p=>u(e).current.multiple=p),border:"",label:n.$t("hmac_multiple")},null,8,["disabled","modelValue","label"])]),_:1},8,["content"])]),_:1})]),default:m(()=>[a(c,{append:[".sectool-page-option"],reduce:5},{default:m(({height:p})=>[a(i,{modelValue:u(e).current.input,"onUpdate:modelValue":o[1]||(o[1]=g=>u(e).current.input=g),height:p,upload:"file",encoding:""},null,8,["modelValue","height"])]),_:1})]),_:1})]),_:1}),a(c,null,{default:m(({height:p})=>[a(x,{direction:"vertical"},{default:m(()=>[(w(!0),v(L,null,j(u(S),g=>(w(),R(E,{"model-value":_.value[g],height:(p-20)/u(S).length,placeholder:`HMAC-${g}`,copy:`HMAC-${g}`},null,8,["model-value","height","placeholder","copy"]))),256))]),_:2},1024)]),_:1})])),[[$,"10-14"]])}}});export{K as default};
